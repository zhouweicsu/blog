[{"title":"ã€Œè¯‘ã€Facebook Prepack -- JavaScript çš„ä¸‹ä¸€ä¸ªæ€æ‰‹çº§å·¥å…·","date":"2017-07-13T11:55:59.000Z","path":"2017/07/13/facebooks-prepack-the-next-killer/","text":"è¯‘è€…ï¼šzhouweicsuåŸæ–‡ï¼šhttps://hackernoon.com/facebooks-prepack-the-next-killer-in-the-javascript-zone-d932556ffd8c è¿™å‡ å¤©ç¤¾äº¤ç½‘ç»œä¸Šéƒ½åœ¨çƒ­ç«æœå¤©åœ°è®¨è®º Prepackã€‚å¦‚æœä½ æ²¡å¬è¿‡è¿™ä¸ªåè¯ä¹Ÿå¾ˆæ­£å¸¸ï¼å› ä¸ºè¿™ä¸ªå·¥å…·æ‰å¼€æºæ²¡å‡ å¤©ã€‚Prepack ç”± Facebook å‡ºå“ï¼Œè¿˜åœ¨æ´»è·ƒçš„å¼€å‘é˜¶æ®µã€‚ç›®å‰è¿˜å±äºå®éªŒæ€§è´¨ï¼Œä»å¤„äºæ—©æœŸé˜¶æ®µï¼Œä½†å®ƒç®€ç›´æ£’æäº† ğŸ˜±ã€‚ æœ¬æ–‡ä¼šç»™å¤§å®¶ä»‹ç» Prepackï¼ŒåŒ…æ‹¬ Facebook å€Ÿæ­¤æƒ³è¦è§£å†³çš„é—®é¢˜ï¼Œè¿˜ä¼šåˆ—ä¸¾å‡ ä¸ªè¶…èµçš„ç¤ºä¾‹ï¼Œæœ€åå›ä»‹ç» Prepack ç›®å‰çš„å‘å±•ç°çŠ¶ã€‚ Pre.. ä»€ä¹ˆï¼Ÿ Prepack æ˜¯ä¸€ä¸ª JavaScript æºä»£ç ä¼˜åŒ–å·¥å…·ã€‚ Prepack èƒ½æ¶ˆé™¤é‚£äº›æœ¬å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå®Œæˆçš„è¿è¡Œæ—¶è®¡ç®—ã€‚ä¼šå°† JavaScript ä»£ç åŒ…ä¸­çš„å…¨å±€ä»£ç æ›¿æ¢ä¸ºä¸€ç³»åˆ—ç­‰ä»·çš„èµ‹å€¼è¯­å¥ã€‚è¿™æ ·åšèƒ½çœå»å¾ˆå¤šä¸­é—´è®¡ç®—å’Œå¯¹è±¡çš„åˆ†é…å·¥ä½œã€‚ Prepackï¼ŒFB å¼€å‘çš„ JavaScript éƒ¨åˆ†æ±‚å€¼å™¨å’Œä¼˜åŒ–ç¼–è¯‘å™¨ï¼Œç°åœ¨å¼€æºå•¦ï¼https://t.co/IDrNfHhpJLâ€”â€” @sebmck Sebastian McKenzie â€” Prepack å¼€å‘è€…ä¹‹ä¸€ Prepack æ˜¯ä¸€ä¸ª JavaScript çš„éƒ¨åˆ†æ±‚å€¼å™¨ï¼ˆpartial evaluatorï¼‰ã€‚å®ƒä¼šé‡å†™ JavaScript åŒ…ï¼Œè®©ä»£ç æ›´é«˜æ•ˆåœ°æ‰§è¡Œã€‚å¯¹äºé‡åˆå§‹åŒ–çš„ä»£ç ï¼ˆinitialization-heavy codeï¼‰ï¼ŒPrepack åœ¨å¯ä»¥æœ‰æ•ˆç¼“å­˜ JavaScript è§£æç»“æœçš„ç¯å¢ƒä¸­ä¼˜åŒ–æ•ˆæœæœ€ä½³ã€‚ å’Œ Closure Compiler æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ Prepack æ›´å…³æ³¨äºä¼˜åŒ–åçš„è¿è¡Œæ—¶æ€§èƒ½ï¼Œè€Œ Closure Compiler ä¾§é‡äºå‡å° JavaScript ä»£ç é‡ã€‚ Closure Compiler ä¹Ÿä¼˜åŒ– JavaScript ä»£ç ã€‚ä½† Prepack æ›´è¿›ä¸€æ­¥ï¼Œå®ƒä¼šåœ¨åˆå§‹åŒ–é˜¶æ®µå°±æ‰§è¡Œå…¨å±€ä»£ç ï¼Œå±•å¼€å¾ªç¯å’Œé€’å½’ã€‚ ä¸€æ®µå°å†å²ä¸€å¹´ä»¥å‰ï¼Œåœ¨ 2016 React æ¬§æ´²ä¼šè®®ä¸Šï¼ŒSebastian McKenzie æåˆ°äº†å¦‚ä½•æ›´å¿«åˆå§‹åŒ– JavaScriptã€‚ Sebastian McKenzie - Making JavaScript Initialize Faster at react-europe 2016McKenzie åœ¨ 2016 React æ¬§æ´²ä¼šè®®ä¸Šçš„æ¼”è®² çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶åº”è¯¥å¯¹ Prepack æœ‰äº†è¿›ä¸€æ­¥çš„äº†è§£ã€‚äº†è§£äº† Prepack åå­—çš„å«ä¹‰åŠå…¶ç½‘ç«™ï¼Œä¸‹é¢å°±çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒã€‚ å¦‚ä½•ä¸Šæ‰‹ï¼ŸPrepack é€šè¿‡ npm åŒ…å‘å¸ƒï¼ˆè¯‘è€…æ³¨ï¼šPrepack ç°åœ¨å·²ç»æ”¹ä¸º yarnï¼‰ï¼Œä½ å¯ä»¥ç”¨ Prepack-CLI å·¥å…·ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ Node.js æ¨¡å—çš„ APIã€‚ Prepack CLIå®‰è£… Prepack-CLIï¼Œè¿è¡Œ 1npm install -g prepack ç„¶åç¼–è¯‘æ–‡ä»¶ï¼Œè¿è¡Œ 1prepack script.js Prepack APIåœ¨é¡¹ç›®ä¸­å®‰è£…ï¼Œè¿è¡Œ 1npm install --save-dev prepack js ä»£ç å¦‚ä¸‹ï¼š é€šè¿‡ npm åŒ…ä½¿ç”¨ Prepack api â€”â€” ä»£ç ç¤ºä¾‹ï¼ˆè¯‘è€…æ³¨ï¼šè¯·ç‚¹å‡»åŸæ–‡æŸ¥çœ‹æ­¤ä»£ç ï¼‰ prepack-webpack-pluginæœ‰ä¸€ä¸ª webpack æ’ä»¶å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ Prepackã€‚ webpack æ’ä»¶çš„ä½¿ç”¨ç¤ºä¾‹ï¼ˆè¯‘è€…æ³¨ï¼šè¯·ç‚¹å‡»åŸæ–‡æŸ¥çœ‹ä½¿ç”¨ç¤ºä¾‹ï¼‰ å¥½æˆå¼€åœºä¸‹é¢æ˜¯ä¸€äº›è¶…èµçš„ç¤ºä¾‹ã€‚ç¤ºä¾‹ä¸­å·¦ä¾§æ˜¯è¾“å…¥ï¼Œå³ä¾§æ˜¯ Prepack ä¼˜åŒ–åçš„è¾“å‡ºã€‚ ç¬¬ä¸€ä¸ªç¤ºä¾‹æ˜¯æƒ¯ä¾‹ï¼šhello world ç¤ºä¾‹ 1 å¦‚ä½ æ‰€è§ï¼ŒPrepack å°†ä»£ç ç¼–è¯‘æˆäº†ä¸€ä¸ªæ— æ³•å†å°çš„ç‰ˆæœ¬ã€‚ ä¸‹ä¸€ä¸ªç¤ºä¾‹æœ‰ä¸¤ä¸ªå‡½æ•°ã€‚ä»£ç å¦‚ä¸‹ï¼š ç¤ºä¾‹ 2 ç¼–è¯‘åçš„ä»£ç ç”±ç¬¬ä¸€ä¸ªå‡½æ•°ç”Ÿæˆã€‚func2 å‡½æ•°æ²¡æœ‰è¢«è°ƒç”¨ï¼Œä¹Ÿæ²¡æœ‰åŒ…å«ä»»ä½•å‰¯ä½œç”¨ä»£ç ï¼Œæ‰€ä»¥ç¼–è¯‘åçš„ä»£ç å’Œ func2 æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚ æ³¨æ„ï¼Œå¦‚æœä»£ç ä¸æ˜¯ IIFEï¼Œåˆ™ç¼–è¯‘åçš„ä»£ç ä¸æ˜¯å®Œå…¨æœ€ä¼˜ã€‚ ä¸æ˜¯ IIFE çš„ç¤ºä¾‹ è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†ä¸€æ®µ for å¾ªç¯ä»£ç ã€‚å¾ªç¯åœ¨ç¼–è¯‘é˜¶æ®µè¢«ç§»é™¤ï¼Œä½†æ˜¯è¿˜ç”Ÿæˆè®¸å¤šä¸ç”¨çš„ä»£ç è¡Œã€‚å¦‚æœæ˜¯ IIFEï¼Œåˆ™ä¼šæ˜¯è¿™æ ·ï¼š IIFE ç¤ºä¾‹ å¦‚ä½ æ‰€è§ï¼Œæœ€ååªç•™ä¸‹äº† 5 è¡Œ log æ“ä½œçš„ä»£ç ã€‚ Playgroundä½ å¯ä»¥åœ¨å®˜ç½‘ä¸­çš„ playground ä¸­è¯•ä¸€è¯• Prepackã€‚è¿™ä¸ª playground ä¸ºé‚£äº›ä¸æƒ³åœ¨æœ¬åœ°å®‰è£… Prepackï¼Œæˆ–è€…åªæ˜¯æ„Ÿå…´è¶£æƒ³å°å°é²œçš„ç”¨æˆ·æä¾›äº†ä¸€ä¸ªé€‰æ‹©ã€‚ Playground ç¤ºä¾‹ å‘å±•ç°çŠ¶Github æŒ‡æ ‡Prepack ä»£ç æ‰˜ç®¡åœ¨ Githubï¼ˆæ¯”â¤ï¸ï¼‰ï¼Œé€šè¿‡ npm å‘å¸ƒã€‚ Github ç›®å‰æœ‰ 15 ä¸ª contributorï¼Œå¤§æ¦‚ 6500 ä¸ª starï¼Œæœ¬å‘¨ npm ä¸Šæœ‰çº¦ 2000 ä¸ª downloadï¼Œçº¦ 130 ä¸ª forkã€‚ç”±äºç¤¾äº¤ç½‘ç»œä¸Šå¼€å‘è€…å¯¹ Prepack å¾ˆæ„Ÿå…´è¶£ï¼Œé¢„è®¡è¿™äº›ç»Ÿè®¡æ•°æ®åœ¨æœªæ¥ä¸€æ®µæ—¶é—´æœ‰æœ›å¤§å¹…å¢é•¿ã€‚ æœ‰ä¸ªå¾ˆæœ‰è¶£çš„ issueï¼Œä½ ä¸€å®šè¦äº†è§£ä¸‹â€¦â€¦ Converts 1 meaningless line to 1065 lines of code Â· Issue #543 Â· facebook/prepack _Looks like @bevacqua managed to break it. Try running this modified example from the docs (function() { function fibâ€¦_github.com ä½†è¿™ä¸ªæ— æ‰€è°“ã€‚ä»–ä»¬ä¼šé©¬ä¸Šä¿®å¤è¿™ä¸ª bug çš„ã€‚ æµ‹è¯•è¦†ç›–ç‡åºåˆ—åŒ–æµ‹è¯•çš„ä»£ç æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šæ‰€æœ‰äººéƒ½å¯ä»¥æŸ¥çœ‹ã€‚ç›®å‰çš„è¦†ç›–ç‡æ˜¯ 52.37%ã€‚ ä»£ç æµ‹è¯•è¦†ç›–ç‡ Prepack çš„ä»£ç æµ‹è¯•è¦†ç›–ç‡ç”± istanbul ç”Ÿæˆã€‚ æœªæ¥è§„åˆ’ ğŸ¯Facebook æœ‰ä¸€ä¸ª Prepack çš„æœªæ¥è§„åˆ’ã€‚è§„åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šçŸ­æœŸï¼Œä¸­æœŸå’Œé•¿æœŸã€‚ çŸ­æœŸå†…ï¼ŒFacebook å¸Œæœ›èƒ½ç¨³å®šç°æœ‰åŠŸèƒ½é›†ï¼Œç”¨äºé¢„æ‰“åŒ… React Native ä»£ç åŒ…ã€‚ä»–ä»¬ä¹Ÿæƒ³é›†æˆ React Native å·¥å…·é“¾ã€‚å¦å¤–ï¼Œä»–ä»¬è¿˜è®¡åˆ’åŸºäº React Native ç›®å‰ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿçš„å‡è®¾æ¥æ„å»ºä¼˜åŒ–ã€‚ é•¿æœŸæ„¿æ™¯æ˜¯åˆ©ç”¨ Prepack æ‰“é€ ä¸€ä¸ªå¹³å°ã€‚ æœ€åæ³¨æ„Prepack ä¸èƒ½è¯†åˆ« document å’Œ windowï¼Œæ‰€ä»¥ä»–ä»¬çš„å€¼ä¼šæ˜¯ undefinedã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»åšä¸€ç‚¹é¢å¤–çš„å‡†å¤‡å·¥ä½œæ¥è§£å†³è¿™ä¸ª issueã€‚ä¹Ÿè®¸æœ‰äººæ„¿æ„è‡ªå¥‹å‘Šå‹‡å†™ä¸€ä¸ª npm package æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŸğŸ˜‡ Facebook å·å¬å¼€å‘è€…å»ä½¿ç”¨ Prepack å¹¶ç»™å‡ºåé¦ˆï¼Œä¿®å¤å­˜åœ¨çš„ bugï¼Œåœ¨ Github ä»“åº“ä¸­æäº¤ä»£ç ï¼Œæ¥å¸®åŠ©ä»–ä»¬æ›´å¥½çš„å®Œå–„ Prepackã€‚ å‚è€ƒæ–‡çŒ®ä»¥ä¸‹æ˜¯ä¸€äº›æœ‰ç”¨çš„æ‰©å±•é˜…è¯»é“¾æ¥ï¼š Github repository npm package Official website Prepack playground ç»“è®ºPrepack ä¼šæˆä¸ºä¸€ä¸ªâ€œç”Ÿæ´»å˜é©è€…(life changer)â€ã€‚å®ƒèƒŒåæœ‰ä¸€ä¸ªç¨³å®šå…¬å¸ â€”â€” Facebookã€‚ä»–ä»¬æƒ³å°†è¿™ä¸ªå·¥å…·é›†æˆåˆ° React ä¸­ï¼Œå¹¶ä¸”å·²ç»ä¸ºæ­¤å·¥ä½œäº†ä¸€æ®µæ—¶é—´ã€‚ä½†æœªæ¥ä»æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚Facebook çš„æ„¿æ™¯æ˜¯åˆ©ç”¨ Prepack æ‰“é€ ä¸€ä¸ªå¹³å°ã€‚è¿™çœ‹èµ·æ¥å¾ˆæœ‰å¸Œæœ›ã€‚æˆ‘ä¼šå¯†åˆ‡å…³æ³¨å®ƒçš„è¿›å±•ã€‚Prepack ç®€ç›´æ£’æäº†ï¼","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"Facebook","slug":"Facebook","permalink":"http://zhouweicsu.github.io/blog/tags/Facebook/"},{"name":"Prepack","slug":"Prepack","permalink":"http://zhouweicsu.github.io/blog/tags/Prepack/"},{"name":"compile","slug":"compile","permalink":"http://zhouweicsu.github.io/blog/tags/compile/"}]},{"title":"Vueï¼šè®°ä¸€æ¬¡è¯¡å¼‚æ— æ•ˆçš„ç‚¹å‡» toggle æ•ˆæœ","date":"2017-07-01T11:55:59.000Z","path":"2017/07/01/vue-new-params-not-update-dom/","text":"é—®é¢˜æè¿°æœ€è¿‘åœ¨é¡¹ç›®ä¸­é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œåç«¯è¿”å›ä¸€ä¸ªå¦‚ä¸‹æ ¼å¼çš„æ•°æ® listï¼š12345678910111213141516[ &#123; &quot;status&quot;: 1, &quot;detail&quot;: [ &#123;&quot;startDate&quot;: &quot;2017-05-12&quot;&#125;, &#123;&quot;startDate&quot;: &quot;2017-05-12&quot;&#125; ] &#125;, &#123; &quot;status&quot;: 1, &quot;detail&quot;: [ &#123;&quot;startDate&quot;: &quot;2017-05-12&quot;&#125;, &#123;&quot;startDate&quot;: &quot;2017-05-12&quot;&#125; ] &#125;] å‰ç«¯åšæ•°æ®å±•ç°ï¼Œå› ä¸ºæ•°æ®é‡å¾ˆå¤§ï¼Œæ‰€ä»¥éœ€è¦å°†äºŒçº§æ•°æ®éšè—ï¼Œå³ detail æ•°ç»„å­—æ®µä¸­çš„åˆ—è¡¨æ•°æ®é»˜è®¤ä¸å±•ç¤ºï¼Œéœ€è¦ä¸€ä¸ª toggle æ•ˆæœï¼Œç”¨æˆ·ç‚¹å‡»ä¹‹åå±•ç¤ºï¼Œå†ç‚¹å‡»åˆ™éšè—ï¼Œæ ¹æ® Vue æ•°æ®é©±åŠ¨çš„æ€æƒ³ï¼Œç»™ list ä¸­æ¯ä¸ªå¯¹è±¡æ–°å¢ä¸€ä¸ªå±æ€§ isShowï¼Œé»˜è®¤ä¸º falseã€‚ç”¨è¯¥å±æ€§æ§åˆ¶ detail å±æ€§ä¸­æ•°æ®çš„å±•ç°ä¸éšè—ï¼Œç‚¹å‡»å°† isShow ç½®ä¸º trueï¼Œå†ç‚¹å‡»ç½®ä¸º falseã€‚ä½†æ˜¯é—®é¢˜å‡ºæ¥äº†ï¼Œç‚¹å‡»ä¹‹å isShow å±æ€§çš„å€¼æ”¹è¿‡æ¥äº†ï¼Œä½†æ˜¯é¡µé¢çš„å´æ²¡æœ‰å±•ç¤º detail æ•°ç»„ä¸­çš„æ•°æ®ã€‚ é—®é¢˜åˆ†æä¸ºäº†åˆ†æä»¥ä¸Šå‡ºç°çš„é—®é¢˜ï¼Œç®€åŒ–ä¸€ä¸ª demo1ï¼š1234567&lt;ul id=\"app1\"&gt; &lt;li v-for=\"item in list\"&gt; &lt;p @click=\"toggle(item)\"&gt;&#123;&#123;item.startDate&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;item.isShow&#125;&#125;&lt;/p&gt; &lt;div v-show=\"item.isShow\"&gt;I'm show&lt;/div&gt; &lt;/li&gt;&lt;/ul&gt; 123456789101112131415161718192021new Vue(&#123; el: &apos;#app1&apos;, data: &#123; olist: [&#123;startDate: &apos;click me&apos;&#125;, &#123;startDate: &apos;click me&apos;&#125;] &#125;, computed: &#123; list() &#123; const list = [] this.olist.forEach(item =&gt; &#123; item.isShow = false list.push(item) &#125;) return list &#125; &#125;, methods: &#123; toggle(item)&#123; item.isShow = !item.isShow &#125; &#125;&#125;) demo1 åœ°å€æˆ‘ä»¬å‘ç°ç‚¹å‡»é¡µé¢çš„ click meï¼ŒI&#39;m show æ²¡æœ‰æ˜¾ç¤ºã€‚ç”¨ Chrome çš„ Vue æ’ä»¶å·¥å…·è°ƒè¯•ï¼Œå‘ç° isShow å±æ€§å·²ç»å˜ä¸º trueï¼Œå³ isShow çš„å˜åŒ–æœªè§¦å‘ç•Œé¢çš„æ›´æ–°ã€‚ è¿›ä¸€æ­¥è°ƒè¯•ï¼Œå‘ç°åœ¨ç‚¹å‡»åŒæ—¶ä¿®æ”¹ startDateï¼ŒisShow çš„æ•ˆæœä¼šç”Ÿæ•ˆã€‚demo2ï¼š12345678910111213141516171819202122new Vue(&#123; el: '#app2', data: &#123; olist: [&#123;startDate: 'click me'&#125;, &#123;startDate: 'click me'&#125;] &#125;, computed: &#123; list() &#123; const list = [] this.olist.forEach(item =&gt; &#123; item.isShow = false list.push(item) &#125;) return list &#125; &#125;, methods: &#123; toggle(item)&#123; item.startDate = Math.random() //æ–°å¢è¿™ä¸€è¡Œ isShow ä¼šç”Ÿæ•ˆ item.isShow = !item.isShow &#125; &#125;&#125;) demo2 åœ°å€åˆ°è¿™ä¸€æ­¥ï¼ŒçŒœæµ‹ computed ä¸­çš„æ–°å¯¹è±¡ list åªç›‘æ§äº† startDate å±æ€§ï¼Œæœªç›‘æ§ isShow å±æ€§ã€‚å³åªç›‘æ§ olist ä¸­å·²æœ‰çš„å±æ€§ï¼Œæ–°å¢å±æ€§æœªåŠ å…¥å“åº”å¼åˆ—è¡¨ï¼Œå› ä¸º olist æ˜¯å“åº”å¼çš„ï¼Œè€Œ åœ¨ç”Ÿæˆ list çš„è¿‡ç¨‹ä¸­ç›´æ¥ push çš„ item æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ list ä¸­çš„å¯¹è±¡æŒ‡é’ˆä¸ olist ä¸­çš„å¯¹è±¡æŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ olist ä¸­çš„å¯¹è±¡æ˜¯ Observer å¯¹è±¡ï¼Œé‚£ list ä¸­ä¹Ÿæ˜¯ï¼Œè€Œæ–°å¢çš„ isShow å±æ€§æœªæ‰§è¡Œ defineProperty è¿‡ç¨‹ã€‚ä¸ºäº†éªŒè¯ä¸Šé¢çš„çŒœæµ‹ï¼Œå†æ¥çœ‹çœ‹ demo3ï¼š12345678910111213141516171819202122new Vue(&#123; el: '#app3', data: &#123; olist: [&#123;startDate: 'click me',isShow: false&#125;, &#123;startDate: 'click me', isShow: false&#125;] //å°† isShow åŠ å…¥ olist ä¸­ &#125;, computed: &#123; list() &#123; const list = [] this.olist.forEach(item =&gt; &#123; //item.isShow = false // å»æ‰è¿™ä¸€è¡Œï¼Œå°† isShow ç›´æ¥æ”¾å…¥ olist ä¸­ list.push(item) &#125;) return list &#125; &#125;, methods: &#123; toggle(item)&#123; //item.startDate = Math.random() item.isShow = !item.isShow &#125; &#125;&#125;) demo3 åœ°å€æˆ‘ä»¬çœ‹åˆ°å°† isShow ç›´æ¥æ”¾å…¥ olist ä¸­ï¼Œtoggle æ•ˆæœæ˜¯æœ‰çš„ã€‚ é—®é¢˜åŸå› é€šè¿‡ä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬çŸ¥é“ toggle æ•ˆæœæœªç”Ÿæ•ˆçš„åŸå› å°±æ˜¯æ–°å¢çš„ isShow å±æ€§æœªè¢«ç›‘æ§ï¼Œæ²¡æœ‰è§¦å‘å“åº”å¼ï¼Œæ‰¾åˆ°åŸå› å°±å¯ä»¥ç»™å‡ºè§£å†³åŠæ³•ã€‚ è§£å†³æ–¹æ¡ˆæŸ¥çœ‹ Vue çš„å®˜æ–¹æ–‡æ¡£æ·±å…¥å“åº”å¼åŸç†ä¸€èŠ‚ä¸­å…³äºâ€œå‘å·²æœ‰å¯¹è±¡ä¸Šæ·»åŠ ä¸€äº›å±æ€§â€çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ–¹æ¡ˆä¸€å’Œæ–¹æ¡ˆäºŒè§£å†³ä¸Šè¿°é—®é¢˜ã€‚è€Œ Vue 2.0 ä¸­æä¾›çš„ä¸€ä¸ªæ–°æ–¹æ³•ä¹Ÿå¯ä»¥è§£å†³ DOM æœªæ›´æ–°çš„é—®é¢˜ã€‚ æ–¹æ¡ˆä¸€ï¼šsplice + Object.assignåˆ©ç”¨ Vue ä¸­é‡å†™æ•°ç»„çš„ splice æ–¹æ³•ï¼Œä¸ Object çš„ assign æ–¹æ³•ï¼Œå¯ä»¥å°† olist ä¸­çš„æ•°æ®é‡æ–°å˜æˆ Observer å¯¹è±¡ã€‚demo4ï¼š12345678910111213141516171819202122new Vue(&#123; el: '#app4', data: &#123; olist: [&#123;startDate: 'click me'&#125;, &#123;startDate: 'click me'&#125;] &#125;, mounted() &#123; this.dealData() &#125;, methods: &#123; toggle(item)&#123; //item.startDate = Math.random() item.isShow = !item.isShow &#125;, dealData() &#123; this.olist.forEach((item,index) =&gt; &#123; // item.isShow = false // this.olist.splice(index,1,item) this.olist.splice(index,1,Object.assign(&#123;isShow: false&#125;, item)) &#125;) &#125; &#125;&#125;) demo4 åœ°å€åœ¨å®ç°çš„è¿‡ç¨‹ä¸­æˆ‘å‘ç°ï¼ŒåŒæ ·ä½¿ç”¨ splice + Object.assign æ–¹æ³•å» computed ä¸€ä¸ªæ–°çš„ list æ— æ³•è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚å…·ä½“æŸ¥çœ‹ demo5 åœ°å€ã€‚è¯»è€…å¯ä»¥æƒ³æƒ³ä¸ºä»€ä¹ˆã€‚å…¶å®å¾ˆç®€å•.jpg æœ¬æ¬¡ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œåªéœ€è¦å±•ç¤ºè¯¥æ•°æ®ï¼Œä¸éœ€è¦å¤„ç†è¿”å›ï¼Œå°±ä¸ç”¨ computed ä¸€ä¸ªæ–°æ•°ç»„ï¼Œè€Œç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯è¿”å›æ¥çš„å¯¹è±¡ã€‚ æ–¹æ¡ˆäºŒï¼š$setVue å®˜æ–¹æ–‡æ¡£çš„æ·±å…¥å“åº”å¼åŸç†ä¸€èŠ‚ä¸­æåˆ°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Vue.set æˆ–è€… vm.$set æ–¹æ³•å°†å“åº”å±æ€§æ·»åŠ åˆ°åµŒå¥—çš„å¯¹è±¡ä¸Šï¼Œçœ‹ä¸€ä¸‹ demo6ï¼š12345678910111213141516171819new Vue(&#123; el: &apos;#app6&apos;, data: &#123; olist: [&#123;startDate: &apos;click me&apos;&#125;, &#123;startDate: &apos;click me&apos;&#125;] &#125;, mounted() &#123; this.dealData() &#125;, methods: &#123; toggle(item)&#123; item.isShow = !item.isShow &#125;, dealData() &#123; this.olist.forEach((item,index) =&gt; &#123; this.$set(this.olist,index, Object.assign(&#123;isShow: false&#125;, item)) &#125;) &#125; &#125;&#125;) demo6 åœ°å€ æ–¹æ¡ˆä¸‰ï¼š$forceUpdate()Vue åœ¨ 2.0 çš„ç‰ˆæœ¬ä¸­æ–°å¢äº† \\$forceUpdate() æ–¹æ³•ï¼Œè¿«ä½¿ Vue å®ä¾‹é‡æ–°æ¸²æŸ“ã€‚ç±»ä¼¼äº Angular ä¸­çš„ $scope.$apply()ã€‚çœ‹ä¸€ä¸‹ demo7ï¼š12345678910111213141516171819202122new Vue(&#123; el: &apos;#app7&apos;, data: &#123; olist: [&#123;startDate: &apos;click me&apos;&#125;, &#123;startDate: &apos;click me&apos;&#125;] &#125;, computed: &#123; list() &#123; const list = [] this.olist.forEach(item =&gt; &#123; item.isShow = false list.push(item) &#125;) return list &#125; &#125;, methods: &#123; toggle(item)&#123; item.isShow = !item.isShow this.$forceUpdate() // å¼ºåˆ¶åˆ·æ–°ï¼Œç±»ä¼¼äº Angular çš„ $scope.$apply() æ–¹æ³• &#125; &#125;&#125;) demo7 åœ°å€ æ€»ç»“ä»¥ä¸Šå°±æ˜¯è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ç»™æ‰€æœ‰çš„ demo åšäº†ä¸€ä¸ªåˆé›†åœ°å€ã€‚å…¶ä¸­ $forceUpdate() æ˜¯åŒäº‹åˆ†äº«çš„æ–°æ–¹æ³•ï¼Œå¦‚æœè¿˜æœ‰åˆ«çš„è§£å†³æ–¹æ¡ˆï¼Œè®°å¾—ç•™è¨€å‘Šè¯‰æˆ‘ã€‚","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"Vue","slug":"Vue","permalink":"http://zhouweicsu.github.io/blog/tags/Vue/"},{"name":"computed","slug":"computed","permalink":"http://zhouweicsu.github.io/blog/tags/computed/"},{"name":"å“åº”å¼","slug":"å“åº”å¼","permalink":"http://zhouweicsu.github.io/blog/tags/å“åº”å¼/"}]},{"title":"Vue2.0 æºç é˜…è¯»ï¼šæ¨¡æ¿æ¸²æŸ“","date":"2017-04-21T11:29:02.000Z","path":"2017/04/21/vue-2-0-template/","text":"æœ¬æ–‡åŸºäº Vue.js 2.1.10 Vue 2.0 ä¸­æ¨¡æ¿æ¸²æŸ“ä¸ Vue 1.0 å®Œå…¨ä¸åŒï¼Œ1.0 ä¸­é‡‡ç”¨çš„ DocumentFragmentï¼Œè€Œ 2.0 ä¸­å€Ÿé‰´ React çš„ Virtual DOMã€‚åŸºäº Virtual DOMï¼Œ2.0 è¿˜å¯ä»¥æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ï¼Œä¹Ÿæ”¯æŒ JSX è¯­æ³•ï¼ˆæ”¹è‰¯ç‰ˆçš„ render functionï¼‰ã€‚ åŸºç¡€æ¦‚å¿µåœ¨å¼€å§‹é˜…è¯»æºç ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€äº›å¿…å¤‡çš„åŸºç¡€æ¦‚å¿µï¼šAST æ•°æ®ç»“æ„ï¼ŒVNode æ•°æ®ç»“æ„ï¼ŒcreateElement çš„é—®é¢˜ï¼Œrender functionã€‚ AST æ•°æ®ç»“æ„AST çš„å…¨ç§°æ˜¯ Abstract Syntax Treeï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ï¼Œæ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼Œè®¡ç®—æœºå­¦ç§‘ä¸­ç¼–è¯‘åŸç†çš„æ¦‚å¿µã€‚Vue æºç ä¸­å€Ÿé‰´ jQuery ä½œè€… John Resig çš„ HTML Parser å¯¹æ¨¡æ¿è¿›è¡Œè§£æï¼Œå¾—åˆ°çš„å°±æ˜¯ AST ä»£ç ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹ Vue 2.0 æºç ä¸­ AST æ•°æ®ç»“æ„ çš„å®šä¹‰ï¼š 123456789101112131415161718192021222324declare type ASTNode = ASTElement | ASTText | ASTExpressiondeclare type ASTElement = &#123; type: 1; tag: string; attrsList: Array&lt;&#123; name: string; value: string &#125;&gt;; attrsMap: &#123; [key: string]: string | null &#125;; parent: ASTElement | void; children: Array&lt;ASTNode&gt;; //......&#125;declare type ASTExpression = &#123; type: 2; expression: string; text: string; static?: boolean;&#125;declare type ASTText = &#123; type: 3; text: string; static?: boolean;&#125; æˆ‘ä»¬çœ‹åˆ° ASTNode æœ‰ä¸‰ç§å½¢å¼ï¼šASTElementï¼ŒASTTextï¼ŒASTExpressionã€‚ç”¨å±æ€§ type åŒºåˆ†ã€‚ æ³¨æ„ï¼šä¸ºäº†é¿å…æ–‡ç« è¿‡é•¿ï¼Œæˆ‘åœ¨ä»¥ä¸Šçš„ä»£ç ä¸­æ³¨é‡Šäº† ASTElement ä¸­çš„è®¸å¤šå±æ€§ï¼Œç‚¹å‡»ä¸Šæ–¹ AST æ•°æ®ç»“æ„çš„é“¾æ¥å¯æŸ¥çœ‹å®Œæ•´ä»£ç ã€‚ VNode æ•°æ®ç»“æ„VNode æ˜¯ VDOM ä¸­çš„æ¦‚å¿µï¼Œæ˜¯çœŸå® DOM å…ƒç´ çš„ç®€åŒ–ç‰ˆï¼Œä¸çœŸå® DOM å…ƒç´ æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹ Vue 2.0 æºç ä¸­ VNode æ•°æ®ç»“æ„ çš„å®šä¹‰ï¼š 1234567891011121314151617181920constructor &#123; this.tag = tag //å…ƒç´ æ ‡ç­¾ this.data = data //å±æ€§ this.children = children //å­å…ƒç´ åˆ—è¡¨ this.text = text this.elm = elm //å¯¹åº”çš„çœŸå® DOM å…ƒç´  this.ns = undefined this.context = context this.functionalContext = undefined this.key = data &amp;&amp; data.key this.componentOptions = componentOptions this.componentInstance = undefined this.parent = undefined this.raw = false this.isStatic = false //æ˜¯å¦è¢«æ ‡è®°ä¸ºé™æ€èŠ‚ç‚¹ this.isRootInsert = true this.isComment = false this.isCloned = false this.isOnce = false&#125; æœ¬æ–‡ä¸­æˆ‘ä»¬å…³æ³¨ä»£ç ä¸­åé¢å¸¦æ³¨é‡Šçš„å±æ€§ï¼Œåé¢çš„ render function çš„ç”Ÿæˆè·Ÿè¿™äº›å±æ€§ç›¸å…³ã€‚å¯åœ¨å®é™…çš„ Vue é¡¹ç›®ä¸­åŠ ä¸€ä¸ªæ–­ç‚¹ï¼ŒæŸ¥çœ‹å®é™…çš„ VNode ä¸­è¿™äº›å±æ€§çš„å€¼ã€‚ document.createElement çš„é—®é¢˜æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨åŸç”Ÿ DOM å…ƒç´ ï¼Œè€Œæ˜¯ä½¿ç”¨çœŸå® DOM å…ƒç´ çš„ç®€åŒ–ç‰ˆ VNodeï¼Œæœ€å¤§çš„åŸå› å°±æ˜¯ document.createElement è¿™ä¸ªæ–¹æ³•åˆ›å»ºçš„çœŸå® DOM å…ƒç´ ä¼šå¸¦æ¥æ€§èƒ½ä¸Šçš„æŸå¤±ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª document.createElement æ–¹æ³•çš„ä¾‹å­ï¼š 1234let div = document.createElement('div');for(let k in div) &#123; console.log(k);&#125; æ‰“å¼€ console è¿è¡Œä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œä½ ä¼šå‘ç°æ‰“å°å‡ºæ¥çš„å±æ€§å¤šè¾¾ 228 ä¸ªï¼Œè€Œè¿™äº›å±æ€§æœ‰ 90% å¤šå¯¹æˆ‘ä»¬æ¥è¯´éƒ½æ˜¯æ— ç”¨çš„ã€‚VNode å°±æ˜¯ç®€åŒ–ç‰ˆçš„çœŸå® DOM å…ƒç´ ï¼Œåªå°†æˆ‘ä»¬éœ€è¦çš„å±æ€§æ‹¿è¿‡æ¥ï¼Œå¹¶æ–°å¢äº†ä¸€äº›åœ¨ diff è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨çš„å±æ€§ï¼Œä¾‹å¦‚ isStaticã€‚ render functionrender function é¡¾åæ€ä¹‰å°±æ˜¯æ¸²æŸ“å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯é€šè¿‡ç¼–è¯‘æ¨¡æ¿æ–‡ä»¶å¾—åˆ°çš„ï¼Œå…¶è¿è¡Œç»“æœæ˜¯ VNodeã€‚render function ä¸ JSX ç±»ä¼¼ï¼ŒVue 2.0 ä¸­é™¤äº† Template ä¹Ÿæ”¯æŒ JSX çš„å†™æ³•ã€‚å¤§å®¶å¯ä»¥ä½¿ç”¨ Vue.compile(template) æ–¹æ³•ç¼–è¯‘ä¸‹é¢è¿™æ®µæ¨¡æ¿ï¼š1234567891011&lt;div id=\"app\"&gt; &lt;header&gt; &lt;h1&gt;I'm a template!&lt;/h1&gt; &lt;/header&gt; &lt;p v-if=\"message\"&gt; &#123;&#123; message &#125;&#125; &lt;/p&gt; &lt;p v-else&gt; No message. &lt;/p&gt;&lt;/div&gt; æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­æœ‰ render å’Œ staticRenderFns ä¸¤ä¸ªå€¼ã€‚çœ‹ä¸€ä¸‹ç”Ÿæˆçš„ render function ï¼š12345678910111213141516(function() &#123; with(this)&#123; return _c('div',&#123; //åˆ›å»ºä¸€ä¸ª div å…ƒç´  attrs:&#123;\"id\":\"app\"&#125; //div æ·»åŠ å±æ€§ id &#125;,[ _m(0), //é™æ€èŠ‚ç‚¹ headerï¼Œæ­¤å¤„å¯¹åº” staticRenderFns æ•°ç»„ç´¢å¼•ä¸º 0 çš„ render function _v(\" \"), //ç©ºçš„æ–‡æœ¬èŠ‚ç‚¹ (message) //ä¸‰å…ƒè¡¨è¾¾å¼ï¼Œåˆ¤æ–­ message æ˜¯å¦å­˜åœ¨ //å¦‚æœå­˜åœ¨ï¼Œåˆ›å»º p å…ƒç´ ï¼Œå…ƒç´ é‡Œé¢æœ‰æ–‡æœ¬ï¼Œå€¼ä¸º toString(message) ?_c('p',[_v(\"\\n \"+_s(message)+\"\\n \")]) //å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»º p å…ƒç´ ï¼Œå…ƒç´ é‡Œé¢æœ‰æ–‡æœ¬ï¼Œå€¼ä¸º No message. :_c('p',[_v(\"\\n No message.\\n \")]) ] ) &#125;&#125;) é™¤äº† render functionï¼Œè¿˜æœ‰ä¸€ä¸ª staticRenderFns æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„å‡½æ•°ä¸ VDOM ä¸­çš„ diff ç®—æ³•ä¼˜åŒ–ç›¸å…³ï¼Œæˆ‘ä»¬ä¼šåœ¨ç¼–è¯‘é˜¶æ®µç»™åé¢ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„ VNode èŠ‚ç‚¹æ‰“ä¸Š static ä¸º true çš„æ ‡ç­¾ï¼Œé‚£äº›è¢«æ ‡è®°ä¸ºé™æ€èŠ‚ç‚¹çš„ VNode å°±ä¼šå•ç‹¬ç”Ÿæˆ staticRenderFns å‡½æ•°ï¼š12345(function() &#123; //ä¸Šé¢ render function ä¸­çš„ _m(0) ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• with(this)&#123; return _c('header',[_c('h1',[_v(\"I'm a template!\")])]) &#125;&#125;) è¦çœ‹æ‡‚ä¸Šé¢çš„ render functionï¼Œåªéœ€è¦äº†è§£ _cï¼Œ_mï¼Œ_vï¼Œ_s è¿™å‡ ä¸ªå‡½æ•°çš„å®šä¹‰ï¼Œå…¶ä¸­ _c æ˜¯ createElementï¼Œ_m æ˜¯ renderStaticï¼Œ_v æ˜¯ createTextVNodeï¼Œ_s æ˜¯ toStringã€‚é™¤äº†è¿™ä¸ª 4 ä¸ªå‡½æ•°ï¼Œè¿˜æœ‰å¦å¤– 10 ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æºç  src/core/instance/render.js ä¸­å¯ä»¥æŸ¥çœ‹è¿™äº›å‡½æ•°çš„å®šä¹‰ã€‚ æ¨¡æ¿æ¸²æŸ“çš„è¿‡ç¨‹æœ‰äº†ä¸Šé¢è¿™äº›åŸºæœ¬æ¦‚å¿µçš„è®¤çŸ¥ï¼Œæ¥ä¸‹æ¥é€šè¿‡æºç äº†è§£æ¨¡æ¿æ¸²æŸ“çš„è¿‡ç¨‹ã€‚ ç”Ÿå‘½å‘¨æœŸé˜…è¯»æºç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹ç›¸å…³æºç çš„ç›®å½•ã€‚ src|â€” compile æ¨¡æ¿ç¼–è¯‘çš„ä»£ç ï¼Œ1.0 å’Œ 2.0 ç‰ˆæœ¬åœ¨æ¨¡æ¿ç¼–è¯‘è¿™ä¸€å—æ”¹åŠ¨éå¸¸å¤§|â€” core/instance ç”Ÿå‘½å‘¨æœŸï¼Œåˆå§‹åŒ–å…¥å£|â€” core/vdom è™šæ‹ŸDOM|â€” entries ç¼–è¯‘å…¥å£æ–‡ä»¶ æœ¬æ–‡ä¸­æ¶‰åŠåˆ°æ¨¡æ¿æ¸²æŸ“çš„ä»£ç ä»¥ä¸Šç›®å½•ä¸­éƒ½æœ‰åˆ†å¸ƒï¼Œå…¶ä¸­æˆ‘ä»¬é‡ç‚¹è®²è§£çš„ compile å’Œ patch åˆ†åˆ«åœ¨ src/compile å’Œ src/core/vdom ç›®å½•ä¸­ã€‚ æ ¸å¿ƒå‡½æ•°ä»‹ç»åœ¨ä¸Šä¸€ç¯‡åšå®¢ã€ŠVue2.0 æºç é˜…è¯»ï¼šå“åº”å¼åŸç†ã€‹ä¸­æˆ‘ä»¬ç®€å•è®²äº† Vue çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ _init å‡½æ•°çš„æœ€åä¸€æ­¥å°±æ˜¯ $mount æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å°±æ˜¯æ¨¡æ¿æ¸²æŸ“çš„å…¥å£ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢è¿™å¼ å›¾ï¼š ä¸Šå›¾ä¸­å±•ç¤ºäº†æ¨¡æ¿æ¸²æŸ“è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ ¸å¿ƒå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ WebStrom æŸ¥çœ‹æºç ï¼ˆæŒ‰ä½ control é”®å•å‡»æ–¹æ³•åå¯ä»¥ç›´æ¥è·³è½¬ï¼Œæºç é˜…è¯»ç¥å™¨ï¼‰ï¼Œæˆ–è€…åœ¨æµè§ˆå™¨ä¸­æ‰“æ–­ç‚¹ä¸€æ­¥ä¸€æ­¥æŸ¥çœ‹ä»£ç è¿è¡Œçš„è¿‡ç¨‹ã€‚ $mount å‡½æ•°ï¼ˆsrc/entries/web-runtime-with-compiler.jsï¼‰ï¼Œä¸»è¦æ˜¯è·å– templateï¼Œç„¶åè¿›å…¥ compileToFunctions å‡½æ•°ã€‚ compileToFunctions å‡½æ•°ï¼ˆsrc/platforms/web/compiler/index.jsï¼‰ï¼Œä¸»è¦å°† template ç¼–è¯‘æˆ render å‡½æ•°ã€‚é¦–å…ˆè¯»ç¼“å­˜ï¼Œæ²¡æœ‰ç¼“å­˜å°±è°ƒç”¨ compile æ–¹æ³•æ‹¿åˆ° render function çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œåœ¨é€šè¿‡ new Function çš„æ–¹å¼ç”Ÿæˆ render functionï¼ˆåŸºç¡€æ¦‚å¿µä¸­çš„ render functionï¼‰ï¼š123456789101112131415161718// æœ‰ç¼“å­˜çš„è¯å°±ç›´æ¥åœ¨ç¼“å­˜é‡Œé¢æ‹¿const key = options &amp;&amp; options.delimiters ? String(options.delimiters) + template : templateif (cache[key]) &#123; return cache[key]&#125;const res = &#123;&#125;const compiled = compile(template, options) // compile åé¢ä¼šè¯¦ç»†è®²res.render = makeFunction(compiled.render) //é€šè¿‡ new Function çš„æ–¹å¼ç”Ÿæˆ render å‡½æ•°å¹¶ç¼“å­˜const l = compiled.staticRenderFns.lengthres.staticRenderFns = new Array(l)for (let i = 0; i &lt; l; i++) &#123; res.staticRenderFns[i] = makeFunction(compiled.staticRenderFns[i])&#125;......&#125;return (cache[key] = res) compile å‡½æ•°ï¼ˆsrc/compiler/index.jsï¼‰å°±æ˜¯å°† template ç¼–è¯‘æˆ render å‡½æ•°çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œåé¢ä¸€å°èŠ‚æˆ‘ä»¬ä¼šè¯¦ç»†è®²åˆ°ã€‚ å›åˆ°ä¸Šé¢çš„ $mount æ–¹æ³•ï¼Œæºç æœ€ååˆè°ƒç”¨äº† _mount å‡½æ•°ï¼ˆsrc/core/instance/lifecycle.jsï¼‰ï¼š1234567891011121314151617// è§¦å‘ beforeMount ç”Ÿå‘½å‘¨æœŸé’©å­callHook(vm, 'beforeMount')// é‡ç‚¹ï¼šæ–°å»ºä¸€ä¸ª Watcher å¹¶èµ‹å€¼ç»™ vm._watchervm._watcher = new Watcher(vm, function updateComponent () &#123; //_updateæ–¹æ³•é‡Œä¼šå»è°ƒç”¨ __patch__ æ–¹æ³• //vm._render()ä¼šæ ¹æ®æ•°æ®ç”Ÿæˆä¸€ä¸ªæ–°çš„ vdom, vm.update() åˆ™ä¼šå¯¹æ¯”æ–°çš„ vdom å’Œå½“å‰ vdomï¼Œ //å¹¶æŠŠå·®å¼‚çš„éƒ¨åˆ†æ¸²æŸ“åˆ°çœŸæ­£çš„ DOM æ ‘ä¸Šã€‚ vm._update(vm._render(), hydrating)&#125;, noop)hydrating = false// manually mounted instance, call mounted on self// mounted is called for render-created child components in its inserted hookif (vm.$vnode == null) &#123; vm._isMounted = true callHook(vm, 'mounted')&#125;return vm åœ¨è¿™ä¸ªå‡½æ•°ä¸­å‡ºç°äº†ç†Ÿæ‚‰çš„ new Watcherï¼Œè¿™ä¸€éƒ¨åˆ†åœ¨ä¸Šä¸€ç¯‡åšå®¢ã€ŠVue2.0 æºç é˜…è¯»ï¼šå“åº”å¼åŸç†ã€‹ä¸­è¯¦ç»†ä»‹ç»è¿‡ï¼Œä¸»è¦æ˜¯å°†æ¨¡æ¿ä¸æ•°æ®å»ºç«‹è”ç³»ï¼Œæ‰€ä»¥è¯´ Watcher æ˜¯æ¨¡æ¿æ¸²æŸ“å’Œæ•°æ®ä¹‹é—´çš„çº½å¸¦ã€‚ è‡³æ­¤ï¼Œæ¨¡æ¿è§£æå®Œæˆï¼Œæ‹¿åˆ°äº† render functionï¼Œä¹Ÿé€šè¿‡ Watcher ä¸å°†ä¹‹æ•°æ®è”ç³»åœ¨ä¸€èµ·ã€‚ compileä¸Šæ–‡ä¸­æåˆ° compile å‡½æ•°ï¼ˆsrc/compiler/index.jsï¼‰å°±æ˜¯å°† template ç¼–è¯‘æˆ render function çš„å­—ç¬¦ä¸²å½¢å¼ã€‚è¿™ä¸€å°èŠ‚æˆ‘ä»¬å°±è¯¦ç»†è®²è§£è¿™ä¸ªå‡½æ•°ï¼š12345678910111213export function compile ( template: string, options: CompilerOptions): CompiledResult &#123; const ast = parse(template.trim(), options) //1. parse optimize(ast, options) //2.optimize const code = generate(ast, options) //3.generate return &#123; ast, render: code.render, staticRenderFns: code.staticRenderFns &#125;&#125; è¿™ä¸ªå‡½æ•°ä¸»è¦æœ‰ä¸‰ä¸ªæ­¥éª¤ç»„æˆï¼šparseï¼Œoptimize å’Œ generateï¼Œæœ€ç»ˆè¾“å‡ºä¸€ä¸ªåŒ…å« astï¼Œrender å’Œ staticRenderFns çš„å¯¹è±¡ã€‚ parse å‡½æ•°ï¼ˆsrc/compiler/parser/index.jsï¼‰é‡‡ç”¨äº† jQuery ä½œè€… John Resig çš„ HTML Parser ï¼Œå°† templateå­—ç¬¦ä¸²è§£ææˆ ASTã€‚æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æ·±å…¥ä»£ç å»äº†è§£åŸç†ã€‚ optimize å‡½æ•°ï¼ˆsrc/compiler/optimizer.jsï¼‰ä¸»è¦åŠŸèƒ½å°±æ˜¯æ ‡è®°é™æ€èŠ‚ç‚¹ï¼Œä¸ºåé¢ patch è¿‡ç¨‹ä¸­å¯¹æ¯”æ–°æ—§ VNode æ ‘å½¢ç»“æ„åšä¼˜åŒ–ã€‚è¢«æ ‡è®°ä¸º static çš„èŠ‚ç‚¹åœ¨åé¢çš„ diff ç®—æ³•ä¸­ä¼šè¢«ç›´æ¥å¿½ç•¥ï¼Œä¸åšè¯¦ç»†çš„æ¯”è¾ƒã€‚ 12345678910export function optimize (root: ?ASTElement, options: CompilerOptions) &#123; if (!root) return // staticKeys æ˜¯é‚£äº›è®¤ä¸ºä¸ä¼šè¢«æ›´æ”¹çš„astçš„å±æ€§ isStaticKey = genStaticKeysCached(options.staticKeys || '') isPlatformReservedTag = options.isReservedTag || no // first pass: mark all non-static nodes. markStatic(root) // second pass: mark static roots. markStaticRoots(root, false)&#125; generate å‡½æ•°ï¼ˆsrc/compiler/codegen/index.jsï¼‰ä¸»è¦åŠŸèƒ½å°±æ˜¯æ ¹æ® AST ç»“æ„æ‹¼æ¥ç”Ÿæˆ render function çš„å­—ç¬¦ä¸²ã€‚ 1234567const code = ast ? genElement(ast) : '_c(\"div\")' staticRenderFns = prevStaticRenderFnsonceCount = prevOnceCountreturn &#123; render: `with(this)&#123;return $&#123;code&#125;&#125;`, //æœ€å¤–å±‚åŒ…ä¸€ä¸ª with(this) ä¹‹åè¿”å› staticRenderFns: currentStaticRenderFns&#125; å…¶ä¸­ genElement å‡½æ•°ï¼ˆsrc/compiler/codegen/index.jsï¼‰æ˜¯ä¼šæ ¹æ® AST çš„å±æ€§è°ƒç”¨ä¸åŒçš„æ–¹æ³•ç”Ÿæˆå­—ç¬¦ä¸²è¿”å›ã€‚ 1234567891011121314151617function genElement (el: ASTElement): string &#123; if (el.staticRoot &amp;&amp; !el.staticProcessed) &#123; return genStatic(el) &#125; else if (el.once &amp;&amp; !el.onceProcessed) &#123; return genOnce(el) &#125; else if (el.for &amp;&amp; !el.forProcessed) &#123; return genFor(el) &#125; else if (el.if &amp;&amp; !el.ifProcessed) &#123; return genIf(el) &#125; else if (el.tag === 'template' &amp;&amp; !el.slotTarget) &#123; return genChildren(el) || 'void 0' &#125; else if (el.tag === 'slot') &#123; .................... //ä¸ºé¿å…æ–‡ç« è¿‡é•¿ï¼Œæ­¤å¤„åˆ é™¤äº†éƒ¨åˆ†ä»£ç ï¼Œå¯ä»¥ç‚¹å‡»ä¸Šæ–¹çš„ genElement æŸ¥çœ‹å®Œæˆä»£ç  &#125; return code &#125;&#125; ä»¥ä¸Šå°±æ˜¯ compile å‡½æ•°ä¸­ä¸‰ä¸ªæ ¸å¿ƒæ­¥éª¤çš„ä»‹ç»ï¼Œcompile ä¹‹åæˆ‘ä»¬å¾—åˆ°äº† render function çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œåé¢é€šè¿‡ new Function å¾—åˆ°çœŸæ­£çš„æ¸²æŸ“å‡½æ•°ã€‚æ•°æ®å‘ç°å˜åŒ–åï¼Œä¼šæ‰§è¡Œ Watcher ä¸­çš„ _update å‡½æ•°ï¼ˆsrc/core/instance/lifecycle.jsï¼‰ï¼Œ_update å‡½æ•°ä¼šæ‰§è¡Œè¿™ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œè¾“å‡ºä¸€ä¸ªæ–°çš„ VNode æ ‘å½¢ç»“æ„çš„æ•°æ®ã€‚ç„¶ååœ¨è°ƒç”¨ __patch__ å‡½æ•°ï¼Œæ‹¿è¿™ä¸ªæ–°çš„ VNode ä¸æ—§çš„ VNode è¿›è¡Œå¯¹æ¯”ï¼Œåªæœ‰å‘ç”Ÿäº†å˜åŒ–çš„èŠ‚ç‚¹æ‰ä¼šè¢«æ›´æ–°åˆ°çœŸå® DOM æ ‘ä¸Šã€‚ 123456789101112131415161718192021//æ›´æ–°domçš„æ–¹æ³•ï¼Œä¸»è¦æ˜¯è°ƒç”¨ __patch__ æ–¹æ³•Vue.prototype._update = function (vnode: VNode, hydrating?: boolean) &#123; const vm: Component = this if (vm._isMounted) &#123; callHook(vm, 'beforeUpdate') &#125; .................................... if (!prevVnode) &#123; // initial render vm.$el = vm.__patch__(// å°†vnode patchåˆ°çœŸå®èŠ‚ç‚¹ä¸Šå» vm.$el, vnode, hydrating, false /* removeOnly */, vm.$options._parentElm, vm.$options._refElm ) &#125; else &#123; // updates // __patch__ æ–¹æ³•åœ¨web-runtime.jsä¸­å®šä¹‰äº†ï¼Œæœ€ç»ˆè°ƒç”¨çš„æ˜¯ core/vdom/patch.js ä¸­çš„ createPatchFunction æ–¹æ³• vm.$el = vm.__patch__(prevVnode, vnode) &#125; .....................................&#125; patchä¸Šä¸€èŠ‚æˆ‘ä»¬æåˆ°äº† __patch__ å‡½æ•°æœ€ç»ˆä¼šè¿›å…¥ src/core/vdom/patch.jsã€‚patch.js å°±æ˜¯æ–°æ—§ VNode å¯¹æ¯”çš„ diff å‡½æ•°ï¼Œdiff ç®—æ³•æ¥æºäº snabbdomï¼Œæ˜¯ VDOM æ€æƒ³çš„æ ¸å¿ƒã€‚å¯¹ä¸¤ä¸ªæ ‘ç»“æ„è¿›è¡Œå®Œæ•´çš„ diff å’Œ patchï¼Œå¤æ‚åº¦å¢é•¿ä¸º O(n^3)ï¼Œè€Œ snabbdom çš„ç®—æ³•æ ¹æ® DOM æ“ä½œè·¨å±‚çº§å¢åˆ èŠ‚ç‚¹è¾ƒå°‘çš„ç‰¹ç‚¹è¿›è¡Œè°ƒæ•´ï¼Œå°†ä»£ç å¤æ‚åº¦é™åˆ° O(n)ï¼Œç®—æ³•æ¯”è¾ƒå¦‚ä¸‹å›¾ï¼Œå®ƒåªä¼šåœ¨åŒå±‚çº§è¿›è¡Œ, ä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒã€‚ patch å‡½æ•°ï¼ˆsrc/core/vdom/patch.jsï¼‰çš„æºç ï¼š 12345678910111213141516171819202122if (!oldVnode) &#123;//å¦‚æœæ²¡æœ‰æ—§çš„ VNode èŠ‚ç‚¹ï¼Œåˆ™æ„å‘³ç€æ˜¯ DOM çš„åˆå§‹åŒ–ï¼Œç›´æ¥åˆ›å»ºçœŸå® DOM // empty mount (likely as component), create new root element isInitialPatch = true createElm(vnode, insertedVnodeQueue, parentElm, refElm)&#125; else &#123; const isRealElement = isDef(oldVnode.nodeType) if (!isRealElement &amp;&amp; sameVnode(oldVnode, vnode)) &#123;//å€¼å¾— patch // patch existing root node patchVnode(oldVnode, vnode, insertedVnodeQueue, removeOnly) //patch ç®—æ³•å…¥å£ &#125; else &#123; .....................................//ä¸ºæ–‡ç« é¿å…è¿‡é•¿ï¼Œæ¶‰åŠSSRçš„ä»£ç è¢«æ³¨é‡Šæ‰äº† const oldElm = oldVnode.elm const parentElm = nodeOps.parentNode(oldElm) //ä¸å€¼å¾— patchï¼Œç›´æ¥ç§»é™¤ oldVNodeï¼Œæ ¹æ® newVNode åˆ›å»ºçœŸå® DOM æ·»åŠ åˆ° parent ä¸­ createElm( vnode, insertedVnodeQueue, oldElm._leaveCb ? null : parentElm, nodeOps.nextSibling(oldElm) ) ................................//ç‚¹å‡»ä¸Šæ–‡çš„ patch é“¾æ¥ï¼ŒæŸ¥çœ‹å®Œæ•´ä»£ç &#125; patchNode å‡½æ•°ï¼ˆsrc/core/vdom/patch.jsï¼‰ä¸ updateChildren å‡½æ•°ï¼ˆsrc/core/vdom/patch.jsï¼‰å½¢æˆçš„é€’å½’è°ƒç”¨æ˜¯ diff ç®—æ³•çš„æ ¸å¿ƒã€‚ patchNode æ ¸å¿ƒä»£ç ï¼š12345678910111213141516// patchä¸¤ä¸ªvnodeçš„textå’Œchildren// æŸ¥çœ‹vnode.textå®šä¹‰if (isUndef(vnode.text)) &#123; //isUndef å°±æ˜¯åˆ¤æ–­å‚æ•°æ˜¯å¦æœªå®šä¹‰ if (isDef(oldCh) &amp;&amp; isDef(ch)) &#123; if (oldCh !== ch) updateChildren(elm, oldCh, ch, insertedVnodeQueue, removeOnly) //é€’å½’è°ƒç”¨ &#125; else if (isDef(ch)) &#123; if (isDef(oldVnode.text)) nodeOps.setTextContent(elm, '') addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue) &#125; else if (isDef(oldCh)) &#123; removeVnodes(elm, oldCh, 0, oldCh.length - 1) &#125; else if (isDef(oldVnode.text)) &#123; nodeOps.setTextContent(elm, '') &#125;&#125; else if (oldVnode.text !== vnode.text) &#123; nodeOps.setTextContent(elm, vnode.text)&#125; updateChildren å‡½æ•°æ˜¯ diff ç®—æ³•é«˜æ•ˆçš„æ ¸å¿ƒï¼Œä»£ç è¾ƒé•¿ä¸”å¯†é›†ï¼Œä½†æ˜¯ç®—æ³•ç®€å•ã€‚éå†ä¸¤ä¸ªèŠ‚ç‚¹æ•°ç»„ï¼Œç»´æŠ¤å››ä¸ªå˜é‡ oldStartIdxï¼ŒoldEndIdxï¼ŒnewStartIdxï¼ŒnewEndIdxã€‚ç®—æ³•æ­¥éª¤å¦‚ä¸‹ï¼š å¯¹æ¯” oldStartVnode å’Œ newStartVnodeï¼Œä¸¤è€… elm ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œè‹¥å€¼å¾—æ¯”è¾ƒï¼Œåˆ™ patchVnodeï¼› å¦åˆ™å¯¹æ¯” oldEndVnode å’Œ newEndVnodeï¼Œä¸¤è€… elm ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œè‹¥å€¼å¾—æ¯”è¾ƒï¼Œåˆ™ patchVnodeï¼› å¦åˆ™å¯¹æ¯” oldStartVnode å’Œ newEndVnodeï¼Œè‹¥å€¼å¾—æ¯”è¾ƒè¯´æ˜ oldStartVnode.elm å‘å³ç§»åŠ¨äº†ï¼Œé‚£ä¹ˆ patchVnodeï¼Œç„¶åæ‰§è¡Œ api.insertBefore() è°ƒæ•´å®ƒçš„ä½ç½®ï¼› å¦åˆ™å¯¹æ¯” oldEndVnode å’Œ newStartVnodeï¼Œè‹¥å€¼å¾—æ¯”è¾ƒè¯´æ˜ oldVnode.elm å‘å·¦ç§»åŠ¨äº†ï¼Œé‚£ä¹ˆ patchVnodeï¼Œç„¶åæ‰§è¡Œ api.insertBefore() è°ƒæ•´å®ƒçš„ä½ç½®ï¼› å¦‚æœä¸Šé¢å››ç§æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œåˆ™åˆ©ç”¨ vnode.keyã€‚å…ˆä½¿ç”¨ createKeyToOldIdx ç”Ÿæˆä¸€ä¸ªæ—§èŠ‚ç‚¹æ•°ç»„çš„ç´¢å¼•è¡¨ï¼Œå¦‚æœæ–°èŠ‚ç‚¹çš„ key ä¸å­˜åœ¨è¿™ä¸ªè¡¨ä¸­è¯´æ˜æ˜¯æ–°èŠ‚ç‚¹ï¼Œåˆ™æ·»åŠ ï¼›å¦‚æœåœ¨åˆ™ patchVnodeï¼Œç„¶ååœ¨åšä¸€äº›è°ƒæ•´å…å¾—å½±å“åé¢çš„éå†ï¼› oldStartIdx &gt; oldEndIdx æˆ–è€… newStartIdx &gt; newOldStartIdx çš„æ—¶å€™åœæ­¢éå†ï¼› å¦‚æœ oldStartIdx &gt; oldEndIdx è¯´æ˜æ—§èŠ‚ç‚¹æ•°ç»„å…ˆéå†å®Œï¼Œè¿™æ—¶å°†å‰©ä½™çš„æ–°èŠ‚ç‚¹ç›´æ¥æ–°å»ºæ·»åŠ ï¼› å¦åˆ™å¦‚æœ newStartIdx &gt; newEndIdx è¯´æ˜æ–°èŠ‚ç‚¹æ•°ç»„å…ˆéå†å®Œï¼Œè¿™æ—¶å°†å‰©ä½™çš„æ—§èŠ‚ç‚¹ç›´æ¥åˆ é™¤ã€‚ æ ¸å¿ƒä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455while (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123; if (isUndef(oldStartVnode)) &#123; oldStartVnode = oldCh[++oldStartIdx] // Vnode has been moved left &#125; else if (isUndef(oldEndVnode)) &#123; oldEndVnode = oldCh[--oldEndIdx] &#125; else if (sameVnode(oldStartVnode, newStartVnode)) &#123;//æ–°æ—§ VNode å››ç§æ¯”è¾ƒ patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue) oldStartVnode = oldCh[++oldStartIdx] newStartVnode = newCh[++newStartIdx] &#125; else if (sameVnode(oldEndVnode, newEndVnode)) &#123; patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue) oldEndVnode = oldCh[--oldEndIdx] newEndVnode = newCh[--newEndIdx] &#125; else if (sameVnode(oldStartVnode, newEndVnode)) &#123; // Vnode moved right patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue) canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldStartVnode.elm, nodeOps.nextSibling(oldEndVnode.elm)) oldStartVnode = oldCh[++oldStartIdx] newEndVnode = newCh[--newEndIdx] &#125; else if (sameVnode(oldEndVnode, newStartVnode)) &#123; // Vnode moved left patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue) canMove &amp;&amp; nodeOps.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm) oldEndVnode = oldCh[--oldEndIdx] newStartVnode = newCh[++newStartIdx] &#125; else &#123; //å¦‚æœ4ä¸ªæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œåˆ™åˆ©ç”¨ vnode.key æ¯”è¾ƒ if (isUndef(oldKeyToIdx)) oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx) //å…ˆä½¿ç”¨ createKeyToOldIdx ç”Ÿæˆä¸€ä¸ª index-key è¡¨ï¼Œç„¶åæ ¹æ®è¿™ä¸ªè¡¨æ¥è¿›è¡Œæ›´æ”¹ã€‚ idxInOld = isDef(newStartVnode.key) ? oldKeyToIdx[newStartVnode.key] : null if (isUndef(idxInOld)) &#123; // å¦‚æœ newVnode.key ä¸åœ¨è¡¨ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ª newVnode å°±æ˜¯æ–°çš„ vnodeï¼Œå°†å…¶æ’å…¥ createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm) newStartVnode = newCh[++newStartIdx] &#125; else &#123; // å¦‚æœ newVnode.key åœ¨è¡¨ä¸­,é‚£ä¹ˆå¯¹åº”çš„ oldVnode å­˜åœ¨ï¼Œåˆ™ patchVnode, // å¹¶åœ¨ patch ä¹‹å,å°†è¿™ä¸ª oldVnode ç½®ä¸º undefined(oldCh[idxInOld] = undefined), // åŒæ—¶å°† oldVnode.elm ä½ç½®å˜æ¢åˆ°å½“å‰ oldStartIdx ä¹‹å‰,ä»¥å…å½±å“æ¥ä¸‹æ¥çš„éå† elmToMove = oldCh[idxInOld] if (sameVnode(elmToMove, newStartVnode)) &#123; patchVnode(elmToMove, newStartVnode, insertedVnodeQueue) oldCh[idxInOld] = undefined canMove &amp;&amp; nodeOps.insertBefore(parentElm, newStartVnode.elm, oldStartVnode.elm) newStartVnode = newCh[++newStartIdx] &#125; else &#123; // same key but different element. treat as new element createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm) newStartVnode = newCh[++newStartIdx] &#125; &#125; &#125; &#125; if (oldStartIdx &gt; oldEndIdx) &#123;//è¯´æ˜æ—§èŠ‚ç‚¹æ•°ç»„å…ˆéå†å®Œï¼Œè¿™æ—¶å°†å‰©ä½™çš„æ–°èŠ‚ç‚¹ç›´æ¥æ–°å»ºæ·»åŠ  refElm = isUndef(newCh[newEndIdx + 1]) ? null : newCh[newEndIdx + 1].elm addVnodes(parentElm, refElm, newCh, newStartIdx, newEndIdx, insertedVnodeQueue) &#125; else if (newStartIdx &gt; newEndIdx) &#123;//è¯´æ˜æ–°èŠ‚ç‚¹æ•°ç»„å…ˆéå†å®Œï¼Œè¿™æ—¶å°†å‰©ä½™çš„æ—§èŠ‚ç‚¹ç›´æ¥åˆ é™¤ removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx) &#125; æ€»ç»“æ¨¡æ¿æ¸²æŸ“æ˜¯ Vue 2.0 ä¸ 1.0 æœ€å¤§çš„ä¸åŒã€‚æœ¬æ–‡æ¢³ç†äº†æ¨¡æ¿æ¸²æŸ“çš„è¿‡ç¨‹ï¼Œé‡ç‚¹è®²è§£äº†å…¶ä¸­çš„ compile å’Œ patch å‡½æ•° compile å‡½æ•°ä¸»è¦æ˜¯å°† template è½¬æ¢ä¸º ASTï¼Œä¼˜åŒ– ASTï¼Œå†å°† AST è½¬æ¢ä¸º render functionï¼›render function ä¸æ•°æ®é€šè¿‡ Watcher äº§ç”Ÿå…³è”ï¼›åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨ patch å‡½æ•°ï¼Œæ‰§è¡Œæ­¤ render å‡½æ•°ï¼Œç”Ÿæˆæ–° VNodeï¼Œä¸æ—§ VNode è¿›è¡Œ diffï¼Œæœ€ç»ˆæ›´æ–° DOM æ ‘ã€‚ æ‰©å±•é˜…è¯» ç®€æ´æ¸…æ™°çš„ virtual dom å®ç°ï¼šsnabbdom æºç é˜…è¯» è§£æ vue 2.0 çš„ diff ç®—æ³• Reactâ€™s diff algorithm","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"Vue","slug":"Vue","permalink":"http://zhouweicsu.github.io/blog/tags/Vue/"},{"name":"æºç ","slug":"æºç ","permalink":"http://zhouweicsu.github.io/blog/tags/æºç /"}]},{"title":"JavaScript åŸºç¡€ï¼šç»§æ‰¿","date":"2017-04-12T07:24:46.000Z","path":"2017/04/12/inherit/","text":"åŸºç¡€æ¦‚å¿µè¦äº†è§£ JavaScript ç»§æ‰¿ï¼Œéœ€è¦å…ˆå¼„æ˜ç™½ç›¸å…³çš„4 ä¸ªæ¦‚å¿µï¼Œ3 ä¸ªå…³ç³»ï¼Œ3 ä¸ªå±æ€§ä»¥åŠ 1 ä¸ªæ“ä½œç¬¦ã€‚ 4 ä¸ªæ¦‚å¿µæ„é€ å‡½æ•°ï¼šä»»ä½•å‡½æ•°ï¼Œåªè¦èƒ½é€šè¿‡ new æ“ä½œç¬¦æ¥è°ƒç”¨ï¼Œé‚£å®ƒå°±å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ï¼›æ„é€ å‡½æ•°æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼›åŸå‹å¯¹è±¡ï¼šé€šè¿‡è°ƒç”¨æ„é€ å‡½æ•°è€Œåˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡å®ä¾‹çš„åŸå‹å¯¹è±¡ï¼›è¯¥å¯¹è±¡åŒ…å«ç”±ç‰¹å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œæ–¹æ³•ï¼›å®ä¾‹ï¼šé€šè¿‡ new æ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°å¾—åˆ°çš„å¯¹è±¡ï¼›åŸå‹é“¾ï¼šæ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œæˆ‘ä»¬å¦‚æœå°†è¿™ä¸ªåŸå‹å¯¹è±¡æ”¹ä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œå°±ä¼šå½¢æˆåŸå‹é“¾ã€‚ P.S. åŸå‹é“¾åé¢ä¼šè¯¦ç»†è®²è§£ï¼Œæ‰€ä»¥æ²¡æœ‰ç†è§£æ²¡å…³ç³»ã€‚ ä»£ç ç¤ºä¾‹ 1ï¼š123456789101112131415function Point(x, y) &#123; //æ„é€ å‡½æ•° this.x = x || 10; this.y = x || 10; this.show = function() &#123; console.log('x: ' + this.x + ', y:' + this.y); &#125;&#125;function ColorPoint(color) &#123; this.color = color || 'red'&#125;// ColorPoint ç»§æ‰¿äº† Point// ColorPoint.prototype åŸå‹å¯¹è±¡// new Point() å®ä¾‹ColorPoint.prototype = new Point(); 3 ä¸ªå…³ç³»3 ä¸ªå…³ç³»æ˜¯æ„é€ å‡½æ•°ï¼ŒåŸå‹å¯¹è±¡ä¸å®ä¾‹ä¹‹é—´çš„å…³ç³»ï¼š æ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ åŸå‹å¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆ æ¯ä¸ªå®ä¾‹éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ æ ¹æ®ä»£ç ç¤ºä¾‹ 1 ä¸­ Point ç±»çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³ç³»å›¾ï¼š å›¾ 1ï¼šPoint ç±»æ„é€ å‡½æ•°ï¼ŒåŸå‹å¯¹è±¡ä¸å®ä¾‹ä¹‹é—´çš„å…³ç³»å›¾ åŸå‹é“¾ï¼šæ„é€ å‡½æ•° Point å’Œ ColorPointï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸¤ä¸ªæ„é€ å‡½æ•°éƒ½ä¼šæœ‰é»˜è®¤çš„åŸå‹å¯¹è±¡ã€‚ä¸Šé¢æˆ‘ä»¬è¯´åˆ°å¦‚æœæˆ‘ä»¬å°† ColorPoint çš„åŸå‹å¯¹è±¡æ”¹ä¸º Point çš„å®ä¾‹ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°åŸå‹é“¾ã€‚é‚£åŸå‹é“¾æ˜¯å¦‚ä½•å½¢æˆçš„å‘¢ï¼Ÿå°±æ˜¯é€šè¿‡åŸå‹å¯¹è±¡ä¸å®ä¾‹ä¹‹é—´çš„è¿™ä¸ªå…³ç³»å½¢æˆçš„ã€‚å…·ä½“å½¢æˆè¿‡ç¨‹æˆ‘ä»¬éœ€è¦å†äº†è§£ä¸€ä¸‹å…³ç³»ä¸­æ¶‰åŠåˆ°çš„ 3 ä¸ªå±æ€§ã€‚ 3 ä¸ªå±æ€§3 ä¸ªå±æ€§ä¸ 3 ä¸ªå…³ç³»ç›¸å…³è”ï¼šprototypeï¼Œconstructorï¼Œ__proto__ï¼š prototypeï¼šæ„é€ å‡½æ•°ä¸­æŒ‡å‘åŸå‹å¯¹è±¡çš„æŒ‡é’ˆ constructorï¼šåŸå‹å¯¹è±¡ä¸­æŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆ __proto__ï¼šå®ä¾‹ä¸­æŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ æ ¹æ®ä»£ç ç¤ºä¾‹ 1 ä¸­ Point ä¸ ColorPoint çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³ç³»å›¾ï¼š å›¾ 2ï¼šColorPointã€Pointã€Object ä¹‹é—´çš„å…³ç³»å›¾ åŸå‹é“¾ï¼šæœ¬æ¥æ„é€ å‡½æ•° Point å’Œ ColorPoint æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å‡½æ•°ï¼Œä¹‹é—´æ²¡æœ‰å…³ç³»ã€‚å¦‚æœæˆ‘ä»¬å°† ColorPoint çš„åŸå‹å¯¹è±¡é‡å†™ï¼Œå³ ColorPoint.prototype = new Point()ã€‚é‚£ prototype å±æ€§å°±æŒ‡å‘äº† Point çš„å®ä¾‹ï¼Œè€Œä»ä¸Šé¢æˆ‘ä»¬å·²ç»çŸ¥é“äº†æ¯ä¸ªå®ä¾‹éƒ½æœ‰æŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ __proto__ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªåŸå‹é“¾ï¼š ColorPoint çš„å®ä¾‹ä¸­ __proto__ æŒ‡å‘ ColorPoint çš„åŸå‹å¯¹è±¡ï¼Œå³ Point çš„å®ä¾‹ï¼› è€Œ Point çš„å®ä¾‹ä¹Ÿæœ‰ä¸€ä¸ª __proto__ æŒ‡å‘ Point çš„åŸå‹å¯¹è±¡; è€Œ JavaScript ä¸­ä»»ä½•å¯¹è±¡éƒ½æ˜¯ç»§æ‰¿è‡ª Objectï¼Œæ‰€ä»¥ Point çš„åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ª __proto__ æŒ‡é’ˆæŒ‡å‘ Object çš„åŸå‹å¯¹è±¡; ç›´åˆ° Object çš„åŸå‹å¯¹è±¡çš„ __proto__ è¢«æŒ‡å‘ nullï¼› æ ¹æ®å®šä¹‰ï¼Œnullæ²¡æœ‰åŸå‹ï¼Œå¹¶ä¸”ä½œä¸ºè¿™ä¸ªåŸå‹é“¾ prototype chain ä¸­çš„æœ€ç»ˆé“¾æ¥ã€‚ é€šè¿‡ __proto__ æŒ‡é’ˆæ‰€å½¢æˆè¿™ä¸ªå®ä¾‹ä¸åŸå‹çš„é“¾æ¡å°±æ˜¯åŸå‹é“¾ï¼Œå³å›¾ 2 ä¸­è“è‰²é“¾æ¡ï¼ŒåŸºäºåŸå‹é“¾çš„å±æ€§å’Œæ–¹æ³•æŸ¥æ‰¾å°±æ˜¯æŒ‰ç…§è¿™ä¸ªè“è‰²é“¾æ¡å±‚å±‚å¾€ä¸Šçš„ã€‚ 1 ä¸ªæ“ä½œç¬¦å‰é¢è¯´è¿‡ï¼Œnew æ“ä½œç¬¦æ˜¯åŒºåˆ«æ„é€ å‡½æ•°ä¸æ™®é€šå‡½æ•°çš„å…³é”®ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹new æ“ä½œç¬¦æ‰§è¡Œçš„æ­¥éª¤ï¼š åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼› å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤ this å°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰ï¼› æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ï¼› è¿”å›æ–°å¯¹è±¡ã€‚ ç»§æ‰¿çš„æ–¹æ³•ç»§æ‰¿çš„æœ¬è´¨å°±æ˜¯é€šè¿‡é‡å†™åŸå‹å¯¹è±¡å®ç°åŸå‹é“¾ï¼Œä½¿å¾—å­ç±»å‹å¯ä»¥é€šè¿‡åŸå‹é“¾æ‰¾åˆ°çˆ¶ç±»å‹ä¸­çš„å±æ€§å’Œæ–¹æ³•ã€‚æœ‰äº†ä¸Šé¢çš„åŸºç¡€ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ JavaScript ä¸­å¦‚ä½•å®ç°ç»§æ‰¿ï¼Œè®¨è®ºæ¯ç§æ–¹æ³•çš„ä¼˜ç¼ºç‚¹ã€‚ åŸºäºåŸå‹é“¾ä»£ç å®ä¾‹ 1 ä¸­é€šè¿‡é‡å†™ ColorPoint çš„åŸå‹å¯¹è±¡ï¼Œå½¢æˆä¸€æ¡åŸå‹é“¾å®ç°äº†ç»§æ‰¿ã€‚åŸæ¥å­˜åœ¨äº Point çš„å®ä¾‹ä¸­çš„å±æ€§ xã€y å’Œæ–¹æ³• show ç°åœ¨ä¹Ÿå­˜åœ¨äº ColorPoint.prototype ä¸­ã€‚ä½†è¿™ç§å®ç°å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š çˆ¶ç±»ä¸­å¦‚æœå­˜åœ¨å¼•ç”¨ç±»å‹çš„å±æ€§ï¼ˆä¾‹å¦‚æ•°ç»„ï¼‰ï¼Œé‚£ä¹ˆå­ç±»çš„æ‰€æœ‰å®ä¾‹éƒ½ä¼šå…±äº«è¿™ä¸ªå±æ€§ï¼›æ¯”å¦‚ï¼Œå¦‚æœ Point ä¸­æœ‰ä¸€ä¸ªæ•°ç»„å±æ€§ shapesï¼Œé‚£åœ¨æ‰€æœ‰çš„ ColorPoint çš„å®ä¾‹éƒ½ä¼šå…±äº«è¿™ä¸ªæ•°ç»„ shapesï¼Œä»»æ„ä¸€ä¸ªå®ä¾‹ä¿®æ”¹ shapesï¼Œéƒ½ä¼šå½±å“å…¶ä»–å®ä¾‹ã€‚ ä»£ç ç¤ºä¾‹ 2ï¼š1234567891011121314151617181920function Point(x, y) &#123; //æ„é€ å‡½æ•° this.x = x || 10; this.y = x || 10; this.shapes = ['square','rectangle']; this.show = function() &#123; console.log('x: ' + this.x + ', y:' + this.y); &#125;&#125;function ColorPoint(color) &#123; this.color = color || 'red'&#125;// ColorPoint ç»§æ‰¿äº† PointColorPoint.prototype = new Point(); var cp1 = new ColorPoint();cp1.shapes.push('circle');console.log(cp1.shapes); // [\"square\", \"rectangle\", \"circle\"]var cp2 = new ColorPoint();// cp2 è¢«å½±å“äº†console.log(cp2.shapes); // [\"square\", \"rectangle\", \"circle\"] åœ¨åˆ›å»ºå­ç±»å‹çš„å®ä¾‹æ—¶ï¼Œä¸èƒ½å‘çˆ¶ç±»å‹çš„æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚æˆ‘ä»¬è¿˜çœ‹åˆ°ï¼Œåœ¨å®ç°ç»§æ‰¿çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥å°† new Point() æ›¿æ¢äº† ColorPoint çš„åŸå‹ã€‚åœ¨ new çš„è¿‡ç¨‹ä¸­æ²¡æœ‰ä¼ å…¥ä»»ä½•å‚æ•°ï¼Œå³ä½¿æˆ‘ä»¬ä¼ å…¥å‚æ•°ï¼Œä¹ŸæŠŠå­ç±» ColorPoint çš„ x å’Œ y å±æ€§å›ºå®šæ­»äº†ã€‚è¿™ä¼šå¯¼è‡´ ColorPoint åœ¨åˆ›å»ºå®ä¾‹æ—¶ï¼Œæ— æ³•ä¼ é€’ x å’Œ y å±æ€§ã€‚ æ‰€ä»¥åŸå‹é“¾è¿™ç§æ–¹å¼åªæ˜¯å®ç°äº†ç»§æ‰¿è€Œå·²ï¼Œå¹¶ä¸èƒ½æ»¡è¶³å®é™…å·¥ä½œçš„éœ€æ±‚ã€‚ ä½¿ç”¨ call å’Œ apply â€”â€” æ„é€ å‡½æ•°ç»‘å®šä¸ºäº†è§£å†³ä¸Šé¢è¯´çš„ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ call() å’Œ apply() åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­å°† this å’Œå‚æ•°ä¼ é€’ç»™çˆ¶ç±»æ„é€ å‡½æ•°ã€‚ ä»£ç ç¤ºä¾‹ 3ï¼š123456789101112131415161718192021function Point(x, y) &#123; //æ„é€ å‡½æ•° this.x = x || 10; this.y = x || 10; this.shapes = ['square','rectangle']; this.show = function() &#123; console.log('x: ' + this.x + ', y:' + this.y); &#125;&#125;function ColorPoint(x, y, color) &#123; Point.call(this, x, y); this.color = color || 'red';&#125;var cp1 = new ColorPoint();cp1.shapes.push('circle');console.log(cp1.shapes); // [\"square\", \"rectangle\", \"circle\"]cp1.show() //x: 10, y: 10var cp2 = new ColorPoint(100, 100);console.log(cp2.shapes); // [\"square\", \"rectangle\"]cp1.show() //x: 100, y: 100 è™½ç„¶è§£å†³äº†åŸå‹é“¾ä¸­çš„ä¸¤ä¸ªé—®é¢˜ï¼Œä½†è¿™ç§å€Ÿç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•è¿˜æ˜¯å­˜åœ¨å…¶ä»–é—®é¢˜ï¼Œå°±æ˜¯å‡½æ•°å¤ç”¨çš„é—®é¢˜ã€‚çˆ¶ç±» Point ä¸­çš„ show æ–¹æ³•æ— æ³•å¤ç”¨ï¼Œå­ç±» ColorPoint çš„æ‰€æœ‰å®ä¾‹éƒ½ä¼šé‡æ–°åˆ›å»º show æ–¹æ³•ã€‚æ‰€ä»¥è¿™ç§ç»§æ‰¿æ–¹å¼åœ¨å®é™…å·¥ä½œä¸­ä¹Ÿæ˜¯å¾ˆå°‘ç”¨çš„ã€‚ ç»„åˆç»§æ‰¿ â€”â€” æœ€å¸¸ç”¨ä¸ºäº†è§£å†³ä¸Šä¸€å°èŠ‚ä¸­å‡½æ•°å¤ç”¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿç”¨åŸå‹å¯¹è±¡ä¸­çš„å±æ€§æ˜¯å…±äº«è¿™ä¸€ç‰¹æ€§ã€‚æ€è·¯æ˜¯ä½¿ç”¨åŸå‹é“¾å®ç°å¯¹åŸå‹å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ï¼Œè€Œé€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥å®ç°å¯¹å®ä¾‹å±æ€§çš„ç»§æ‰¿ã€‚ ä»£ç ç¤ºä¾‹ 4ï¼š1234567891011121314151617181920212223242526function Point(x, y) &#123; //æ„é€ å‡½æ•° this.x = x || 10; this.y = x || 10; this.shapes = ['square','rectangle'];&#125;Point.prototype.show = function() &#123; console.log('x: ' + this.x + ', y:' + this.y);&#125;function ColorPoint(x, y, color) &#123; Point.call(this, x, y); // ç»§æ‰¿å±æ€§ this.color = color || 'red';&#125;ColorPoint.prototype = new Point(); // ç»§æ‰¿æ–¹æ³•ColorPoint.prototype.showColor = function() &#123; console.log('color: ' + this.color);&#125;var cp1 = new ColorPoint();cp1.shapes.push('circle');console.log(cp1.shapes); // [\"square\", \"rectangle\", \"circle\"]cp1.show(); //x: 10, y:10cp1.showColor(); //color: redvar cp2 = new ColorPoint(100, 100, 'yellow');console.log(cp2.shapes); // [\"square\", \"rectangle\"]cp2.show(); //x: 100, y:100cp2.showColor(); //color: yellow æ ¹æ®ä»£ç ç¤ºä¾‹ 4 ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³ç³»å›¾ï¼š å›¾ 3ï¼šColorPointã€Pointã€Object ä¹‹é—´æ–°çš„å…³ç³»å›¾ è¿™ç§ç»§æ‰¿çš„å®ç°æ–¹å¼ï¼Œè§£å†³äº†å‰ä¸¤ä¸ªå°èŠ‚ä¸­å‡ºç°çš„é—®é¢˜ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›å°ç‘•ç–µï¼Œå°±æ˜¯çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ï¼šä¸€æ¬¡æ˜¯åˆ›å»ºå­ç±»å‹çš„åŸå‹å¯¹è±¡ï¼Œ è¿˜æœ‰ä¸€æ¬¡æ˜¯å­ç±»å‹çš„æ„é€ å‡½æ•°ä¸­çš„ callã€‚è™½ç„¶å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œä½†å½±å“ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼è¿˜æ˜¯ JavaScript æœ€å¸¸ç”¨çš„ç»§æ‰¿æ¨¡å¼ã€‚ Class extendsES6 æä¾›äº†æ›´æ¥è¿‘ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€çš„ç»§æ‰¿å†™æ³•ï¼Œå¼•å…¥äº† Class çš„æ¦‚å¿µï¼Œ Class ä¹‹é—´å¯ä»¥é€šè¿‡ extends ç»§æ‰¿ã€‚ ä»£ç ç¤ºä¾‹ 5ï¼š1234567891011121314class Point&#123; constructor(x,y) &#123; this.x = x; this.y = y; &#125;&#125;class ColorPoint extends Point &#123; constructor(x,y,color) &#123; super(x, y); this.color = color; &#125;&#125;var p1 = new Point(2,3);var p2 = new ColorPoint(3,4, 'green'); è¿™æ®µä»£ç ä¸­å„ä¸ªç±»ä¹‹é—´çš„åŸå‹é“¾å›¾å¯ä»¥å‚è€ƒå¦ä¸€ç¯‡åšå®¢ã€Šå›¾è§£ JavaScript ä¸­çš„ __proto__ ä¸ prototypeã€‹ã€‚ ES6 è™½ç„¶æœ‰ Class çš„æ¦‚å¿µï¼Œä½†æ˜¯å…¶æœ¬è´¨è¿˜æ˜¯åŸºäºåŸå‹é“¾çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ Class çœ‹ä½œä¸€ä¸ªè¯­æ³•ç³–ã€‚ES6 ä¸­å…³äº Class çš„å…³é”®å­—é™¤äº† class å’Œ extendsï¼Œè¿˜æ–°å¢äº† constructor, static å’Œ superã€‚å…³äº Class çš„è¯¦ç»†çŸ¥è¯†å¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„ã€ŠES6 æ ‡å‡†å…¥é—¨ã€‹ä¸­çš„ Class ç« èŠ‚ã€‚ æ€»ç»“é™¤äº†ä¸Šé¢æåˆ°çš„ç»§æ‰¿æ–¹æ³•ï¼Œå¤§ç¥ Douglas Crockford è¿˜æ¨èäº†ä¸¤ç§å®ç°ç»§æ‰¿çš„æ–¹æ³•ï¼š åŸå‹å¼ç»§æ‰¿ å’Œ å¯„ç”Ÿå¼ç»§æ‰¿ã€‚è¿˜æœ‰ YUI çš„ YAHOO.lang.extend() é‡‡ç”¨çš„åŸºäºå¯„ç”Ÿå¼ç»§æ‰¿å’Œç»„åˆç»§æ‰¿çš„ å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œè¯¥ç»§æ‰¿æ–¹æ³•å¯ä»¥è§£å†³ç»„åˆç»§æ‰¿ä¸­çˆ¶ç±»æ„é€ å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡çš„é—®é¢˜ã€‚è¿™ä¸‰ç§ç»§æ‰¿æ–¹æ³•åœ¨çº¢å®ä¹¦ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ã€‹ç¬¬ 6 ç« ä¸­éƒ½æœ‰è¯¦ç»†ä»‹ç»ã€‚ ä¹¦è¯¥è¯»è¿˜æ˜¯å¾—è¯»ï¼Œå¸¸è¯»å¸¸æ–°ï¼Œéœ€è¦äº†è§£çš„åŸºç¡€éƒ½åœ¨é‡Œé¢ã€‚ å‚è€ƒæ–‡ç«  ES6 æ ‡å‡†å…¥é—¨ â€”â€” Class MDN â€”â€” ç»§æ‰¿ä¸åŸå‹é“¾","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"http://zhouweicsu.github.io/blog/tags/åŸºç¡€/"},{"name":"ç»§æ‰¿","slug":"ç»§æ‰¿","permalink":"http://zhouweicsu.github.io/blog/tags/ç»§æ‰¿/"}]},{"title":"Vue2.0 æºç é˜…è¯»ï¼šå“åº”å¼åŸç†","date":"2017-03-07T09:07:44.000Z","path":"2017/03/07/vue-2-0-reactivity/","text":"æœ¬æ–‡åŸºäº Vue.js 2.1.10 åŸºç¡€çŸ¥è¯†åœ¨è®²æºç ä¹‹å‰ï¼Œæˆ‘ä»¬äº†è§£ä¸€äº›é˜…è¯»æºç è¿‡ç¨‹ä¸­å¿…å¤‡çš„åŸºç¡€çŸ¥è¯†ï¼šObject.definePropertyï¼Œè§‚å¯Ÿè€…æ¨¡å¼ï¼ŒWatcherï¼ŒDep ä»¥åŠ Observer ç±»ã€‚ Object.definePropertyVue.js åœ¨å®˜ç½‘ä¸­æåˆ°ï¼š æŠŠä¸€ä¸ªæ™®é€š Javascript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.defineProperty æŠŠè¿™äº›å±æ€§å…¨éƒ¨è½¬ä¸º getter/setterã€‚Object.defineProperty æ˜¯ä»… ES5 æ”¯æŒï¼Œä¸”æ— æ³• shim çš„ç‰¹æ€§ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ Vue ä¸æ”¯æŒ IE8 ä»¥åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨çš„åŸå› ã€‚ å…¶ä¸­ Object.defineProperty æ˜¯ä¸ Angular çš„è„å€¼æ£€æŸ¥ä¸åŒçš„ MVVM å®ç°æ–¹å¼ï¼Œæ˜¯å®ç°å“åº”å¼çš„å…³é”®ã€‚è¯¥æ–¹æ³•çš„å…·ä½“è¯­æ³•ä¸ä½¿ç”¨è¯·å‚è€ƒ MDN: Object.defineProperty()ã€‚ éœ€è¦é‡ç‚¹æåŠçš„æ˜¯ descriptor ä¸­ get å’Œ set æ–¹æ³•ã€‚çœ‹ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š 1234567891011121314var obj = &#123;&#125;;var a;Object.defineProperty(obj, 'a', &#123; get: function() &#123; console.log('get val'); return a; &#125;, set: function(newVal) &#123; console.log('set val:' + newVal); a = newVal; &#125;&#125;);obj.a; // get val obj.a = '111'; // set val: 111 ç¤ºä¾‹ä»£ç ä¸­ Object.defineProperty æŠŠ obj çš„ a å±æ€§è½¬åŒ–ä¸º getter å’Œ setterï¼Œå¯ä»¥å®ç° obj.a çš„æ•°æ®ç›‘æ§ã€‚è¿™ä¸ªè½¬åŒ–æ˜¯ Vue.js å“åº”å¼çš„åŸºçŸ³ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ç»´åŸºç™¾ç§‘ä¸­å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„å®šä¹‰ï¼š è§‚å¯Ÿè€…æ¨¡å¼æ˜¯è½¯ä»¶è®¾è®¡æ¨¡å¼çš„ä¸€ç§ã€‚åœ¨æ­¤ç§æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç›®æ ‡å¯¹è±¡ç®¡ç†æ‰€æœ‰ç›¸ä¾äºå®ƒçš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å®ƒæœ¬èº«çš„çŠ¶æ€æ”¹å˜æ—¶ä¸»åŠ¨å‘å‡ºé€šçŸ¥ã€‚è¿™é€šå¸¸é€è¿‡å‘¼å«å„è§‚å¯Ÿè€…æ‰€æä¾›çš„æ–¹æ³•æ¥å®ç°ã€‚æ­¤ç§æ¨¡å¼é€šå¸¸è¢«ç”¨æ¥å®æ—¶äº‹ä»¶å¤„ç†ç³»ç»Ÿã€‚ è®¢é˜…è€…æ¨¡å¼æ¶‰åŠä¸‰ä¸ªå¯¹è±¡ï¼šå‘å¸ƒè€…ã€ä¸»é¢˜å¯¹è±¡ã€è®¢é˜…è€…ï¼Œä¸‰ä¸ªå¯¹è±¡é—´çš„æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæ¯å½“ä¸»é¢˜å¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå…¶ç›¸å…³ä¾èµ–å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥ï¼Œå¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚çœ‹ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233function Dep() &#123;//ä¸»é¢˜å¯¹è±¡ this.subs = []; //è®¢é˜…è€…åˆ—è¡¨&#125;Dep.prototype.notify = function() &#123; //ä¸»é¢˜å¯¹è±¡é€šçŸ¥è®¢é˜…è€… this.subs.forEach(function(sub)&#123; //éå†æ‰€æœ‰çš„è®¢é˜…è€…ï¼Œæ‰§è¡Œè®¢é˜…è€…æä¾›çš„æ›´æ–°æ–¹æ³• sub.update(); &#125;);&#125;function Sub(x) &#123; //è®¢é˜…è€… this.x = x;&#125;Sub.prototype.update = function() &#123; //è®¢é˜…è€…æ›´æ–° this.x = this.x + 1; console.log(this.x);&#125;var pub = &#123; //å‘å¸ƒè€… publish: function() &#123; dep.notify(); &#125;&#125;;var dep = new Dep(); //ä¸»é¢˜å¯¹è±¡å®ä¾‹Array.prototype.push.call(dep.subs, new Sub(1), new Sub(2), new Sub(4)); //æ–°å¢ 3 ä¸ªè®¢é˜…è€…pub.publish(); //å‘å¸ƒè€…å‘å¸ƒæ›´æ–°// 2// 3// 5 ä»£ç ç¤ºä¾‹ä¸­å‘å¸ƒè€…ï¼ˆpubï¼‰å‘å‡ºé€šçŸ¥ï¼ˆnotifyï¼‰ï¼Œä¸»é¢˜å¯¹è±¡ï¼ˆDepï¼‰æ”¶åˆ°é€šçŸ¥å¹¶æ¨é€ç»™è®¢é˜…è€…ï¼ˆSubï¼‰ï¼Œè®¢é˜…è€…æ‰§è¡Œç›¸åº”æ“ä½œï¼ˆupdateï¼‰ã€‚Vue.js ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªæ¨¡å¼æ¥å®ç°æ•°æ®é©±åŠ¨è§†å›¾ã€‚ä¸Šä¸€ä¸ªå°èŠ‚è®²çš„ setter æ–¹æ³•å°±æ˜¯ä¸€ä¸ªå‘å¸ƒè€…ï¼Œåé¢æˆ‘ä»¬ä¼šè¯¦ç»†è®²åˆ°ã€‚ Observerã€Watcherã€DepObserverã€Watcherã€Dep æ˜¯å“åº”å¼åŸç†ä¸­æ¶‰åŠåˆ°çš„ 3 ä¸ªé‡è¦çš„å¯¹è±¡ã€‚ ä»£ç ä¸­çš„è‹±æ–‡æ³¨é‡Šå‡ä¸ºæºç ä¸­è‡ªå¸¦ï¼Œä¸­æ–‡æ³¨é‡Šä¸ºä½œè€…æ·»åŠ ã€‚ Observer Vue ä¸­çš„æ•°æ®å¯¹è±¡éƒ½ä¼šåœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­è½¬åŒ–ä¸º Observer å¯¹è±¡ã€‚ æˆ‘ä»¬é€šè¿‡æºç çœ‹ä¸€ä¸‹ Observer å¯¹è±¡çš„ç»“æ„ï¼ŒObserver å¯¹è±¡çš„ constructor å‡½æ•°ï¼ˆsrc/core/observer/index.jsï¼‰ï¼š123456789101112131415constructor (value: any) &#123; this.value = value this.dep = new Dep() //ä¸€ä¸ª Depå¯¹è±¡å®ä¾‹ï¼ŒWatcher å’Œ Observer ä¹‹é—´çš„çº½å¸¦ this.vmCount = 0 def(value, '__ob__', this) //æŠŠè‡ªèº« this æ·»åŠ åˆ° value çš„ __ob__ å±æ€§ä¸Š if (Array.isArray(value)) &#123; //å¯¹ value çš„ç±»å‹è¿›è¡Œåˆ¤æ–­ const augment = hasProto ? protoAugment : copyAugment augment(value, arrayMethods, arrayKeys) // æ•°ç»„å¢å¼ºæ–¹æ³• this.observeArray(value) //å¦‚æœæ˜¯æ•°ç»„åˆ™è§‚å¯Ÿæ•°ç»„ &#125; else &#123; this.walk(value) //å¦åˆ™è§‚å¯Ÿå•ä¸ªå…ƒç´ ã€‚ &#125;&#125; Observer å¯¹è±¡çš„æ ‡å¿—å°±æ˜¯ __ob__ è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§ä¿å­˜äº† Observer å¯¹è±¡è‡ªå·±æœ¬èº«ã€‚å¯¹è±¡åœ¨è½¬åŒ–ä¸º Observer å¯¹è±¡çš„è¿‡ç¨‹ä¸­æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œå¯¹è±¡çš„å­å…ƒç´ å¦‚æœæ˜¯å¯¹è±¡æˆ–æ•°ç»„çš„è¯ï¼Œä¹Ÿä¼šè½¬åŒ–ä¸º Observer å¯¹è±¡ã€‚ Note: ç”±äº JavaScript çš„é™åˆ¶ï¼Œ Vue ä¸èƒ½æ£€æµ‹æ•°ç»„çš„å˜åŒ–ï¼Œäºæ˜¯ä½œè€…åœ¨æ•°ç»„å¢å¼ºæ–¹æ³•ä¸­å¯¹ Array çš„ â€˜pushâ€™, â€˜popâ€™, â€˜shiftâ€™, â€˜unshiftâ€™, â€˜spliceâ€™, â€˜sortâ€™, â€˜reverseâ€™ æ–¹æ³•åšäº†å¢å¼ºå®ç°ï¼Œå…·ä½“å®ç°å¯ä»¥çœ‹æºç ï¼Œè¿™ä¹Ÿæ˜¯ Vue.js ä¸­æ•°ç»„æ“ä½œåªèƒ½ä½¿ç”¨è¿™ 7 ä¸ªæ–¹æ³•çš„åŸå› ã€‚ Watcher Watcher æ˜¯å°†æ¨¡æ¿å’Œ Observer å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·çš„çº½å¸¦ã€‚Watcher æ˜¯è®¢é˜…è€…æ¨¡å¼ä¸­çš„è®¢é˜…è€…ã€‚Watcher çš„æ¥æºæœ‰ 3 ç§ï¼Œä»£ç ä¸­çš„ computed å±æ€§ï¼ˆTipsï¼šè‹¥è¯¥ computed å±æ€§æœªå†æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œåˆ™ä¸ä¼šç”Ÿæˆ Watcher å®ä¾‹ï¼‰ã€watch å‡½æ•°ä»¥åŠæ¨¡æ¿ç¼–è¯‘è¿‡ç¨‹ä¸­çš„æŒ‡ä»¤å’Œæ•°æ®ç»‘å®šã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹æºç ä¸­ Watcher çš„ constructor å‡½æ•°ï¼ˆsrc/core/observer/watcher.jsï¼‰ï¼š 123456789101112131415161718192021constructor ( vm: Component, expOrFn: string | Function, cb: Function, options?: Object) &#123; this.vm = vm vm._watchers.push(this)// å°†å½“å‰ Watcher ç±»æ¨é€åˆ°å¯¹åº”çš„ Vue å®ä¾‹ä¸­ ...... // parse expression for getter if (typeof expOrFn === 'function') &#123; // å¦‚æœæ˜¯å‡½æ•°ï¼Œç›¸å½“äºæŒ‡å®šäº†å½“å‰è®¢é˜…è€…è·å–æ•°æ®çš„æ–¹æ³•ï¼Œæ¯æ¬¡è®¢é˜…è€…é€šè¿‡è¿™ä¸ªæ–¹æ³•è·å–æ•°æ®ç„¶åä¸ä¹‹å‰çš„å€¼è¿›è¡Œå¯¹æ¯” this.getter = expOrFn &#125; else &#123; this.getter = parsePath(expOrFn)// å¦åˆ™çš„è¯å°†è¡¨è¾¾å¼è§£æä¸ºå¯æ‰§è¡Œçš„å‡½æ•° ...... &#125; this.value = this.lazy ? undefined : this.get() //å¦‚æœ lazy ä¸ä¸º trueï¼Œåˆ™æ‰§è¡Œ get å‡½æ•°è¿›è¡Œä¾èµ–æ”¶é›†&#125; Watcher çš„ä¸¤ä¸ªå‚æ•°ï¼š expOrFn æœ€ç»ˆä¼šè¢«è½¬æ¢ä¸º getter å‡½æ•°ï¼Œ cb æ˜¯æ›´æ–°æ—¶æ‰§è¡Œçš„å›è°ƒã€‚ä¾èµ–æ”¶é›†çš„å…¥å£å°±æ˜¯ get å‡½æ•°ã€‚ æºç ä¸­ Watcher çš„ get å‡½æ•°ï¼ˆsrc/core/observer/watcher.jsï¼‰ï¼š123456789101112131415/*** Evaluate the getter, and re-collect dependencies.*/get () &#123; pushTarget(this) // è®¾ç½®å…¨å±€å˜é‡ Dep.targetï¼Œå°† Watcher ä¿å­˜åœ¨è¿™ä¸ªå…¨å±€å˜é‡ä¸­ï¼Œ2.0 å˜æˆäº† pushTarget æ²¡æœ‰ç»†çœ‹ä¸ºä»€ä¹ˆ const value = this.getter.call(this.vm, this.vm) // è°ƒç”¨ getter å‡½æ•°ï¼Œè¿›å…¥ get æ–¹æ³•è¿›è¡Œä¾èµ–æ”¶é›†æ“ä½œ // \"touch\" every property so they are all tracked as // dependencies for deep watching if (this.deep) &#123; traverse(value) &#125; popTarget() // å°†å…¨å±€å˜é‡ Dep.target ç½®ä¸º null this.cleanupDeps() return value &#125; getter å‡½æ•°æ˜¯ç”¨æ¥è¿æ¥ç›‘æ§å±æ€§ä¸ Watcher çš„å…³é”®ã€‚const value = this.getter.call(this.vm, this.vm) è¿™ä¸€è¡Œå°±æ˜¯å» touch Watcher åˆå§‹åŒ–æ—¶ä¼ å…¥çš„å‚æ•° expOrFn ä¸­æ¶‰åŠåˆ°çš„æ¯ä¸€é¡¹æ•°æ®ï¼Œç„¶åè§¦å‘è¯¥æ•°æ®é¡¹çš„ getter å‡½æ•°ï¼›è®¾ç½® Dep.target æ˜¯ä¸ªä¾èµ–æ”¶é›†è¿‡ç¨‹ä¸­çš„é‡è¦ä¸€æ­¥ï¼Œgetter å‡½æ•°ä¸­å°±æ˜¯é€šè¿‡åˆ¤æ–­ Dep.target çš„æœ‰æ— æ¥åˆ¤æ–­æ˜¯ Watcher åˆå§‹åŒ–æ—¶è°ƒç”¨çš„è¿˜æ˜¯æ™®é€šæ•°æ®è¯»å–ï¼Œå¦‚æœæœ‰åˆ™è¿›è¡Œä¾èµ–æ”¶é›†ã€‚ Dep Dep ç±»æ˜¯ Watcher å’Œ Observer ä¹‹é—´çš„çº½å¸¦ã€‚æ¯ä¸€ä¸ª Observer éƒ½æœ‰ä¸€ä¸ª Dep å®ä¾‹ï¼Œç”¨æ¥å­˜å‚¨è®¢é˜…è€… Watcherã€‚ çœ‹ä¸€ä¸‹æºç ä¸­ Dep ç±»çš„ constructor å‡½æ•°ï¼ˆsrc/core/observer/dep.jsï¼‰ï¼š 1234constructor () &#123; this.id = uid++ this.subs = [] //å­˜å‚¨ Watcher å®ä¾‹çš„æ•°ç»„&#125; æˆ‘ä»¬çœ‹åˆ°æºç ä¸­è¿™ä¸ªç±»éå¸¸ç®€å•ï¼Œåªæœ‰ä¸€ä¸ª id å’Œä¸€ä¸ªæ•°ç»„ subsã€‚ æºç ä¸­ Dep ç±»çš„ notify å‡½æ•°ï¼ˆsrc/core/observer/dep.jsï¼‰ï¼š 1234567notify () &#123; // stablize the subscriber list first const subs = this.subs.slice() for (let i = 0, l = subs.length; i &lt; l; i++) &#123; //éå† Watcher åˆ—è¡¨ï¼Œè°ƒç”¨ update æ–¹æ³•è¿›è¡Œæ›´æ–°æ“ä½œ subs[i].update() &#125;&#125; è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨å“åº”å¼çš„è¿‡ç¨‹ä¸­è°ƒç”¨çš„ï¼Œç”¨æˆ·ä¿®æ”¹æ•°æ®è§¦å‘ setter å‡½æ•°ï¼Œå‡½æ•°çš„æœ€åä¸€è¡Œå°±æ˜¯è°ƒç”¨ dep.notify å»é€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾ã€‚ æºç è§£æäº†è§£ä¸Šé¢ä¸‰ä¸ªé‡è¦çš„ç±»ä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥é€šè¿‡æºç æ·±å…¥äº†è§£æ•°æ®åŒå‘ç»‘å®šçš„è¿‡ç¨‹ã€‚ æºç ç›®å½•ç»“æ„é˜…è¯»æºç ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆä»‹ç»ä¸€ä¸‹ç›¸å…³æºç çš„ç›®å½•ã€‚ src |â€” compile æ¨¡æ¿ç¼–è¯‘çš„ä»£ç ï¼Œ1.0 å’Œ 2.0 ç‰ˆæœ¬åœ¨æ¨¡æ¿ç¼–è¯‘è¿™ä¸€å—æ”¹åŠ¨éå¸¸å¤§ |â€” core/instance ç”Ÿå‘½å‘¨æœŸï¼Œåˆå§‹åŒ–å…¥å£ |â€” core/observer å“åº”å¼ |â€” core/vdom è™šæ‹ŸDOM |â€” entries ç¼–è¯‘å…¥å£æ–‡ä»¶ æœ¬æ–‡ä¸­æ¶‰åŠçš„å“åº”å¼ä»£ç å¤§éƒ¨åˆ†éƒ½åœ¨ src/core/observer/ æ–‡ä»¶å¤¹ä¸‹ã€‚ ç”Ÿå‘½å‘¨æœŸä»ç°åœ¨å¼€å§‹æ¨è WebStrom æŸ¥çœ‹æºç ï¼ˆæŒ‰ä½ control é”®å•å‡»æ–¹æ³•åå¯ä»¥ç›´æ¥è·³è½¬ï¼Œæºç é˜…è¯»ç¥å™¨ï¼‰ï¼Œæˆ–è€…åœ¨æµè§ˆå™¨ä¸­æ‰“æ–­ç‚¹è·Ÿç€æœ¬æ–‡çš„é¡ºåºå¾€ä¸‹çœ‹æºç ã€‚ æˆ‘ä»¬å…ˆæ‰¾åˆ°æºç å…¥å£ï¼ˆå³ new Vueï¼‰å¼€å§‹è®²ï¼Œå…¥å£æ–‡ä»¶æ˜¯ src/core/instance/index.jsï¼Œè¿™æ®µä»£ç å¾ˆç®€å•ï¼Œæˆ‘å°±ä¸åˆ—å‡ºæ¥äº†ï¼Œé‡Œé¢å°±æ˜¯æç¤ºéœ€è¦ç”¨ new æ¥å®ä¾‹åŒ– Vue ï¼Œç„¶åè°ƒç”¨ this._init æ–¹æ³•å¼€å§‹ Vue çš„ç”Ÿå‘½å‘¨æœŸã€‚ç”Ÿå‘½å‘¨æœŸçš„ç¤ºæ„å›¾å¯ä»¥å‚è€ƒå®˜ç½‘ï¼š è¿™ä¸ªå›¾ä¸ç›®å‰çš„ç‰ˆæœ¬ï¼ˆ2.1.10ï¼‰ä»£ç ç¨æœ‰å·®å¼‚ï¼Œä¸»è¦æ˜¯ä¸€äº›åˆå§‹åŒ–çš„é¡ºåºã€‚ä¸å½±å“å¯¹å“åº”å¼åŸç†çš„ç†è§£ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸæºç ï¼ˆsrc/core/instance/init.jsï¼‰ï¼š123456789initLifecycle(vm) //vm çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³å˜é‡åˆå§‹åŒ–initEvents(vm) // vm çš„äº‹ä»¶ç›‘æ§åˆå§‹åŒ–initRender(vm) // æ¨¡æ¿è§£æcallHook(vm, 'beforeCreate')initState(vm) //vm çš„çŠ¶æ€åˆå§‹åŒ–ï¼Œprop/data/computed/method/watch éƒ½åœ¨è¿™é‡Œå®Œæˆåˆå§‹åŒ–ï¼Œæ˜¯å“åº”å¼çš„å…³é”®æ­¥ï¼callHook(vm, 'created')if (vm.$options.el) &#123; vm.$mount(vm.$options.el)&#125; initLifecycle ä¸»è¦æ˜¯åˆå§‹åŒ– vm å®ä¾‹ä¸Šçš„ä¸€äº›å‚æ•°ï¼›initEvents æ˜¯äº‹ä»¶ç›‘æ§çš„åˆå§‹åŒ–ï¼›initRender æ˜¯æ¨¡æ¿è§£æï¼Œå€¼å¾—ä¸€æçš„æ˜¯åœ¨ 2.0 çš„ç‰ˆæœ¬ä¸­è¿™ä¸€å—æœ‰å¾ˆå¤§çš„æ”¹åŠ¨ï¼Œ1.0 çš„ç‰ˆæœ¬ä¸­ Vue ä½¿ç”¨çš„æ˜¯ DocumentFragment æ¥è¿›è¡Œæ¨¡æ¿è§£æï¼Œè€Œ 2.0 ä¹‹åä½œè€…é‡‡ç”¨ John Resig çš„ HTML Parser å°†æ¨¡æ¿è§£ææˆå¯ç›´æ¥æ‰§è¡Œçš„ render å‡½æ•°ï¼Œè¿™æ˜¯æ¨¡æ¿é¢„ç¼–è¯‘å’ŒæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰çš„å‰æï¼›callHook(vm, â€˜beforeCreateâ€™)æ˜¯æ‰§è¡Œé’©å­å‡½æ•°ï¼Œå°±æ˜¯ä½ åœ¨ new Vue å®ä¾‹çš„æ—¶å€™å†™çš„ beforeCreate æ–¹æ³•ï¼›initState æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œæˆ‘ä»¬ä¸‹ä¸€èŠ‚ä¼šè¯¦ç»†è®²åˆ°ï¼›callHook(vm, â€˜createdâ€™)ä¹Ÿæ˜¯æ‰§è¡Œé’©å­å‡½æ•°ï¼›æœ€åæ˜¯æ˜¯æ‰§è¡Œ mount å‡½æ•°ã€‚ initStateè·Ÿéšä»£ç èµ°å…¥ initState é‡Œé¢ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æºç ï¼ˆsrc/core/instance/state.jsï¼‰ï¼š12345678910111213export function initState (vm: Component) &#123; vm._watchers = [] //æ–°å»ºä¸€ä¸ªè®¢é˜…è€…åˆ—è¡¨ const opts = vm.$options if (opts.props) initProps(vm, opts.props) // åˆå§‹åŒ– Propsï¼Œä¸ initData å·®ä¸å¤š if (opts.methods) initMethods(vm, opts.methods) // åˆå§‹åŒ– Methodsï¼ŒMethods çš„åˆå§‹åŒ–æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä½œç”¨åŸŸçš„é‡æ–°ç»‘å®šã€‚ if (opts.data) &#123; initData(vm) // åˆå§‹åŒ– Dataï¼Œå“åº”å¼å…³é”®æ­¥ &#125; else &#123; observe(vm._data = &#123;&#125;, true /* asRootData */) //å¦‚æœæ²¡æœ‰ dataï¼Œåˆ™è§‚å¯Ÿä¸€ä¸ªç©ºå¯¹è±¡ &#125; if (opts.computed) initComputed(vm, opts.computed)// åˆå§‹åŒ– computedï¼Œè¿™éƒ¨åˆ†ä¼šæ¶‰åŠ Watcher ç±»ä»¥åŠä¾èµ–æ”¶é›†ï¼Œcomputed å…¶å®æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„ Watcher if (opts.watch) initWatch(vm, opts.watch)// åˆå§‹åŒ– watchï¼Œè¿™éƒ¨åˆ†ä¼šæ¶‰åŠ Watcher ç±»ä»¥åŠä¾èµ–æ”¶é›†&#125; ä»£ç ä¸­æ¯ä¸€æ­¥éƒ½æœ‰æ³¨é‡Šï¼Œè¿™äº›åˆå§‹åŒ–éƒ½æ¶‰åŠåˆ°æ•°æ®è½¬åŒ–ä¸º Observer å¯¹è±¡çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¼šä»¥ initData ä¸ºä¾‹æ¥è®²å“åº”å¼ã€‚ initDataè¿›å…¥ initData æ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹æºç ï¼ˆsrc/core/instance/state.jsï¼‰ï¼š 12345678910111213141516171819202122function initData (vm: Component) &#123; let data = vm.$options.data data = vm._data = typeof data === 'function' ? data.call(vm) : data || &#123;&#125; if (!isPlainObject(data)) &#123;// ä¿è¯dataå¿…é¡»ä¸ºçº¯å¯¹è±¡ ...... &#125; // proxy data on instance const keys = Object.keys(data) const props = vm.$options.props let i = keys.length while (i--) &#123; if (props &amp;&amp; hasOwn(props, keys[i])) &#123;// æ˜¯propsï¼Œåˆ™ä¸ä»£ç† ...... //å¦‚æœå’Œ props é‡Œé¢çš„å˜é‡é‡äº†ï¼Œåˆ™æŠ›å‡º Warning &#125; else &#123;// å¦åˆ™å°†å±æ€§ä»£ç†çš„ vm ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ vm.xx è®¿é—®åˆ° vm._data.xx proxy(vm, keys[i]) //proxyæ–¹æ³•éå† data çš„ keyï¼ŒæŠŠ data ä¸Šçš„å±æ€§ä»£ç†åˆ° vm å®ä¾‹ä¸Š &#125; &#125; // observe data observe(data, true /* asRootData */) //å…³é”®æ­¥ï¼observe(data, this)æ–¹æ³•æ¥å¯¹ data åšç›‘æ§&#125; è¿™ä¸ªå‡½æ•°åšäº†ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š ä¿è¯ data ä¸ºçº¯å¯¹è±¡ åˆ¤æ–­ä¸ props é‡Œçš„å±æ€§æ˜¯å¦æœ‰é‡å¤ï¼Œæœ‰å°±æŠ¥é”™ è¿›è¡Œæ•°æ®ä»£ç†ï¼Œæ–¹ä¾¿æ•°æ®è¯»å–ï¼Œä»£ç†åæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ vm.keyï¼Œè€Œä¸éœ€è¦ vm._data.key è°ƒç”¨ observe æ–¹æ³•ï¼Œè¿™æ˜¯å“åº”å¼çš„å…³é”®æ­¥ï¼ observeobserve æ–¹æ³•ä¼šä¸ºä¼ è¿›æ¥çš„ value å€¼åˆ›å»ºä¸€ä¸ª Observer å¯¹è±¡ï¼Œåˆ›å»ºä¹‹å‰ä¼šåšä¸€äº›åˆ¤æ–­ã€‚çœ‹ä¸€ä¸‹æºç ï¼ˆsrc/core/observer/index.jsï¼‰:12345678910111213141516171819202122232425262728/** * Attempt to create an observer instance for a value, * returns the new observer if successfully observed, * or the existing observer if the value already has one. * è¿”å›ä¸€ä¸ª Observer å¯¹è±¡ */export function observe (value: any, asRootData: ?boolean): Observer | void &#123; if (!isObject(value)) &#123; //å¦‚æœä¸æ˜¯å¯¹è±¡å’Œæ•°ç»„åˆ™ä¸ç›‘æ§ï¼Œç›´æ¥è¿”å› return &#125; let ob: Observer | void //åˆ¤æ–­ value æ˜¯å¦å·²ç»æ·»åŠ äº† __ob__ å±æ€§ï¼Œå¹¶ä¸”å±æ€§å€¼æ˜¯ Observer å¯¹è±¡çš„å®ä¾‹ã€‚é¿å…é‡å¤å¼•ç”¨å¯¼è‡´çš„æ­»å¾ªç¯ if (hasOwn(value, '__ob__') &amp;&amp; value.__ob__ instanceof Observer) &#123; //å¦‚æœæ˜¯å°±ç›´æ¥ç”¨ ob = value.__ob__ &#125; else if ( observerState.shouldConvert &amp;&amp; //åªæœ‰ root instance props éœ€è¦åˆ›å»º Observer å¯¹è±¡ !isServerRendering() &amp;&amp; //ä¸æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ (Array.isArray(value) || isPlainObject(value)) &amp;&amp; //æ•°ç»„æˆ–è€…æ™®é€šå¯¹è±¡ Object.isExtensible(value) &amp;&amp; //å¯æ‰©å±•å¯¹è±¡ !value._isVue // é Vue ç»„ä»¶ ) &#123; ob = new Observer(value) //å…³é”®æ­¥ï¼åœ¨ value æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ª Observer å¯¹è±¡ &#125; if (asRootData &amp;&amp; ob) &#123; ob.vmCount++ &#125; return ob // è¿”å›ä¸€ä¸ª Observer å¯¹è±¡&#125; observe æ–¹æ³•ä¸»è¦å°±æ˜¯åˆ¤æ–­ value æ˜¯å¦å·²ç»æ˜¯ Observer å¯¹è±¡ï¼Œå¦‚æœæ˜¯ç›´æ¥è¿”å›ï¼›å¦åˆ™ï¼Œè‹¥å¹²ä¸ªåˆ¤æ–­æ¡ä»¶æˆç«‹åˆ™å°†è¿™ä¸ªå¯¹è±¡è½¬åŒ–ä¸º Observer å¯¹è±¡ã€‚ Observer ç±»ä¸Šé¢åŸºç¡€çŸ¥è¯†æˆ‘ä»¬å·²ç»è®²è¿‡ Observer ç±»ï¼Œå…¶æ„é€ å‡½æ•°ä¸»è¦åšäº†è¿™ä¹ˆå‡ ä»¶äº‹ï¼š é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª Dep å¯¹è±¡å®ä¾‹ï¼› ç„¶åæŠŠè‡ªèº« this æ·»åŠ åˆ° value çš„ __ob__ å±æ€§ä¸Šï¼› æœ€åå¯¹ value çš„ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯æ•°ç»„åˆ™è§‚å¯Ÿæ•°ç»„ï¼Œå¦åˆ™è§‚å¯Ÿå•ä¸ªå…ƒç´ ï¼ˆè¦ç†è§£è¿™ä¸€æ­¥æ˜¯ä¸ªé€’å½’è¿‡ç¨‹ï¼Œå³ value çš„å…ƒç´ å¦‚æœç¬¦åˆæ¡ä»¶ä¹Ÿéœ€è¦è½¬åŒ–ä¸º Observer å¯¹è±¡ï¼‰ã€‚ å…¶å® observeArray æ–¹æ³•å°±æ˜¯å¯¹æ•°ç»„è¿›è¡Œéå†ï¼Œé€’å½’è°ƒç”¨ observe æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šèµ°å…¥ walk æ–¹æ³•ï¼ˆä»£ç å¾ˆç®€å•ï¼Œå°±ä¸å•ç‹¬åˆ—å‡ºæ¥ï¼Œå¯ä»¥æˆ³é“¾æ¥è¿›å…¥ github æŸ¥çœ‹ï¼‰ç›‘æ§å•ä¸ªå…ƒç´ ã€‚è€Œ walk æ–¹æ³•å°±æ˜¯éå†å¯¹è±¡ï¼Œç»“åˆ defineReactive æ–¹æ³•é€’å½’å°†å±æ€§è½¬åŒ–ä¸º getter å’Œ setterã€‚ defineReactiveæ­¤æ–¹æ³•æ˜¯æœ€ç»ˆå®ç°å“åº”å¼çš„é‡ç‚¹ï¼åŸºçŸ³ï¼æ ¸å¿ƒï¼çœ‹ä¸€ä¸‹æºç ï¼ˆsrc/core/observer/index.jsï¼‰ï¼š 1234567891011121314151617181920212223242526272829303132333435363738/** * Define a reactive property on an Object. */export function defineReactive ( obj: Object, key: string, val: any, customSetter?: Function) &#123; const dep = new Dep() //æ¯ä¸ªå¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ª Dep å®ä¾‹ï¼Œç”¨æ¥ä¿å­˜ä¾èµ– (Watcher å¯¹è±¡) ...... let childOb = observe(val) //ç»“åˆ observe å‡½æ•°è¿›è¡Œå°†å¯¹è±¡çš„å¯¹è±¡ä¹Ÿå˜æˆç›‘æ§å¯¹è±¡ // æœ€é‡ç‚¹ã€åŸºçŸ³ã€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼šé€šè¿‡è°ƒç”¨ Object.defineProperty ç»™ data çš„æ¯ä¸ªå±æ€§æ·»åŠ  getter å’Œ setter æ–¹æ³•ã€‚ Object.defineProperty(obj, key, &#123; enumerable: true, configurable: true, get: function reactiveGetter () &#123; const value = getter ? getter.call(obj) : val // ä¾èµ–æ”¶é›†çš„é‡è¦æ­¥éª¤ if (Dep.target) &#123;//å¦‚æœå­˜åœ¨ Dep.target è¿™ä¸ªå…¨å±€å˜é‡ä¸ä¸ºç©ºï¼Œè¡¨ç¤ºæ˜¯åœ¨æ–°å»º Watcher çš„æ—¶å€™è°ƒç”¨çš„ï¼Œä»£ç å·²ç»ä¿è¯ dep.depend() // ä¾èµ–æ”¶é›† if (childOb) &#123; childOb.dep.depend() // å¤„ç†å¥½å­å…ƒç´ çš„ä¾èµ– watcher &#125; if (Array.isArray(value)) &#123; // å¦‚æœæ˜¯æ•°ç»„ï¼Œè¿›ä¸€æ­¥å¤„ç† dependArray(value) &#125; &#125; return value &#125;, set: function reactiveSetter (newVal) &#123; const value = getter ? getter.call(obj) : val ...... childOb = observe(newVal) // å¯¹æ–°æ•°æ®é‡æ–° observeï¼Œæ›´æ–°æ•°æ®çš„ä¾èµ–å…³ç³» dep.notify() // é€šçŸ¥ dep è¿›è¡Œæ•°æ®æ›´æ–°ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨å‰é¢çš„ Dep ç±»ä¸­è®²è¿‡ &#125; &#125;)&#125; defineReactive æ˜¯å¯¹ Object.defineProperty æ–¹æ³•çš„åŒ…è£…ï¼Œç»“åˆ observe æ–¹æ³•å¯¹æ•°æ®é¡¹è¿›è¡Œæ·±å…¥éå†ï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„å±æ€§å°±è½¬åŒ–ä¸º getter å’Œ setterã€‚è‡³æ­¤ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½å·²ç»è½¬æ¢ä¸º Observer å¯¹è±¡ã€‚å³æ•°æ®çš„è¯»æ“ä½œéƒ½ä¼šè§¦å‘ getter å‡½æ•°ï¼Œå†™æ“ä½œéƒ½ä¼šè§¦å‘ setter å‡½æ•°ã€‚ ä¾èµ–æ”¶é›†åœ¨ä¸Šé¢ä»‹ç»æºç çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¤šæ¬¡æåˆ°è¿‡ä¾èµ–æ”¶é›†ï¼Œè¿™å…·ä½“æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹ï¼Œå®ƒæ˜¯å¦‚ä½•å°†æ¨¡æ¿ä¸­çš„æŒ‡ä»¤ä¸æ•°æ®å…³è”åœ¨ä¸€èµ·çš„å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯¹ä¾èµ–æ”¶é›†è¿‡ç¨‹è¿›è¡Œä¸€ä¸ªæ€»ç»“ã€‚ ä¾èµ–æ”¶é›†æ˜¯é€šè¿‡å±æ€§çš„ getter å‡½æ•°å®Œæˆçš„ï¼Œæ–‡ç« ä¸€å¼€å§‹è®²åˆ°çš„ Observerã€Watcherã€Dep éƒ½ä¸ä¾èµ–æ”¶é›†ç›¸å…³ã€‚å…¶ä¸­ Observer ä¸ Dep æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œ Dep ä¸ Watcher æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚Dep åˆ™æ˜¯ Observer å’Œ Watcher ä¹‹é—´çš„çº½å¸¦ã€‚ä¾èµ–æ”¶é›†å®Œæˆåï¼Œå½“å±æ€§å˜åŒ–ä¼šæ‰§è¡Œä¸»é¢˜å¯¹è±¡ï¼ˆObserverï¼‰çš„ dep.notify æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šéå†è®¢é˜…è€…ï¼ˆWatcherï¼‰åˆ—è¡¨å‘å…¶å‘é€æ¶ˆæ¯ï¼ŒWatcher ä¼šæ‰§è¡Œ run æ–¹æ³•å»æ›´æ–°è§†å›¾ã€‚ä¾èµ–çš„å…³è”å…³ç³»å…·ä½“å¯å‚è€ƒä¸‹å›¾ï¼š æ€»ç»“ä¾èµ–å…³ç³»å»ºç«‹çš„æ­¥éª¤ï¼š æ¨¡æ¿ç¼–è¯‘è¿‡ç¨‹ä¸­çš„æŒ‡ä»¤å’Œæ•°æ®ç»‘å®šéƒ½ä¼šç”Ÿæˆ Watcher å®ä¾‹ï¼Œcomputed å±æ€§å’Œ watch å‡½æ•°ä¸­çš„å¯¹è±¡ä¹Ÿä¼šç”Ÿæˆ Watcher å®ä¾‹ï¼Œåœ¨æ¨¡æ¿ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæ‰§è¡Œ Watcher å®ä¾‹çš„ expOrFnï¼ˆåˆå§‹åŒ– Watcher å®ä¾‹æ—¶ä¼ å…¥çš„å‚æ•°ï¼‰ï¼Œè¿›å…¥ watcher.js ä¸­çš„ get å‡½æ•° è®¿é—® expOrFn æ¶‰åŠçš„æ‰€æœ‰å±æ€§ï¼› è®¿é—®å±æ€§ä¹‹å‰ï¼ŒWatcher ä¼šè®¾ç½® Dep çš„é™æ€å±æ€§ Dep.target æŒ‡å‘å…¶è‡ªèº«ï¼Œç„¶åå¼€å§‹ä¾èµ–æ”¶é›†ï¼› è®¿é—®å±æ€§çš„è¿‡ç¨‹ä¸­ï¼Œå±æ€§çš„ getter å‡½æ•°ä¼šè¢«è®¿é—®ï¼› å±æ€§ getter å‡½æ•°ä¸­ä¼šåˆ¤æ–­ Dep.targetï¼ˆtarget ä¸­ä¿å­˜çš„æ˜¯ç¬¬ 2 æ­¥ä¸­è®¾ç½®çš„ Watcher å®ä¾‹ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™å°† getter å‡½æ•°æ‰€åœ¨çš„ Observer å®ä¾‹çš„ Dep å®ä¾‹ä¿å­˜åˆ° Watcher çš„åˆ—è¡¨ä¸­ï¼Œå¹¶åœ¨æ­¤ Dep å®ä¾‹ä¸­æ·»åŠ  Watcher ä¸ºè®¢é˜…è€…ï¼› é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´è‡³ Watcher çš„ expOrFn æ¶‰åŠçš„æ‰€æœ‰å±æ€§å‡è®¿é—®ç»“æŸï¼ˆå³ expOrFn æ•°ä¸­æ‰€æœ‰çš„æ•°æ®çš„ getter å‡½æ•°éƒ½å·²è¢«è§¦å‘ï¼‰ï¼ŒDep.target è¢«ç½®ä¸º nullï¼Œä¾èµ–æ”¶é›†å®Œæˆï¼› ä»¥ä¸Šå°±æ˜¯æ¨¡æ¿ä¸­çš„æŒ‡ä»¤ä¸æ•°æ®å…³è”èµ·æ¥çš„æ­¥éª¤ã€‚å½“æ•°æ®å‘ç”Ÿæ”¹å˜åï¼Œç›¸åº”çš„ setter å‡½æ•°è¢«è§¦å‘ï¼Œç„¶åæ‰§è¡Œ notify å‡½æ•°é€šçŸ¥è®¢é˜…è€…ï¼ˆWatcherï¼‰å»æ›´æ–°ç›¸å…³è§†å›¾ï¼Œä¹Ÿä¼šå¯¹æ–°çš„æ•°æ®é‡æ–° observeï¼Œæ›´æ–°ç›¸å…³çš„ä¾èµ–å…³ç³»ã€‚ æ€»ç»“ä»¥ä¸Šå°±æ˜¯å“åº”å¼åŸç†çš„æºç ä»‹ç»ï¼Œä¸€å›¾èƒœåƒè¨€ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢è¿™å¼ å›¾ï¼š æ€»ç»“æ¥è¯´å°±æ˜¯ï¼š åœ¨ç”Ÿå‘½å‘¨æœŸçš„ initState æ–¹æ³•ä¸­å°† dataã€propã€methodã€computedã€watch ä¸­çš„æ•°æ®åŠ«æŒï¼Œé€šè¿‡ observe æ–¹æ³•ä¸ defineReactive æ–¹æ³•å°†ç›¸å…³å¯¹è±¡è½¬æ¢ä¸º Observer å¯¹è±¡ï¼› ç„¶ååœ¨ initRender æ–¹æ³•ä¸­è§£ææ¨¡æ¿ï¼Œé€šè¿‡ Watcher å¯¹è±¡ï¼ŒDep å¯¹è±¡ä¸è§‚å¯Ÿè€…æ¨¡å¼å°†æ¨¡æ¿ä¸­çš„æŒ‡ä»¤ä¸å¯¹åº”çš„æ•°æ®å»ºç«‹ä¾èµ–å…³ç³»ï¼Œåœ¨è¿™ä¸ªä¾èµ–æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº†å…¨å±€å¯¹è±¡ Dep.target ï¼› æœ€åï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§¦å‘ Object.defineProperty æ–¹æ³•ä¸­çš„ dep.notify æ–¹æ³•ï¼Œéå†è¯¥æ•°æ®çš„ä¾èµ–åˆ—è¡¨ï¼Œæ‰§è¡Œå…¶ update æ–¹æ³•é€šçŸ¥ Watcher è¿›è¡Œè§†å›¾æ›´æ–°ã€‚ å‚è€ƒé“¾æ¥ Vue å®ä¾‹ æ·±å…¥å“åº”å¼åŸç† Vue å“åº”å¼åŸç†æ¢æ VueåŸç†è§£æä¹‹ observer æ¨¡å— Vue æºç è§£æï¼šæ·±å…¥å“åº”å¼åŸç†ï¼ˆä¸Šï¼‰","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"Vue","slug":"Vue","permalink":"http://zhouweicsu.github.io/blog/tags/Vue/"},{"name":"æºç ","slug":"æºç ","permalink":"http://zhouweicsu.github.io/blog/tags/æºç /"}]},{"title":"å›¾è§£ JavaScript ä¸­çš„ __proto__ ä¸ prototype","date":"2017-03-02T08:22:13.000Z","path":"2017/03/02/proto-prototype/","text":"æ­£çœŸç†è§£ JavaScript ä¸­çš„åŸå‹æ¨¡å¼æ˜¯æŒæ¡ JavaScript åŸºç¡€çš„å…³é”®ã€‚åŸå‹æ¨¡å¼æ˜¯ JavaScript å®ç°é¢å‘å¯¹è±¡å’Œç»§æ‰¿çš„åŸºç¡€ã€‚è€ŒåŸå‹ä¸­çš„ __proto__ ä¸ prototype åˆæ˜¯ç†è§£åŸå‹æ¨¡å¼çš„å…³é”®ã€‚ æœ¬æ–‡ç”¨ä»£ç ç»“åˆå›¾ç‰‡çš„æ–¹å¼æ¢³ç†ä¸€ä¸‹ __proto__ å’Œ prototype ä¹‹é—´çš„åŒºåˆ«å’Œå…³ç³»ã€‚ MDN ä¸­å†™åˆ°ï¼š å½“è°ˆåˆ°ç»§æ‰¿æ—¶ï¼ŒJavaScript åªæœ‰ä¸€ç§ç»“æ„ï¼šå¯¹è±¡ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨é“¾æ¥åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œç§°ä¸ºå®ƒçš„åŸå‹ prototypeã€‚è¯¥åŸå‹å¯¹è±¡æœ‰è‡ªå·±çš„åŸå‹ï¼Œç­‰ç­‰ï¼Œç›´åˆ°è¾¾åˆ°ä¸€ä¸ªä»¥ null ä¸ºåŸå‹çš„å¯¹è±¡ã€‚æ ¹æ®å®šä¹‰ï¼Œnull æ²¡æœ‰åŸå‹ï¼Œå¹¶ä¸”ä½œä¸ºè¿™ä¸ªåŸå‹é“¾ prototype chain ä¸­çš„æœ€ç»ˆé“¾æ¥ã€‚ ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ã€‹ç¬¬ 6 ç«  6.2.3 åŸå‹æ¨¡å¼ä¸­å†™åˆ°ï¼š å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹çš„å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡é’ˆï¼ˆå†…éƒ¨å±æ€§ï¼‰ï¼ŒæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚ECMA-262 ç¬¬ 5 ç‰ˆä¸­ç§°è¿™ä¸ªæŒ‡é’ˆå« [[Prototype]]ã€‚ å¤§å¤šæ•°æµè§ˆå™¨å¾— ES5 å®ç°ä¸­éƒ½æ”¯æŒé€šè¿‡å±æ€§ __proto__ æ¥è®¿é—® [[Prototype]] æŒ‡é’ˆã€‚ å…ˆçœ‹ä¸€æ®µä»£ç ï¼š1234567891011121314151617181920212223242526272829class Point&#123; constructor(x,y) &#123; this.x = x; this.y = y; &#125;&#125;class ColorPoint extends Point &#123; constructor(x,y,color) &#123; super(x, y); this.color = color; &#125;&#125;var p1 = new Point(2,3);var p2 = new ColorPoint(3,4, 'green');console.log(p1.__proto__ === Point.prototype); //trueconsole.log(p1.__proto__.__proto__ === Object.prototype); //trueconsole.log(p2.__proto__ === ColorPoint.prototype); //trueconsole.log(p2.__proto__.__proto__ === Point.prototype); //trueconsole.log(Point.__proto__ === Function.prototype); //trueconsole.log(ColorPoint.prototype.__proto__ === Point.prototype); //trueconsole.log(ColorPoint.__proto__ == Point); //trueconsole.log(Function.prototype === Function.__proto__); //trueconsole.log(Function.prototype.__proto__ === Object.prototype); //trueconsole.log(Object.prototype.__proto__) //nullconsole.log(Object.prototype.prototype) //undefinedconsole.log(p1.prototype) //undefined Class å¯çœ‹ä½œä¸ºæ„é€ å‡½æ•°çš„è¯­æ³•ç³–ã€‚ æ ¹æ®è¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç»˜åˆ¶å‡ºå¦‚ä¸‹å…³ç³»å›¾ï¼š ç»“è®ºä»å›¾ä¸­å¯ä»¥çœ‹åˆ°å®ä¾‹ã€å‡½æ•°å’ŒåŸå‹å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š å®ä¾‹ã€æ„é€ å‡½æ•°å’ŒåŸå‹å¯¹è±¡éƒ½æœ‰ __proto__ å±æ€§ï¼Œï¼ˆJavaScript ä¸­æ‰€æœ‰å¯¹è±¡éƒ½æœ‰æ­¤å±æ€§ï¼ŒJavaScript ä¸­ä¸€åˆ‡çš†å¯¹è±¡ï¼‰ï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼› æ„é€ å‡½æ•°ä¸ä»…æœ‰ __proto__ å±æ€§ï¼Œè¿˜æœ‰ prototype å±æ€§ï¼ˆå‡½æ•°ç‹¬æœ‰å±æ€§ï¼‰ï¼Œprototype æŒ‡å‘è¯¥æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆNoteï¼šé€šè¿‡ Function.prototype.bind æ–¹æ³•æ„é€ å‡ºæ¥çš„å‡½æ•°æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒæ²¡æœ‰ prototype å±æ€§ï¼‰ï¼› åŸå‹é“¾æœ€ç»ˆæŒ‡å‘ä¸€ä¸ªä»¥ null ä¸ºåŸå‹çš„å¯¹è±¡ã€‚null æ²¡æœ‰åŸå‹ï¼Œå¹¶ä¸”ä½œä¸ºè¿™ä¸ªåŸå‹é“¾ prototype chain ä¸­çš„æœ€ç»ˆé“¾æ¥ï¼› Function çš„ prototype å’Œ __proto__ éƒ½æŒ‡å‘ Function.prototypeï¼› å‚è€ƒæ–‡ç« ï¼šjs ä¸­ __proto__ å’Œ prototype çš„åŒºåˆ«å’Œå…³ç³»ï¼Ÿ","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"åŸå‹","slug":"åŸå‹","permalink":"http://zhouweicsu.github.io/blog/tags/åŸå‹/"},{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"http://zhouweicsu.github.io/blog/tags/åŸºç¡€/"}]},{"title":"ã€Œè¯‘ã€é¢è¯•ä¸­è¦æ³¨æ„çš„ 3 ä¸ª JavaScript é—®é¢˜","date":"2017-02-21T16:00:00.000Z","path":"2017/02/22/3-javascript-questions-to-watch-out-for-during-coding-interviews/","text":"JavaScript æ˜¯æ‰€æœ‰ç°ä»£æµè§ˆå™¨çš„å®˜æ–¹è¯­è¨€ã€‚å› æ­¤ï¼Œå„ç§è¯­è¨€çš„å¼€å‘è€…é¢è¯•ä¸­éƒ½ä¼šé‡åˆ° JavaScript é—®é¢˜ã€‚ æœ¬æ–‡ä¸è®²æœ€æ–°çš„ JavaScript åº“ï¼Œé€šç”¨å¼€å‘å®è·µï¼Œæˆ–ä»»ä½•æ–°çš„ ES6 å‡½æ•°ã€‚è€Œæ˜¯è®²è®²é¢è¯•ä¸­ç»å¸¸å‡ºç°çš„ 3 ä¸ª JavaScript é—®é¢˜ã€‚æˆ‘é—®è¿‡è¿™äº›é—®é¢˜ï¼Œæˆ‘çš„æœ‹å‹è¯´ä»–ä»¬ä¹Ÿé—®ã€‚ å½“ç„¶ä¸æ˜¯è¯´ä½ åœ¨å‡†å¤‡ JavaScript é¢è¯•æ—¶åªè¦å­¦ä¹ è¿™ 3 ä¸ªé—®é¢˜ â€”â€” ä½ è¿˜æœ‰å¾ˆå¤šé€”å¾„å»æ›´å¥½çš„å‡†å¤‡å³å°†åˆ°æ¥çš„é¢è¯• â€”â€” ä½†é¢è¯•å®˜å¾ˆæœ‰å¯èƒ½é€šè¿‡ä¸‹é¢ 3 ä¸ªé—®é¢˜æ¥åˆ¤æ–­ä½ äº†è§£å’ŒæŒæ¡ JavaScript å’Œ DOM çš„æƒ…å†µã€‚ è®©æˆ‘ä»¬å¼€å§‹å§ï¼æ³¨æ„ä¸‹é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨åŸç”Ÿ JavaScriptï¼Œ å› ä¸ºé¢è¯•å®˜é€šå¸¸æƒ³è€ƒæŸ¥ä½ åœ¨ä¸å€ŸåŠ©åº“ï¼ˆä¾‹å¦‚ jQueryï¼‰çš„å¸®åŠ©æ—¶æŒæ¡ JavaScript å’Œ DOM çš„æƒ…å†µã€‚ é—®é¢˜ #1ï¼š äº‹ä»¶ä»£ç†åˆ›å»ºåº”ç”¨æ—¶ï¼Œæœ‰æ—¶éœ€è¦ç»™é¡µé¢ä¸­çš„æŒ‰é’®ï¼Œæ–‡å­—ï¼Œæˆ–å›¾ç‰‡æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼Œå½“ç”¨æˆ·ä¸è¿™äº›å…ƒç´ äº¤äº’æ—¶è§¦å‘æŸäº›æ“ä½œã€‚ æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„ä»£åŠäº‹é¡¹åˆ—è¡¨ä¸ºä¾‹ï¼Œé¢è¯•å®˜ä¼šå‘Šè¯‰ä½ ï¼Œä»–ä»¬å¸Œæœ›åœ¨ç”¨æˆ·ç‚¹å‡»åˆ—è¡¨ä¸­æŸä¸€é¡¹æ—¶è§¦å‘ä¸€ä¸ªåŠ¨ä½œã€‚å¹¶è®©ä½ ç”¨ JavaScript æ ¹æ®ä¸‹é¢çš„ HTML ä»£ç å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š 123456&lt;ul id=\"todo-app\"&gt; &lt;li class=\"item\"&gt;Walk the dog&lt;/li&gt; &lt;li class=\"item\"&gt;Pay bills&lt;/li&gt; &lt;li class=\"item\"&gt;Make dinner&lt;/li&gt; &lt;li class=\"item\"&gt;Code for one hour&lt;/li&gt;&lt;/ul&gt; ä½ å¯èƒ½ä¼šåƒä¸‹é¢çš„ä»£ç ä¸€æ ·ç»™å…ƒç´ æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼š 12345678910111213document.addEventListener(&apos;DOMContentLoaded&apos;, function() &#123; let app = document.getElementById(&apos;todo-app&apos;); let items = app.getElementsByClassName(&apos;item&apos;); // ç»™æ¯ä¸ªåˆ—è¡¨é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ for (let item of items) &#123; item.addEventListener(&apos;click&apos;, function() &#123; alert(&apos;you clicked on item: &apos; + item.innerHTML); &#125;); &#125; &#125;); å½“ç„¶ä¸Šé¢çš„ä»£ç èƒ½å®Œæˆé¢è¯•å®˜çš„éœ€æ±‚ï¼Œé—®é¢˜æ˜¯æ¯ä¸ªåˆ—è¡¨é¡¹éƒ½ä¼šåŠ ä¸Šä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚å½“åˆ—è¡¨åªæœ‰ 4 é¡¹æ—¶æ²¡æœ‰é—®é¢˜ï¼Œä½†å¦‚æœæœ‰äººç»™ä»£åŠäº‹é¡¹åˆ—è¡¨æ–°å¢äº† 10,000 ä¸ªäº‹é¡¹å‘¢ï¼ˆä»–ä»¬ä¹Ÿè®¸æœ‰ä¸€å¤§å †äº‹æƒ…è¦åšï¼‰ï¼Ÿé‚£æ—¶å‡½æ•°ä¼šåˆ›å»º 10,000 ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åæŠŠå®ƒä»¬éƒ½æ·»åŠ åˆ° DOM ä¸Šã€‚è¿™æ ·æ•ˆç‡éå¸¸ä½ã€‚ é¢è¯•ä¸­æœ€å¥½é¦–å…ˆé—®ä¸€ä¸‹é¢è¯•å®˜ç”¨æˆ·æœ€å¤šå¯ä»¥æ·»åŠ å¤šå°‘ä¸ªä»£åŠäº‹é¡¹ã€‚å¦‚æœæ°¸è¿œä¸ä¼šè¶…è¿‡ 10 ä¸ªï¼Œé‚£ä¸Šé¢çš„ä»£ç è¿è¡Œèµ·æ¥å°±æ²¡æœ‰é—®é¢˜ã€‚ä½†å¦‚æœç”¨æˆ·è¾“å…¥å¾…åŠäº‹é¡¹çš„æ•°é‡æ²¡æœ‰ä¸Šé™ï¼Œé‚£ä½ å°±å¾—æ¢ä¸€ä¸ªæ›´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ å¦‚æœåº”ç”¨æœ‰ä¸Šç™¾ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œæ›´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯ç»™æœ€å¤–å±‚çš„å®¹å™¨æ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œå½“ç”¨æˆ·çœŸæ­£ç‚¹å‡»çš„æ—¶å€™å†å»è·å–å®é™…è¢«ç‚¹å‡»çš„ä»£åŠäº‹é¡¹ã€‚è¿™è¢«ç§°ä¸ºäº‹ä»¶ä»£ç†ï¼Œè¿™æ¯”ç»™æ¯ä¸ªä»£åŠäº‹é¡¹éƒ½å•ç‹¬æ·»åŠ äº‹ä»¶ç›‘å¬å™¨æ›´é«˜æ•ˆã€‚ ä¸‹é¢æ˜¯äº‹ä»¶ä»£ç†çš„ä»£ç ï¼š 12345678910111213document.addEventListener(&apos;DOMContentLoaded&apos;, function() &#123; let app = document.getElementById(&apos;todo-app&apos;); // ç»™å®¹å™¨æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ app.addEventListener(&apos;click&apos;, function(e) &#123; if (e.target &amp;&amp; e.target.nodeName === &apos;LI&apos;) &#123; let item = e.target; alert(&apos;you clicked on item: &apos; + item.innerHTML); &#125; &#125;); &#125;); é—®é¢˜ #2: åœ¨å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…é¢è¯•ä¸­ç»å¸¸ä¼šé—®åˆ°é—­åŒ…ï¼Œå› ä¸ºé¢è¯•å®˜èƒ½é€šè¿‡è¿™ä¸ªé—®é¢˜çš„å›ç­”åˆ¤æ–­ä½ å¯¹è¯­è¨€çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œä»¥åŠè€ƒå¯Ÿä½ æ˜¯å¦çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨é—­åŒ…ã€‚ é—­åŒ…å°±æ˜¯èƒ½è®¿é—®ä½œç”¨åŸŸå¤–éƒ¨å˜é‡çš„å†…éƒ¨å‡½æ•° ã€‚é—­åŒ…èƒ½ç”¨æ¥å®ç°ç§æœ‰åŒ–å’Œåˆ›å»ºå·¥å‚å‡½æ•°ç­‰ä½œç”¨ã€‚å…³äºé—­åŒ…çš„å¸¸è§é¢è¯•é¢˜æ˜¯è¿™æ ·çš„ï¼š å†™ä¸€ä¸ªå‡½æ•°ï¼Œå¾ªç¯ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå»¶è¿Ÿ 3 ç§’æ‰“å°è¿™ä¸ªæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚ è¿™ä¸ªé—®é¢˜å¸¸è§ï¼ˆä¸æ­£ç¡®ï¼‰çš„å®ç°æ˜¯è¿™æ ·ï¼š 123456const arr = [10, 12, 15, 21];for (var i = 0; i &lt; arr.length; i++) &#123; setTimeout(function() &#123; console.log('The index of this number is: ' + i); &#125;, 3000);&#125; å¦‚æœä½ è¿è¡Œè¿™æ®µå‡½æ•°ï¼Œä½ ä¼šå‘ç° 3 ç§’ä¹‹åæ¯æ¬¡éƒ½æ‰“å°çš„æ˜¯ 4ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„ 0, 1, 2, 3ã€‚ ä¸ºäº†æ­£ç¡®çš„æ‰¾åˆ°å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› ï¼Œä½ éœ€è¦ç†è§£ JavaScript æ˜¯å¦‚ä½•è¿è¡Œè¿™æ®µä»£ç çš„ï¼Œè¿™ä¹Ÿæ˜¯é¢è¯•å®˜æƒ³è¦è€ƒå¯Ÿä½ çš„åœ°æ–¹ã€‚ åŸå› æ˜¯ setTimeout å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªè®¿é—®å¤–éƒ¨ä½œç”¨åŸŸçš„å‡½æ•°ï¼ˆé—­åŒ…ï¼‰ï¼Œå°±æ˜¯åŒ…å«ç´¢å¼• i çš„é‚£ä¸ªå¾ªç¯ã€‚3 ç§’ä¹‹åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œæ‰“å° i çš„å€¼ï¼Œè€Œæ­¤æ—¶å¾ªç¯ä¹Ÿç»“æŸäº†ï¼Œi çš„å€¼å·²ç»æ˜¯ 4ã€‚å› ä¸ºå¾ªç¯éå† 0, 1, 2, 3, 4 åæœ€ç»ˆåœåœ¨äº† 4ã€‚ å®é™…ä¸Šæœ‰å¥½å‡ ç§æ–¹æ³•èƒ½æ­£ç¡®è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªï¼š 123456789const arr = [10, 12, 15, 21];for (var i = 0; i &lt; arr.length; i++) &#123; // ç»™æ¯ä¸ªå‡½æ•°ä¼ å…¥å˜é‡ i è®©å…¶èƒ½è®¿é—®æ­£ç¡®çš„ç´¢å¼• setTimeout(function(i_local) &#123; return function() &#123; console.log(&apos;The index of this number is: &apos; + i_local); &#125; &#125;(i), 3000);&#125; 12345678const arr = [10, 12, 15, 21];for (let i = 0; i &lt; arr.length; i++) &#123; // ä½¿ç”¨ ES6 ä¸­çš„ let å…³é”®å­—ï¼Œå®ƒä¼šåœ¨å‡½æ•°è°ƒç”¨æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„ç»‘å®š // äº†è§£æ›´å¤šï¼šhttp://exploringjs.com/es6/ch_variables.html#sec_let-const-loop-heads setTimeout(function() &#123; console.log(&apos;The index of this number is: &apos; + i); &#125;, 3000);&#125; é—®é¢˜ #3ï¼š Debouncingï¼ˆé˜²æŠ–åŠ¨ï¼‰æœ‰äº›æµè§ˆå™¨äº‹ä»¶èƒ½åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è¢«è§¦å‘å¤šæ¬¡ï¼Œä¾‹å¦‚è°ƒæ•´çª—å£å¤§å°æˆ–æ»šåŠ¨é¡µé¢ã€‚å¦‚æœä½ ç»™çª—å£æ»šåŠ¨äº‹ä»¶æ·»åŠ ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åç”¨æˆ·ä¸åœåœ°å¿«é€Ÿå‘ä¸‹æ»šåŠ¨é¡µé¢ï¼Œé‚£ä½ çš„äº‹ä»¶å¯èƒ½åœ¨ 3 ç§’ä¹‹å†…è¢«è§¦å‘æ•°åƒæ¬¡ã€‚è¿™ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚ å¦‚æœåœ¨é¢è¯•ä¸­è®¨è®ºåˆ°æ„å»ºåº”ç”¨ç¨‹åºï¼Œä»¥åŠæ»šåŠ¨äº‹ä»¶ï¼Œçª—å£è°ƒæ•´äº‹ä»¶ï¼Œæˆ–è€…é”®ç›˜äº‹ä»¶ç­‰ï¼Œè¯·åŠ¡å¿…æåŠ debouncing æˆ–è€… throttlingï¼Œä½œä¸ºæé«˜é¡µé¢é€Ÿåº¦ä¸æ€§èƒ½çš„æ–¹æ³•ã€‚æ¥ä¸€ä¸ª css-tricks çš„å®ä¾‹ï¼š 2011 å¹´ï¼ŒTwitter å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šå½“æ»šåŠ¨ Twitter æ‘˜è¦æ—¶ï¼Œé¡µé¢å˜çš„å¾ˆå¡ç”šè‡³æ— å“åº”ã€‚John Resig å†™äº†ä¸€ç¯‡å…³äºè¿™ä¸ªé—®é¢˜çš„åšå®¢ï¼Œè§£é‡Šäº†ç›´æ¥å°†è€—æ—¶çš„å‡½æ•°ç»‘å®šåœ¨ scroll äº‹ä»¶ä¸Šæ˜¯ä¸€ä¸ªå¤šä¹ˆç³Ÿç³•çš„æƒ³æ³•ã€‚ Debouncing æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•ï¼Œå®ƒçš„åšæ³•æ˜¯é™åˆ¶ä¸‹æ¬¡å‡½æ•°è°ƒç”¨ä¹‹å‰å¿…é¡»ç­‰å¾…çš„æ—¶é—´é—´éš”ã€‚æ­£ç¡®å®ç° debouncing çš„æ–¹æ³•æ˜¯å°†è‹¥å¹²ä¸ªå‡½æ•°è°ƒç”¨ åˆæˆ ä¸€æ¬¡ï¼Œå¹¶åœ¨ç»™å®šæ—¶é—´è¿‡å»ä¹‹åä»…è¢«è°ƒç”¨ä¸€æ¬¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŸç”Ÿ JavaScript çš„å®ç°ï¼Œç”¨åˆ°äº†ä½œç”¨åŸŸ, é—­åŒ…, this, å’Œ è®¡æ—¶äº‹ä»¶ï¼š 12345678910111213141516// å°†ä¼šåŒ…è£…äº‹ä»¶çš„ debounce å‡½æ•°function debounce(fn, delay) &#123; // ç»´æŠ¤ä¸€ä¸ª timer let timer = null; // èƒ½è®¿é—® timer çš„é—­åŒ… return function() &#123; // é€šè¿‡ â€˜thisâ€™ å’Œ â€˜argumentsâ€™ è·å–å‡½æ•°çš„ä½œç”¨åŸŸå’Œå˜é‡ let context = this; let args = arguments; // å¦‚æœäº‹ä»¶è¢«è°ƒç”¨ï¼Œæ¸…é™¤ timer ç„¶åé‡æ–°è®¾ç½® timer clearTimeout(timer); timer = setTimeout(function() &#123; fn.apply(context, args); &#125;, delay); &#125;&#125; è¿™ä¸ªå‡½æ•° â€” å½“ä¼ å…¥ä¸€ä¸ªäº‹ä»¶ï¼ˆfnï¼‰æ—¶ â€” ä¼šåœ¨ç»è¿‡ç»™å®šçš„æ—¶é—´ï¼ˆdelayï¼‰åæ‰§è¡Œã€‚ å‡½æ•°è¿™æ ·ç”¨ï¼š 12345678// å½“ç”¨æˆ·æ»šåŠ¨æ—¶è¢«è°ƒç”¨çš„å‡½æ•°function foo() &#123; console.log(&apos;You are scrolling!&apos;);&#125;// åœ¨ debounce ä¸­åŒ…è£…æˆ‘ä»¬çš„å‡½æ•°ï¼Œè¿‡ 2 ç§’è§¦å‘ä¸€æ¬¡let elem = document.getElementById(&apos;container&apos;);elem.addEventListener(&apos;scroll&apos;, debounce(foo, 2000)); Throttling æ˜¯ä¸ debouncing ç±»ä¼¼çš„ä¸€ç§æŠ€æœ¯ï¼Œä½†å®ƒä¸æ˜¯åœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œthrottling æ˜¯åœ¨è¾ƒé•¿çš„æ—¶é—´é—´éš”å†…è°ƒç”¨å‡½æ•°ã€‚æ‰€ä»¥å¦‚æœä¸€ä¸ªäº‹ä»¶æ¯ 100 æ¯«ç§’è¢«è§¦å‘ 10 æ¬¡ï¼Œthrottling ä¼šåœ¨æ¯éš” 2 ç§’æ—¶æ‰§è¡Œä¸€æ¬¡è¿™ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯åœ¨ 100 æ¯«ç§’å†…æ‰§è¡Œ 10 æ¬¡äº‹ä»¶ã€‚ æ›´å¤šå…³äº debouncing å’Œ throttling çš„ä¿¡æ¯è¯·å‚è€ƒä»¥ä¸‹æ–‡ç« å’Œæ•™ç¨‹ï¼š JavaScript ä¸­çš„ Throttling å’Œ Debouncing Throttling ä¸ Debouncing çš„åŒºåˆ« å®ä¾‹è§£æ Throttling å’Œ Debouncing Throttling å‡½æ•°è°ƒç”¨ â€”â€” Remy Sharp å¦‚æœä½ å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä½ æˆ–è®¸ä¹Ÿå–œæ¬¢é˜…è¯» JavaScript æ•™ç¨‹ï¼Œå‚ä¸æˆ‘åœ¨ Coderbyte ä¸Šä¸»æŒçš„ JavaScript ç¼–ç æŒ‘æˆ˜ã€‚æœŸå¾…ä½ çš„æƒ³æ³•ï¼","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://zhouweicsu.github.io/blog/tags/ç¿»è¯‘/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"http://zhouweicsu.github.io/blog/tags/é¢è¯•/"}]},{"title":"ã€Œè¯‘ã€å¯æ‰©å±• Web å®£è¨€","date":"2017-02-12T16:00:00.000Z","path":"2017/02/13/the-extensible-web-manifesto/","text":"æ¨åŠ¨ Web å‘å±•æˆ‘ä»¬â€”â€”å·²ç­¾ç½²è¿™ä»½åè®®çš„äººâ€”â€”æƒ³è¦æ”¹å˜ Web æ ‡å‡†å§”å‘˜ä¼šæ–°å¢æ–°ç‰¹æ€§ä»¥åŠç»™ä»–ä»¬æ’ä¼˜å…ˆçº§çš„æ–¹å¼ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™å¯¹ Web çš„é•¿æœŸå¥åº·å‘å±•æ¥è¯´è‡³å…³é‡è¦ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç¼©å° Web æ ‡å‡†ä¸ Web å¼€å‘è€…ä¹‹é—´çš„åé¦ˆç¯è·¯ã€‚ ç›®å‰ï¼Œè®¸å¤šæ–°ç‰¹æ€§éœ€è¦ç»å†å‡ ä¸ªæœˆç”šè‡³å‡ å¹´çš„æ ‡å‡†åŒ–æµç¨‹ï¼Œæ¥ç€åˆæ˜¯æµè§ˆå™¨å‚å•†çš„ç²¾ç¡®å®ç°ï¼Œç„¶åæ‰æ˜¯å¼€å‘è€…çš„åé¦ˆä¸è¿­ä»£ã€‚æˆ‘ä»¬æ›´å¸Œæœ›å…ˆè¿›è¡Œ JavaScript æ–°ç‰¹æ€§çš„å¼€å‘ä¸è¿­ä»£ï¼Œç„¶åå†æ˜¯æµè§ˆå™¨å‚å•†çš„å®ç°å’Œæ ‡å‡†åŒ–è¿‡ç¨‹ã€‚ ä¸ºäº†è®©å‡½æ•°åº“èƒ½åšæ›´å¤šçš„äº‹æƒ…ï¼Œæµè§ˆå™¨å‚å•†åº”è¯¥æä¾›æ–°çš„åº•å±‚åŸè¯­ï¼Œå°½å¯èƒ½å¤šçš„æš´éœ²è®¿é—®å¹³å°åº•å±‚çš„æ¥å£ã€‚ å‚å•†è¿˜åº”è¯¥é€šè¿‡æ–°ç‰¹æ€§çš„ JavaScript å®ç°ï¼Œæ¥ä¿ƒæˆå¼€å‘è€…å¯¹é«˜çº§ API çš„è®¨è®ºï¼ˆä¾‹å¦‚ Mozillaâ€™s X-Tags å’Œ Googleâ€™s Polymerï¼‰ã€‚ å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬ä¸ºå¯æ‰©å±• Web å¹³å°æè®®ä»¥ä¸‹è®¾è®¡å‡†åˆ™ï¼š ä¸“æ³¨äºå‘ Web å¹³å°æ–°å¢å®‰å…¨é«˜æ•ˆçš„åº•å±‚åŸè¯­ã€‚ æš´éœ²åº•å±‚åŸè¯­è§£é‡Šç°æœ‰ç‰¹æ€§ï¼Œä¾‹å¦‚ HTML å’Œ CSSï¼Œä½¿å¼€å‘è€…èƒ½ç†è§£å¹¶å¤ç”¨ä»–ä»¬ã€‚ åœ¨ JavaScript æ–°çš„é«˜çº§ç‰¹æ€§æˆä¸ºæ ‡å‡†ä¹‹å‰ï¼Œè®© Web å¼€å‘è€…å‚ä¸å…¶å¼€å‘ï¼Œè®¾è®¡å’Œæµ‹è¯•çš„è¿­ä»£è¿‡ç¨‹ã€‚è¿™ä¼šåœ¨æ ‡å‡†å’Œå¼€å‘è€…ä¹‹é—´å½¢æˆè‰¯æ€§å¾ªç¯ã€‚ ä¼˜å…ˆå¤„ç†ç¬¦åˆè¿™äº›å»ºè®®çš„å·¥ä½œï¼Œé™ä½ä¸ç¬¦åˆè¿™äº›å»ºè®®çš„ä¼˜å…ˆçº§æˆ–é‡æ–°è¯„ä¼°ä»–ä»¬ã€‚ ä¸“æ³¨äºæ ‡å‡†åŒ–æ–°çš„åº•å±‚åŸè¯­ï¼Œå¹¶åŸºäºè¿™äº›åŸè¯­æ¥æ‰©å±•æ–°ç‰¹æ€§ï¼Œæˆ‘ä»¬å€¡å¯¼ï¼š è€ƒè™‘æ–°çš„å®‰å…¨é¢†åŸŸã€‚ æµè§ˆå™¨å¼•æ“çš„ä¼˜åŒ–å·¥ä½œåº”é›†ä¸­åœ¨ç¨³å®šå†…æ ¸ï¼Œå› ä¸ºå†…æ ¸ä¼šå½±å“è®¸å¤šæ–°å¢çš„ APIã€‚è¿™æ ·åšä¼šå‡å°‘å®ç°æˆæœ¬å¹¶æå‡æ€§èƒ½ã€‚ æµè§ˆå™¨å‚å•†å’Œå‡½æ•°åº“çš„å¼€å‘è€…åº”å…±åŒå‚ä¸å‡½æ•°åº“çš„è¿­ä»£å¼€å‘ï¼Œä»¥æä¾›æµè§ˆå™¨å‹å¥½çš„é«˜çº§ APIã€‚ æ ¹æ®åº•å±‚åŸè¯­è§£é‡Šå·²å­˜åœ¨å’Œæœªæ¥çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å€¡å¯¼ï¼š å‡ç¼“å®ç°è¿‡ç¨‹ä¸­å¤æ‚åº¦çš„å¢é•¿ç‡ï¼Œè¿™æ · bug æ•°çš„å¢é•¿ä¹Ÿä¼šæ”¾ç¼“ã€‚ å°½å¯èƒ½ç»™å¹³å°çš„æ–°ç‰¹æ€§å®ç° polyfillã€‚ æ–°ç‰¹æ€§åº”è¯¥è®©å¼€å‘è€…ä»˜å‡ºå°½å¯èƒ½å°‘çš„å­¦ä¹ æˆæœ¬ã€‚å­¦ä¹ èµ„æ–™åº”è¯¥ç”±å¹³å°ä¸­ç°æœ‰çš„æ¦‚å¿µç»„æˆã€‚ è®©æ–°ç‰¹æ€§æ˜“äºç†è§£ï¼Œæ˜“äº polyfill ä¼šå½¢æˆè‰¯æ€§å¾ªç¯ï¼Œå› ä¸ºï¼š å¼€å‘è€…å¯ä»¥å¿«é€Ÿäº†è§£æ–°çš„ APIï¼Œè®©å¹³å°åœ¨ API æœ€å…·æ‰©å±•æ€§çš„æ—¶å€™è·å¾—æ›´å¿«çš„åé¦ˆã€‚ åœ¨å¼€å‘è€…ä½¿ç”¨å’Œå‡½æ•°åº“ä½œè€…æä¾›æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼ŒAPI ä¸­é”™è¯¯èƒ½è¢«å¿«é€Ÿä¿®æ­£ï¼Œè¿™ç»™æµè§ˆå™¨å‚å•†å’Œå¹³å°è®¾è®¡è€…æä¾›äº†é«˜ä¿çœŸå’Œå¾ˆå…³é”®çš„åé¦ˆã€‚ å‡½æ•°åº“çš„ä½œè€…å¯ä»¥å°è¯•æ–°çš„ APIï¼Œä¸ºå¹³å°å‘å±•æä¾›æ›´å¤šçš„é“è·¯ã€‚ ä¼˜å…ˆå·¥ä½œåº”è¯¥éµå¾ªé‚£äº›å‡†åˆ™ï¼Œæˆ‘ä»¬å€¡å¯¼ï¼š æ”¾æ‰‹æ ‡å‡†åˆ¶ä½œçš„è¿‡ç¨‹ï¼ˆå°¤å…¶æ˜¯çŸ­æœŸå†…ï¼‰ï¼Œè‡´åŠ›äºæœ‰å…³å®‰å…¨æˆ–æ€§èƒ½é—®é¢˜çš„ç‰¹æ€§ï¼Œä»¥åŠä»…èƒ½åœ¨å¹³å°çº§åˆ«æ–°å¢çš„ç‰¹æ€§ï¼Œä¾‹å¦‚æ–°çš„ç¡¬ä»¶ã€‚ è®© Web å¼€å‘è€…å’Œåˆå§‹åŒ–æµè§ˆå™¨çš„å‡½æ•°åº“å»å¼•é¢†ä»£ä»·é«˜æ˜‚çš„æ¢ç´¢ã€‚ é‚£äº›å·²ç»æœ‰å®ç°ï¼Œä¸”åœ¨å®é™…é¡¹ç›®ä¸­å·²å¤§é‡ä½¿ç”¨è¿‡çš„ API ï¼Œæˆ‘ä»¬éœ€è¦ç®€åŒ–å…¶å†—é•¿çš„æ ‡å‡†åŒ–è¿‡ç¨‹ã€‚ æˆ‘ä»¬å¸Œæœ› Web å¼€å‘è€…èƒ½å†™æ›´å¤šå£°æ˜å¼ä»£ç ã€‚è¿™å°±éœ€è¦å¼•å…¥æ–°çš„å£°æ˜å¼å½¢å¼æ¥æ‰“ç ´ç°æœ‰æ ‡å‡†çš„é™åˆ¶ï¼Œå¹¶ä¸ºå‡½æ•°åº“å’Œæ¡†æ¶çš„ä½œè€…æä¾›åˆ›å»ºä»–ä»¬çš„å·¥å…·ã€‚ ä¸ºäº†è®©å¼€æ”¾å¼ Web èƒ½å¤Ÿç«äº‰è¿‡å…¶é“œå¢™é“å£èˆ¬çš„å¯¹æ‰‹ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€æ¡æ¸…æ™°çš„è·¯å¾„ï¼Œè®© Web å¼€å‘è€…èƒ½å¤Ÿå°†ä»–ä»¬çš„å¥½æƒ³æ³•å˜æˆ Web åŸºç¡€çš„ä¸€éƒ¨åˆ†ã€‚å¿…é¡»è®© Web å¼€å‘è€…å»æ„å»ºæœªæ¥çš„ Web ä¸–ç•Œã€‚ å¦‚æœä½ æ”¯æŒè¿™äº›åŸåˆ™ï¼Œ è¯·ç‚¹å‡»è¿™é‡Œç­¾å å·²ç­¾ååå• Brendan Eich Mozilla CTO å’Œ é«˜çº§å‰¯æ€»è£; JavaScript åˆ›é€ è€… Yehuda Katz TC39, W3C TAG ä¼šå‘˜ï¼› Ember.js, Rails æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ Alex Russell TC39, W3C TAG ä¼šå‘˜ï¼›Google Chrome å›¢é˜Ÿæˆå‘˜ Brian Kardell W3C å¯æ‰©å±•çš„ Web ç¤¾åŒºå°ç»„ä¸»å¸­ FranÃ§ois REMY W3C å¯æ‰©å±•çš„ Web ç¤¾åŒºå°ç»„è”åˆåˆ›å§‹äºº Clint Hill W3C å¯æ‰©å±•çš„ Web ç¤¾åŒºå°ç»„è”åˆåˆ›å§‹äºº Marcos Caceres W3C å¯æ‰©å±•çš„ Web ç¤¾åŒºå°ç»„è”åˆåˆ›å§‹äºº Tom Dale Ember.js æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ Anne van Kesteren æ ‡å‡†ç¼–è¾‘ï¼ŒMozilla æ¶æ„å¸ˆ Sam Tobin-Hochstadt TC39 ä¼šå‘˜ Domenic Denicola Promises/A+ æ ‡å‡†çš„è”åˆä½œè€… Chris Eppstein Sass ç»´æŠ¤è€… Dave Herman Mozilla ç ”ç©¶å‘˜ï¼ŒTC39 Alan Stearns CSSWG ä¼šå‘˜ Rick Waldron TC39 ä¼šå‘˜ï¼›jQuery, Bocoup æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ Paul Irish Google Ted Han DocumentCloud å¼€å‘è´Ÿè´£äºº Tab Atkins CSSWG ä¼šå‘˜ï¼› Google Dan Appelquist W3C TAG è”åˆä¸»å¸­ï¼Œ TelefÃ³nica å¼€æ”¾ Web å€¡å¯¼è€… Isaac Schlueter Node.js ç»´æŠ¤è€… Allen Wirfs-Brock Mozilla ç ”ç©¶å‘˜ï¼Œ TC39 ä¼šå‘˜ï¼Œ ECMAScript è§„èŒƒç¼–è¾‘ ç›¸å…³é˜…è¯» Extend the Web Forwardï¼Œä½œè€… Yehuda Katzï¼Œæ›´è¯¦ç»†åœ°è§£é‡Šäº†å®£è¨€ä¸­æåˆ°çš„ç†å¿µã€‚ An Extensible Approach to Browser Security Policyï¼Œä½œè€… Yehuda Katzï¼Œè¯¥æ–‡ä¸ºå®£è¨€ä¸­å…³äºæµè§ˆå™¨å†…å®¹å®‰å…¨ç­–ç•¥çš„ API è®¾è®¡é—®é¢˜æä¾›äº†ä¸€ä¸ªå®é™…å¯è¡Œçš„æ–¹æ¡ˆã€‚ Dropping the F-Bomb on Web Standardsï¼Œä½œè€… Brian Kardellï¼Œä¸€ä»½å…³äºå¼€å‘è€…ç¤¾åŒºçš„æƒ³æ³•å’Œè¯­è¨€å¦‚ä½•è¢«çº³å…¥å¯äº¤äº’çš„æ ‡å‡†ä¸­çš„åŠ¡å®è®¨è®ºã€‚ Bedrockï¼Œä½œè€… Alex Russellï¼Œä¸€ç¯‡ 2012 å¹´çš„æ–‡ç« ï¼Œæ·±å…¥æ¢è®¨ä»¥å¯æ‰©å±•ï¼ˆâ€œåˆ†å±‚â€ï¼‰æ–¹å¼è®¾è®¡å¹³å°çš„ç†è®ºä¸å®è·µã€‚ How the Web Should Workï¼Œä½œè€… Boris Smusï¼Œä¸€ç¯‡ 2012 å¹´çš„æ–‡ç« ï¼Œæè¿°äº†â€œforward polyfillsâ€ï¼ˆæˆ–è€… prollyfillsï¼‰åº”è¯¥å¦‚ä½•å®é™…åº”ç”¨ã€‚","tags":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://zhouweicsu.github.io/blog/tags/ç¿»è¯‘/"},{"name":"Web","slug":"Web","permalink":"http://zhouweicsu.github.io/blog/tags/Web/"}]},{"title":"ã€Œè¯‘ã€æˆ‘çš„æ™ºèƒ½æµ´å®¤é•œ","date":"2016-07-18T16:00:00.000Z","path":"2016/07/19/my-bathroom-mirror-is-smarter-than-yours/","text":"ä¹°ä¸åˆ°æ™ºèƒ½é•œå°±è‡ªå·±åšä¸€ä¸ªå»å¹´å¹´åº•æŸä¸ªæ—¶å€™ï¼Œæˆ‘è§‰å¾—æµ´å®¤é‡Œçš„é•œå­å¾—åƒç”µå½±é‡Œæœªæ¥ä¸–ç•Œä¸­é•¿çš„é‚£æ ·ã€‚ ä½†ä¼¼ä¹å¸‚åœºä¸Šæ²¡æœ‰äººå–æˆ‘æƒ³è¦çš„è¿™ç§é•œå­ã€‚ç„¶è€Œï¼Œç»„æˆé•œå­çš„æ¯ä¸ªé›¶éƒ¨ä»¶éƒ½å¾ˆå¸¸è§ã€‚æœ€è¿‘ä¹Ÿæœ‰å¾ˆå¤šäººåšäº†ç±»ä¼¼çš„è‡ªåˆ¶æ™ºèƒ½æµ´å®¤é•œï¼Œä½†æˆ‘æƒ³è±¡ä¸­çš„ä¸è¿™äº›æœ‰äº›ä¸åŒã€‚ æ‰€ä»¥æˆ‘è‡ªå·±è®¢è´­äº†ä¸€ä¸ªåŒé¢é•œï¼Œä¸€ä¸ªå±•ç¤ºæ¿ï¼Œä¸€ä¸ªæ§åˆ¶é¢æ¿ï¼Œå¤–åŠ ä¸€äº›ç»„ä»¶å’Œæ‰‹å·¥è‰ºæœ¯å“ã€‚å®é™…ä¸Šï¼Œåšå¥½è¿™ä¸ªé•œå­ä¹‹å‰æˆ‘è¿›è¡Œäº†ç›¸å½“å¤šçš„å®éªŒï¼Œè®¸å¤šå®éªŒå¤±è´¥äº†ï¼Œè¿˜æ˜¯è®©æˆ‘ä»¬çœ‹çœ‹å®Œæˆçš„ï¼ˆä½†ç»ä¸æ˜¯æœ€ç»ˆçš„ï¼‰ä½œå“ï¼š æ¬¢è¿æ¥åˆ°æˆ‘çš„æµ´å®¤ï¼Œè¯·å¿½ç•¥è¯æŸœæ—è¾¹æˆ‘å·²ç»ç²¾å¿ƒæ•´ç†è¿‡çš„æ‚ä¸ƒæ‚å…«å’Œé‚£ä¸ªæ™®é€šçš„é•œé¢ã€‚ é•œå­çš„å³è¾¹æ˜¯æ—¶é—´å’Œæ—¥æœŸã€‚å·¦è¾¹æ˜¯å½“å‰çš„å¤©æ°”ä»¥åŠ 24 å°æ—¶çš„é¢„æŠ¥ã€‚ä¸‹é¢æ˜¯æœ€è¿‘çš„æ–°é—»å¤´æ¡ã€‚æ¥ä¸ªç‰¹å†™ï¼š é™¤äº†å¤šäº‘çš„å¤©æ°”ï¼Œå…¶ä»–å¤©æ°”çš„æ—¶å€™ UI ä¼šæœ‰ä¸€äº›è‰²å½©ï¼Œä½†ä¸ºäº†é¿å…å¤ªåˆ†æ•£æ³¨æ„åŠ›ï¼Œå¤§éƒ¨åˆ†æ–‡å­—å’Œå›¾æ ‡éƒ½æ˜¯å•è‰²çš„ã€‚ è¿™äº› UI çš„å®ç°ä½¿ç”¨äº†ä¸€äº›ç®€å•çš„å®‰å“ APIï¼ˆä¾‹å¦‚ï¼šè¿™ä¸ªå¾ˆä¸é”™ï¼‰ï¼Œå¤©æ°”é¢„æŠ¥çš„ API å’Œç¾è”ç¤¾çš„æ–°é—»è®¢é˜…ã€‚ å…¶ä»–æˆ‘æ­£åœ¨å°è¯•çš„æœ‰äº¤é€šæƒ…å†µï¼Œäº‹ä»¶æé†’ï¼Œä»¥åŠä»»ä½•æœ‰ Google Now card çš„ä¸œè¥¿ã€‚æˆ‘çš„è§‚ç‚¹å°±æ˜¯ä½ ä¸å¿…ä¸è¿™äº› UI äº¤äº’ã€‚å› ä¸ºä»–ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè°·æ­Œè¿˜æä¾›äº†ä¸€ä¸ªå¼€æ”¾çš„è¯­éŸ³æœç´¢æ¥å£ï¼Œä½ æƒ³æœä»€ä¹ˆå°±å¯ä»¥æœä»€ä¹ˆã€‚ åµŒå…¥åŒé¢é•œä¸è¯æŸœé—¨ä¹‹é—´çš„å±•ç¤ºæ¿åªæœ‰è–„è–„çš„å‡ æ¯«ç±³ã€‚è¿™æ ·ä¼šå¾ˆæ•´æ´ï¼Œæˆ‘è¿˜èƒ½ç»§ç»­ä½¿ç”¨æŸœå­é‡Œçš„ç©ºé—´ã€‚ä¸‹å›¾æ˜¯ä»¥ä¸€å®šè§’åº¦æ‰“å¼€é—¨æ‹çš„å›¾ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹è¾¹ç¼˜å¤„ï¼š è¿™ä¸ªåŸå‹è¿˜åœ¨ä¸æ–­æ”¹è¿›ï¼Œæˆ‘è¿˜æ²¡æœ‰èŠ±å¤ªå¤šæ—¶é—´åœ¨è½¯ä»¶ä¸Šã€‚ä¸Šé¢æåˆ°çš„ UI ä¹Ÿä»…æœ‰å‡ ç™¾è¡Œä»£ç ï¼Œæˆ‘è¿˜å°è¯•ä½¿ç”¨ä¸åŒçš„è®¾å¤‡æ¥è¿è¡Œå®ƒâ€”â€”ä¸€å¼€å§‹æ˜¯ Chromecastï¼Œåæ¥ä½¿ç”¨äº† Nexus Playerï¼Œæœ€è¿‘ç”¨çš„æ˜¯ Fire TV Stickã€‚ æˆ‘æŠŠè¿™äº›ç”µå­è®¾å¤‡å›ºå®šåœ¨å¹³æ¿ä¸Šå¹¶æ•´ç†äº†ä¸€ä¸‹ï¼Œè¦ä¸ç„¶çœ‹ä¸Šå»ä¼šä¸€å›¢ç³Ÿï¼š ä»¥ä¸Šæ˜¯è¿™ä¸ªé¡¹ç›®ç›®å‰çš„æ‰€æœ‰è¿›å±•ã€‚æœŸå¾…å®ç°å‰©ä½™çš„ä¸€äº›æƒ³æ³•ã€‚ä¹Ÿè®¸æˆ‘è¿˜ä¼šæ›´æ–°åˆ¶ä½œè¿‡ç¨‹ä¸­ä¸€äº›æ›´è¯¦ç»†çš„å›¾ç‰‡ã€‚","tags":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://zhouweicsu.github.io/blog/tags/ç¿»è¯‘/"},{"name":"mirror","slug":"mirror","permalink":"http://zhouweicsu.github.io/blog/tags/mirror/"}]},{"title":"ã€Œè¯‘ã€ä»¥å˜åº”å˜","date":"2016-07-04T16:00:00.000Z","path":"2016/07/05/fit-to-scale/","text":"æˆ‘çš„ç½‘ç«™ç°åœ¨æ˜¯å“åº”å¼çš„ã€‚ä¸å¼¹æ€§å›¾ç‰‡ã€å¼¹æ€§å¸ƒå±€å’Œåª’ä½“æŸ¥è¯¢ä¸€èµ·å·¥ä½œçš„è¶Šä¹…ï¼Œæˆ‘å¯¹å–å¾—çš„æˆæœè¯„ä»·å°±è¶Šé«˜ã€‚åœ¨ä¸º Do Lectures website ç½‘ç«™åšé‡æ–°è®¾è®¡æ—¶ï¼Œæˆ‘å¯¹â€œå“åº”å¼æ–¹æ¡ˆæ˜¯å¦åº”è¯¥ä¸è®¾è®¡ä»¥åŠ Paravel çš„å·¥ä½œæµï¼ˆParavel æ˜¯ä½œè€…æ‰€åœ¨çš„å…¬å¸ï¼Œä¸€å®¶ä½äºå¾·å…‹è¨æ–¯å·å¥¥æ–¯æ±€çš„ç½‘é¡µè®¾è®¡å…¬å¸ã€‚â€”â€” è¯‘è€…æ³¨ï¼‰ä¿æŒä¸€è‡´â€çš„æ‰€æœ‰è®¤çŸ¥è¢«å…¨éƒ¨é¢ è¦†äº†ã€‚æˆ‘ä»¬ä¸å¿…å¤§æ”¹æ•´ä¸ªæµç¨‹ï¼Œè¿˜å¯ä»¥æ§åˆ¶é¢„ç®—ï¼Œè¿˜èƒ½ä¿è¯ç½‘ç«™ç»“æ„ä»å°å¼ç”µè„‘åˆ°ç§»åŠ¨è®¾å¤‡éƒ½ä¿æŒå®Œå¥½ã€‚ç”±äºåœ¨è¿™ä¸ªé¡¹ç›®è·å–çš„ç§¯ææ„ä¹‰çš„ç»éªŒï¼Œæˆ‘å†³å®šæŠŠæˆ‘å­¦åˆ°çš„ä»¥åŠå…³äºæœ¬ç½‘ç«™å½¢æˆçš„è§‚ç‚¹å†™ä¸€ç¯‡æ–‡ç« ã€‚ è· Ethan Marcotte çš„åˆ†æ°´å²­çº§æ–‡ç«  A List Apartï¼šå“åº”å¼ Web è®¾è®¡å·²ç»å¿«ä¸€å¹´äº†ï¼Œä»é‚£ä»¥åæ¯å½“çœ‹åˆ°æˆ‘çš„ç½‘ç«™åœ¨æˆ‘å¦»å­çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡æ—¶æˆ‘éƒ½å¤‡å—æŠ˜ç£¨ã€‚å¯¹å“åº”å¼çš„å–œçˆ±æ˜¯å› ä¸ºä»–çš„ç†å¿µï¼Œå°±æ˜¯æ— è®ºæ‰‹æœºã€å…¨å±æ¡Œé¢è¿˜æ˜¯ä»‹äºä¸¤è€…ä¹‹é—´çš„ä»»ä½•ä¸€ç§è®¾å¤‡éƒ½å¯ä»¥è®¿é—®ç½‘ç«™ã€‚å¦‚æœè¯´äººä»¬ä¸ä¼šç”¨ç½‘ç«™å®½åº¦ä¸€åŠçš„è®¾å¤‡è®¿é—®ç½‘ç«™ï¼Œé‚£ç»å¯¹æ˜¯åœ¨é€ƒé¿é—®é¢˜ã€‚äººä»¬ä¸ä¼šï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æä¾›è¿™ç§è®¿é—®çš„å¯èƒ½æ€§ã€‚ç„¶è€Œæˆ‘ä¾ç„¶æ¨èç”¨æˆ·ä½¿ç”¨å…¨å±è®¿é—®ï¼Œä¸å¯å¦è®¤æ— è®ºæ˜¯åŒæ—¶å¯¹æ¯”ä¸¤ç¯‡æ–‡ç« ï¼Œè¿˜æ˜¯åœ¨æ–‡æœ¬ç¼–è¾‘å™¨çª—å£æ—æ‰“å¼€ä¸€ä¸ªå‚è€ƒç½‘é¡µéƒ½æ˜¯ååˆ†æ–¹ä¾¿çš„ã€‚ ç»“æ„å®Œæ•´æ€§å¦‚æœè¯´ä¹‹å‰æœ‰ä»€ä¹ˆé¡¾è™‘çš„è¯ï¼Œä¹Ÿä¸æ˜¯å…³äºå“åº”å¼è®¾è®¡æœ¬èº«ï¼Œè€Œæ˜¯ä¸€äº›æˆ‘æ›¾ç»çœ‹åˆ°è¿‡çš„å“åº”å¼å®ä¾‹ã€‚åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå±å¹•è°ƒæ•´æ—¶é¡µé¢å…ƒç´ ç³Ÿç³•çš„å‰§çƒˆè°ƒæ•´ä¼šè¯¯å¯¼ç”¨æˆ·ã€‚è¯šç„¶ï¼Œå½“ 3 åˆ—å˜æˆ 1 åˆ—æ—¶æœ‰äº›ä¸œè¥¿å¿…é¡»æ”¾å¼ƒï¼Œä½†æ˜¯ç½‘ç«™çš„ç»“æ„å’Œå±‚çº§å¿…é¡»ä»ç„¶ä¿ç•™ã€‚å¦‚æœç”¨æˆ·ç¬¬ä¸€æ¬¡ä½¿ç”¨ç½‘ç«™å…¨å®½çš„è®¾å¤‡è®¿é—®ï¼Œå½“ä½¿ç”¨è¾ƒçª„çª—å£çš„æµè§ˆå™¨æˆ–è€…ç§»åŠ¨è®¾å¤‡å†æ¬¡è®¿é—®æ—¶ï¼Œä»–ä»¬åº”è¯¥ä¹Ÿèƒ½è®¤è¯†è¯¥ç½‘ç«™ä¸”èƒ½è½»æ¾è‡ªå¦‚çš„è®¿é—®ã€‚ä¸ªäººè®¤ä¸ºè¿™åº”è¯¥è¢«è®¤ä¸º UX è®¾è®¡çš„å¦ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚ æˆ‘ä»¬èŠ±è´¹äº†å¦‚æ­¤å¤šçš„æ—¶é—´è®¨è®ºå†³å®šé¡µé¢ä¸Šæ¯ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œé‚£ä¸ºä»€ä¹ˆå½“çª—å£å˜çª„æ—¶å°±è®©æ‰€æœ‰è¿™äº›å·¥ä½œéƒ½ä»˜è¯¸ä¸œæµå‘¢ï¼Ÿå“åº”å¼ Web è®¾è®¡ä¸æ˜¯é€‚åº”å†…å®¹ï¼ˆå°±åƒé‡æ–°è£…å¡«æ¬å®¶è´§è½¦ï¼‰ï¼Œè€Œæ˜¯è£å‰ªå†…å®¹å»é€‚åº”ç”¨æˆ·ï¼ˆå°±åƒå¸ƒç½®å®¶å…·ï¼‰ã€‚å½“è®¾å¤‡å®½åº¦å˜åŒ–æ—¶ï¼Œå†…å®¹ä¸å¸ƒå±€è¦ä¼˜é›…çš„ç¼©æ”¾ã€‚ FitText ç®€ä»‹æˆ‘å–œæ¬¢å¯¹ Web å­—ä½“æ’ç‰ˆå’Œå“åº”å¼è¿›è¡Œç»†å¾®æ§åˆ¶ï¼Œä½†æˆ‘å¾ˆæ‹…å¿ƒè¿™ä¸¤è€…ä¸èƒ½å…±å­˜ã€‚å¦‚ä½•è®©å­—ç¬¦ï¼Œå•è¯æˆ–è€…è¡Œçš„ä½ç½®å¾®è°ƒä¹Ÿå˜æˆå¯ç¼©æ”¾çš„ï¼Ÿå½“ä½ æƒ³ä¿ç•™æ ¼å¼åŒ–çš„å¤§æ ‡é¢˜å’Œç´§è·Ÿå…¶åæœªè¢« h1 åŒ…è£¹ 2 æˆ– 3 æ¬¡çš„æ–‡ç« æ®µè½æˆ–å›¾ç‰‡ä¹‹é—´çš„é—´è·æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå³ä½¿æ˜¯è¿™ä¸ªç½‘ç«™ï¼Œä¹Ÿä»ç„¶æœ‰ä¸€äº›åœ°æ–¹çš„ä¾èµ–æ–‡æœ¬çš„å¸ƒå±€ä¸ç®¡çª—å£å¤§å°éƒ½æ˜¾ç¤ºæˆå…¨å®½åº¦ã€‚æˆ‘çŸ¥é“ Lettering.js éœ€è¦ä¸€ä¸ªæ’ä»¶äº†ï¼Œå¸¦ç€è¿™ä¸ªæƒ³æ³•æˆ‘å»æ‰¾ Paravel çš„å°ä¼™ä¼´ Dave Rupertã€‚ç¬¬äºŒå¤©ä»–ç»™æˆ‘ä»‹ç»äº† FitTextï¼ æˆ‘çœŸçš„æƒ³æŒ‘æˆ˜ä¸€ä¸‹è‡ªå·±ï¼Œè®©ä¹‹å‰å†™çš„æ–‡ç« é€‚åº”æ–°çš„å“åº”å¼å¸ƒå±€ã€‚è¿‡ç¨‹ä¸­æ¯ç¯‡æ–‡ç« éƒ½ä¼šæš´éœ²å‡ºä¸€ä¸ªå¾…è§£å†³çš„ç‹¬ç‰¹é—®é¢˜é›†ï¼Œæœªè§£å†³çš„é—®é¢˜éƒ½è¢« FitText å¤„ç†äº†ã€‚è¯¥ jQuery æ’ä»¶æ”¾å¤§ web ç±»å‹æ¥é€‚åº”å…¶çˆ¶å…ƒç´ ã€‚ä¸ç®¡çª—å£å¤§å°æ–‡æœ¬æ€»æ˜¾ç¤ºæˆå…¨å®½åº¦ã€‚FitText èƒ½ä¸ Lettering.js æˆ–ä»»ä½• CSS3 å±æ€§ï¼ˆæœ¬æ–‡æ ‡é¢˜å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼‰å®Œç¾æ­é…ï¼Œä¸ç”¨è¯´ä½ ä¹Ÿæ°¸è¿œä¸ä¼šåœ¨æ®µè½æ–‡æœ¬ä¸Šä½¿ç”¨ FitTextï¼ˆæˆ‘å¸Œæœ›ä½ ä¸è¦è¿™æ ·ç”¨ï¼‰ï¼Œä½†æ˜¯åœ¨é€‚å½“çš„ä½ç½®ï¼ŒFitText èƒ½è®©å“åº”å¼ Web è®¾è®¡ä»¤äººæ›´åŠ å…´å¥‹ã€‚ æˆ‘çš„å…³é”®å±æ€§ç°åœ¨æœ¬ç½‘ç«™æ˜¯å“åº”å¼çš„ï¼Œæˆ‘æ‰“ç®—ç»§ç»­æ‹¿ä»–å½“ç»ƒå…µåœº â€”â€” æŒç»­æ”¹è¿›æˆ‘çš„è®¡åˆ’å’Œé’ˆå¯¹å†…å®¹çš„è®¾è®¡ã€‚ä»æ—§çš„è®¾è®¡æ–¹æ³•è½¬å˜åˆ° web å“åº”å¼å¹¶ä¸æ˜¯è‡ªåŠ¨çš„ï¼Œåœ¨çœŸæ­£å¾—å‡ºæ•ˆæœæœ€ä½³çš„æ–¹æ¡ˆå‰è¿˜æœ‰ä¸€äº›ä»¤äººå…´å¥‹çš„å·¥ä½œã€‚æˆ‘æ‰€æœ‰çš„æ–‡ç« éƒ½æœ‰ä»–ä»¬è‡ªå·±ä¸€ä¸ªå°è€Œç‹¬ç‰¹çš„æ ·å¼è¡¨ï¼Œåœ¨ä½¿æ¯ç¯‡åšå®¢åœ¨ä»»ä½•å®½åº¦çš„è®¾å¤‡ä¸Šçœ‹èµ·æ¥éƒ½å¥½çš„è·¯ä¸Šæˆ‘å­¦äº†å¾ˆå¤šä¸œè¥¿ã€‚ä¸‹é¢æ˜¯ä¸€äº›çœŸæ­£æ”¯æ’‘æœ¬ç½‘ç«™æ›´æ–°çš„å±æ€§ï¼š backgroun-size çš„ç™¾åˆ†æ¯”èƒ½å¸®æˆ‘ç›´è§‚åœ°ã€æ— ç¼åœ°ç¼©æ”¾æ—§æ–‡ç« ä¸­çš„ç½‘é¡µç»“æ„ï¼Œæ’å›¾å’Œæ–‡å­—å›¾ç‰‡ã€‚ ç”¨å‚ç›´ padding æˆ– margins ä»£æ›¿å‚ç›´ heightï¼Œè¿™æ ·ä¿æŒæ ‡é¢˜æ çš„é«˜å®½æ¯”ä¼šå˜å¾—éå¸¸ç®€å•ã€‚ Column-count ä¾ç„¶ä¸æ˜¯å¾ˆå¯é ï¼Œä½†åœ¨ tags æ¨¡å—é€šè¿‡åª’ä½“æŸ¥è¯¢ï¼ŒColumn-count ç®€åŒ–äº† 4 æ å¸ƒå±€å˜æˆ 3 æ å†åˆ° 2 æ çš„è¿‡æ¸¡è¿‡ç¨‹ã€‚å½“è¿™ä¸ªå’Œ flex-box éƒ½æ—¶æœºæˆç†Ÿæ—¶ï¼Œä»£ç äº§å‡ºå°†ä¼šå¼‚å¸¸é«˜æ•ˆã€‚ Okï¼Œè¿™äº›å¯¹ç›®å‰æ¥è¯´è¶³å¤Ÿäº†ã€‚æˆ‘ä¼šå†™æ›´å¤šå…³äºå“åº”å¼ Web è®¾è®¡å’Œ FitText çš„æ–‡ç« ã€‚åŒæ—¶ï¼Œç‚¹ä¸€ç‚¹æˆ‘çš„åšå®¢æˆ–ä½¿ç”¨ FitText åˆ›å»ºä¸€äº›è‡ªå·±çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ›´æ–°ï¼ 2011 å¹´ 5 æœˆ 10 æ—¥","tags":[{"name":"CSS","slug":"CSS","permalink":"http://zhouweicsu.github.io/blog/tags/CSS/"},{"name":"scale","slug":"scale","permalink":"http://zhouweicsu.github.io/blog/tags/scale/"},{"name":"fluid","slug":"fluid","permalink":"http://zhouweicsu.github.io/blog/tags/fluid/"}]},{"title":"ã€Œè¯‘ã€ä½¿ç”¨ vh å’Œ vw å®ç°æ­£çœŸçš„æµå¼æ–‡å­—æ’ç‰ˆ","date":"2016-06-28T16:00:00.000Z","path":"2016/06/29/fluid-typography/","text":"å®ç°æµå¼æ–‡å­—æ’ç‰ˆæˆ–è®¸æ¯”ä½ æƒ³è±¡çš„æ›´ç®€å•ã€‚ä»–å…·æœ‰å¹¿æ³›çš„æµè§ˆå™¨æ”¯æŒï¼Œå®ç°ç®€å•ï¼Œè€Œä¸”å®ç°ä¹‹åå¹¶ä¸ä¼šè®©ä½ å¤±å»å¯¹è®¾è®¡çš„æ•´ä½“æŠŠæ§ã€‚ ä¸åƒå“åº”å¼æ–‡å­—æ’ç‰ˆï¼Œæ–‡å­—åªåœ¨æŒ‡å®šçš„å‡ ä¸ªåˆ†ç•Œç‚¹æ‰ä¼šè°ƒæ•´ï¼Œæµå¼æ–‡å­—æ’ç‰ˆåˆ™èƒ½å¹³æ»‘åœ°è°ƒæ•´æ–‡å­—æ¥é€‚åº”ä»»ä½•å®½åº¦çš„è®¾å¤‡ã€‚å½“ç½‘ç«™éœ€è¦æ”¯æŒå‡ ä¹æ— é™ä¸ªå±å¹•å°ºå¯¸çš„æ—¶å€™ï¼Œæµå¼æ’ç‰ˆå°±æ˜¯ä¸äºŒä¹‹é€‰ã€‚ç„¶è€Œï¼Œç”±äºä¸€äº›åŸå› ï¼Œä»–çš„æ™®åŠç‡å´ä»è¿œä¸åŠå“åº”å¼æŠ€æœ¯ã€‚ ä¹Ÿè®¸æ˜¯å› ä¸ºæ–‡å­—æ’ç‰ˆå—å°åˆ·æ’ç‰ˆçš„å¤è€å†å²å½±å“å¤ªæ·±ã€‚â€œæµå¼â€è¿™ä¸ªæ¦‚å¿µå¸¸å¸¸æœ‰è¿è¿™äº›ä¼ ç»Ÿã€‚åœ¨å°åˆ·ä¸šï¼Œå°ºå¯¸é€šå¸¸æ˜¯å›ºå®šçš„ï¼Œè€Œ web ä¸Šå´æ²¡æœ‰å›ºå®šã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘è®¤ä¸ºæµå¼æ–‡å­—æ’ç‰ˆæ˜¯ web çš„å®Œç¾æ­æ¡£ã€‚ä»–æ˜¯æˆªç„¶ä¸åŒçš„åª’ä»‹çš„å¦ä¸€ç§å¤„ç†æ–¹å¼ã€‚ ä½†è¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä»¬éœ€è¦æŠ›å¼ƒæ‰€æœ‰æƒ¯ä¾‹å’Œå…³äºæ–‡å­—æ’ç‰ˆçš„ä¸€åˆ‡ã€‚æˆ‘ä»¬åªéœ€ä»¥ç¨å¾®ä¸åŒçš„æ–¹å¼å­¦ä¹ å¦‚ä½•åº”ç”¨ä¸€äº›æˆ‘ä»¬å·²çŸ¥çš„æŠ€æœ¯ã€‚è°¨æ…å¯¹å¾…æ¯ä¸€ä¸ªç»†èŠ‚å°†ç¡®ä¿æˆ‘ä»¬åœ¨æ‰€æœ‰å±å¹•å°ºå¯¸ä¸­éƒ½è·å¾—å®Œç¾çš„è®¾è®¡ä½“éªŒã€‚ æµå¼æ–‡å­—æ’ç‰ˆå¿«é€Ÿå…¥é—¨è§†å£å•ä½æ˜¯ web ä¸Šèƒ½åº”ç”¨æµå¼æ–‡å­—æ’ç‰ˆçš„é‡è¦å…ƒç´ ã€‚è§†å£å•ä½æŒ‡çš„æ˜¯æµè§ˆå™¨è§†å£å°ºå¯¸çš„ç™¾åˆ†æ¯”ã€‚ä¾‹å¦‚ï¼Œ1 vw ç­‰äºè§†å£å®½åº¦çš„ 1%ã€‚ä¸å•ä½ç™¾åˆ†æ¯”ä¸åŒï¼Œä»–ä»¬æ€»æ˜¯ç›¸å¯¹äºè§†å£ï¼Œè€Œç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹äºå…ƒç´ çš„çˆ¶å®¹å™¨ã€‚ è¿™æ„å‘³ç€ï¼Œä¸æ‰€æœ‰å…¶ä»–å•ä½ç±»å‹ä¸åŒï¼Œè§†å£å•ä½ä¸åŸºç¡€çš„å­—ä½“å¤§å°æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚è¿™ä¸ªåŒºåˆ«æ„ä¹‰é‡å¤§ï¼Œä¹Ÿè®©è¿™ä¸ªå•ä½å˜å¾—æœ‰è¶£è€Œç‹¬ç‰¹ã€‚ å¯ç”¨çš„å››ä¸ªè§†å£å•ä½ï¼š vw: è§†å£å®½åº¦ vh: è§†å£é«˜åº¦ vmin: è§†å£å®½åº¦å’Œé«˜åº¦çš„è¾ƒå°å€¼ vmax: è§†å£å®½åº¦å’Œé«˜åº¦çš„è¾ƒå¤§å€¼ åº”ç”¨æµå¼å­—ä½“æ’ç‰ˆæŠ€æœ¯æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç»™ html å…ƒç´ ä¸Šçš„ font-size è®¾ç½®ä¸€ä¸ªæµå¼å•ä½ï¼š 1html &#123; font-size: 2vw; &#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç»™æ ¹å…ƒç´ è®¾ç½®äº† 2vwã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ”¹å˜äº† â€œroot emâ€ã€‚å› ä¸ºæ‰€æœ‰ä½¿ç”¨äº† em å’Œ rem å•ä½çš„å…ƒç´ éƒ½ç›´æ¥æˆ–é—´æ¥çš„ä¸è¿™ä¸ª root em æœ‰å…³ï¼Œæ‰€ä»¥ä»–ä»¬ä¹Ÿå°†å˜æˆæµå¼çš„ã€‚ä¾‹å¦‚ï¼š 1h1 &#123; font-size: 2em; &#125; 2em çš„æ ‡é¢˜å¤§å°ç°åœ¨ç­‰äº 4vwï¼Œå› ä¸ºè¿™æ˜¯å½“å‰åŸºç¡€å­—ä½“å¤§å° 2vw çš„ä¸¤å€ã€‚ å•ç‹¬ä½¿ç”¨è§†å£ç›¸å…³çš„å•ä½ä¹Ÿä¼šå¸¦æ¥ä¸€äº›å¼Šç«¯ã€‚ä¾‹å¦‚æˆ‘ä»¬æ— æ³•ç²¾ç¡®æ§åˆ¶ç¼©æ”¾é€Ÿç‡ï¼›æ— æ³•è®¾ç½®æœ€å°æˆ–æœ€å¤§çš„å­—ä½“å¤§å°ï¼›è¿˜æœ‰ï¼Œä¸åƒç´ ä¸€æ ·ï¼Œä¸€è¡Œå£°æ˜ä¹Ÿè®¸ä¼šè¦†ç›–ç”¨æˆ·çš„ font-size åå¥½è®¾ç½®ã€‚ä½†å¹¸è¿çš„æ˜¯ï¼Œæ€»æœ‰æ–¹æ³•æ¥å…‹æœè¿™äº›ç¼ºé™·ã€‚ æ§åˆ¶è§†å£å•ä½æ¥è®¾ç½®æœ€å°ä¸æœ€å¤§å­—ä½“å¤§å°ç»™ html å…ƒç´ è®¾ç½® 2vw è®©æ‰€æœ‰å…ƒç´ éƒ½æµåŠ¨èµ·æ¥ç„¶åæ”¶å·¥å›å®¶ï¼Œè¿™ä¹ˆåšå½“ç„¶ç®€å•ï¼Œä½†è¿™è¾¾ä¸åˆ°æœ€ä½³æ•ˆæœã€‚è§†å£å•ä½æ˜¯ä¸€ä¸ªé’å™¨ï¼Œè¦å¾—åˆ°å¯è¡Œç»“æœéœ€è¦ä¸€äº›å¤–åŠ›è¾…åŠ©ã€‚ å› ä¸ºè§†å£å•ä½é€šå¸¸ä¸è§†å£æœ‰ç€ç›´æ¥çš„å…³ç³»ï¼Œæ‰€ä»¥åœ¨å¾ˆå°çš„å±å¹•ä¸‹ï¼Œä½ ä¼šçœ‹è§å°çš„ç¦»è°±çš„å­—ã€‚ ç†è®ºä¸Šï¼Œæˆ‘ä»¬åº”è¯¥è®¾ç½®ä¸€ä¸ªæœ€å°çš„å­—ä½“å¤§å°ï¼Œå¯æƒœ CSS ä¸­å¹¶æ²¡æœ‰ min-font-size è¿™ä¸ªå±æ€§ã€‚ä½†æ¢ä¸ªè§’åº¦æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€äº›ä¸åŒçš„æ–¹æ³•ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚ ç¬¬ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ calc() è¡¨è¾¾å¼ï¼š1html &#123; font-size: calc(1em + 1vw); &#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœè§†å£å®½åº¦ä¸º 0ï¼Œé‚£ font-size å°±æ˜¯ 1emã€‚å½“å±å¹•å˜å¤§ï¼Œ1vw çš„å€¼å°†ä¼šä¸æœ€å°å­—ä½“å¤§å° 1em ç›¸åŠ ã€‚ä½†è¿™ä¸ªæŠ€å·§å¹¶ä¸æ˜¯å®Œç¾çš„ï¼›é€šå¸¸æˆ‘ä»¬å¸Œæœ›èƒ½åœ¨æŸä¸ªå±å¹•å¤§å°æ—¶è®¾ç½®ä¸€ä¸ªæœ€å°çš„å­—ä½“å¤§å°ï¼Œè€Œä¸æ˜¯è®©ä»–ç­‰äº 0ã€‚ä½¿ç”¨åª’ä½“æŸ¥è¯¢å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 12345@media screen and (min-width: 50em) &#123; html &#123; font-size: 2vw; &#125;&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“è§†å£å®½åº¦è¾¾åˆ° 50 em çš„æ—¶å€™ï¼Œå­—ä½“å¤§å°å°±ä¼šå˜æˆåŠ¨æ€çš„ã€‚è¿™ä¸ªæ–¹æ¡ˆæ•ˆæœå¾ˆå¥½ï¼Œä½†åœ¨å›ºå®šå€¼å’ŒåŠ¨æ€å€¼ä¹‹é—´é€šå¸¸ä¼šæœ‰ä¸€ä¸ªæŠ–åŠ¨ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ä¸ªæŠ–åŠ¨ï¼Œæˆ‘ä»¬è¦ç®—å‡ºåŠ¨æ€å€¼ä¸å›ºå®šå€¼åˆšå¥½ç›¸ç­‰çš„é‚£ä¸ªè§†å£å®½åº¦ï¼Œç„¶ååœ¨è¿™ä¸ªåœ°æ–¹è®¾ç½®åˆ†ç•Œç‚¹ã€‚ å¦‚æœé»˜è®¤çš„å­—ä½“å¤§å°æ˜¯ 16 åƒç´ ï¼Œ2vw æ˜¯è§†å£å®½åº¦çš„ 2%ï¼Œé‚£ä¹ˆè®¡ç®—åˆ†ç•Œç‚¹çš„è®¡ç®—å¼å°±æ˜¯ 16 Ã· (2 Ã· 100)ã€‚ç»“æœæ˜¯ 800 åƒç´ ã€‚ 2% * y = 16y = 16 Ã· (2 Ã· 100)â€”â€”è¯‘è€…æ³¨ å¦‚æœæƒ³åœ¨åª’ä½“æŸ¥è¯¢ä¸­ä½¿ç”¨ em å•ä½ï¼Œé‚£å°±éœ€è¦å°† px è½¬æ¢ä¸º emã€‚ç”¨ 800 é™¤ä»¥ 16ï¼ˆæˆ–å…¶ä»–ç­‰äº rem çš„åƒç´ å€¼ï¼‰ï¼š 800 Ã· 16 = 50ã€‚å¦‚æœä½ è§‰å¾—è¿™æ›´ç®€å•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ em ä½œä¸ºå•ä½æ¥è®¡ç®—ï¼š1 Ã· (2 Ã· 100) = 50ã€‚å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œè®¾ç½®ä¸€ä¸ª 2vw çš„å­—ä½“å¤§å°å’Œ 50em çš„åˆ†ç•Œç‚¹ï¼Œå¯ä»¥ä½¿å›ºå®šå€¼ä¸åŠ¨æ€å€¼æ— ç¼è¡”æ¥ã€‚ åŒæ ·çš„è®¡ç®—å¼ä¹Ÿå¯è®¡ç®—å‡ºå­—ä½“å¤§å°çš„æœ€å¤§å€¼ã€‚å¦‚æœæƒ³è®©å­—ä½“å¤§å°æœ€å¤§ä¸è¶…è¿‡ 24pxï¼Œæˆ‘ä»¬åº”è¯¥è¿™æ ·è®¡ç®—ï¼š24 Ã· (2 Ã· 100) = 1200pxã€‚ä½¿ç”¨ em è®¡ç®—å¼å°±æ˜¯ï¼š1.5 Ã· (2 Ã· 100) = 75ï¼ˆ1.5 = 24 Ã· 16â€”â€”è¯‘è€…æ³¨ï¼‰ã€‚å› æ­¤ï¼Œè¶…è¿‡ 75em çš„å®½åº¦åï¼Œå­—ä½“å¤§å°å°±æ˜¯å›ºå®šå€¼ 1.5emã€‚ 12345@media screen and (min-width: 75em) &#123; html &#123; font-size: 1.5em; &#125;&#125; è¿™äº›è®¡ç®—å¼éƒ½ä¸éš¾ï¼Œè¡¨æ ¼æœ‰åŠ©äºç›´è§‚çš„æŸ¥çœ‹ä¸åŒè§†å£å•ä½çš„åˆ†ç•Œç‚¹å’Œå­—ä½“ç¼©æ”¾æ¯”ä¾‹ã€‚è¡¨æ ¼å¤´éƒ¨æ˜¯è§†å£å•ä½çš„å€¼ï¼Œè¡¨æ ¼å·¦ä¾§æ˜¯è®¾å¤‡è§£å†³æ–¹æ¡ˆã€‚ - 1vw 2vw 3vw 4vw 5vw 400px 4px 8px 12px 16px 20px 500px 5px 10px 15px 20px 25px 600px 6px 12px 18px 24px 30px 700px 7px 14px 21px 28px 35px 800px 8px 16px 24px 32px 40px é€šè¿‡è¡¨æ ¼å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å‡ ä¹æ— æ³•æ§åˆ¶è§†å£å•ä½å¤§å°æ”¹å˜æ—¶å­—ä½“å¤§å°çš„æ”¹å˜é€Ÿç‡ã€‚å•ç‹¬ä½¿ç”¨è§†å£å•ä½ï¼Œå­—ä½“å¤§å°å°±å®Œå…¨å—é™äºè¡¨æ ¼çš„æŸä¸€å•åˆ—ã€‚ æ§åˆ¶ç¼©æ”¾é€Ÿç‡å¦‚æœæƒ³è®©å­—ä½“å¤§å°åœ¨å±å¹•åˆ†è¾¨ç‡ 400px æ—¶ä¸º 16pxï¼Œåˆ†è¾¨ç‡è¾¾åˆ° 800px æ—¶è°ƒæ•´åˆ° 24pxï¼Œä½¿ç”¨åˆ†ç•Œç‚¹å®ç°ä¸äº†è¿™ä¸ªéœ€æ±‚ã€‚ä¸Šé¢æˆ‘ä»¬ä¸ºæœ€å°å’Œæœ€å¤§å­—ä½“å¤§å°è®¡ç®—è¿‡åˆ†ç•Œç‚¹ï¼Œä¸æ˜¯é€‰æ‹©ä»–ä»¬ã€‚ é‚£æˆ‘ä»¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨ calc()ã€‚å°† calc() å’Œè§†å£å•ä½ç»“åˆä½¿ç”¨å¯ä»¥å¾—åˆ°è¿›é˜¶ç‰ˆæµå¼æ–‡å­—æ’ç‰ˆï¼Œå­—ä½“ä¼šåœ¨æŒ‡å®šçš„è§†å£èŒƒå›´å†…çš„æŒ‡å®šåƒç´ å€¼ä¹‹é—´å®Œç¾ç¼©æ”¾ã€‚æˆ‘ä»¬åªéœ€ç®€å•çš„åˆ›é€ ä¸€ä¸ªåŸºæœ¬çš„æ•°å­¦å…¬å¼ã€‚ ç‚¹å‡»æŸ¥çœ‹å¤§å›¾ç‰‡ è¿™ä¸ªå‡½æ•°å–æŒ‡å®šèŒƒå›´å†…çš„ä¸€ä¸ªå€¼ï¼Œç„¶åè®¡ç®—å‡ºåº”ç”¨åœ¨ä¸åŒèŒƒå›´çš„æ–°å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœå–æ•°å­— 1 å’Œ 100 è¿˜æœ‰å€¼ 50ï¼Œé‚£ä¹ˆåº”ç”¨åˆ° 1 å’Œ 200 ä¹‹é—´æ—¶ï¼Œæ–°å€¼å°±æ˜¯ 100ã€‚è€Œä¸”è¿™äº›å€¼åœ¨èŒƒå›´ä¸­ä»»ä½•ç‚¹éƒ½æ˜¯æ­£ç¡®çš„ã€‚ è¿™æ˜¯ä¸ªå¾ˆæ™®é€šçš„æ˜ å°„å‡½æ•°ï¼Œåœ¨ JavaScript å¤„ç†æ•°æ®æ—¶å·²ç»ä½¿ç”¨è¿‡å¾ˆå¤šæ¬¡ã€‚æˆ‘å¾ˆå¥½å¥‡å°†å‡½æ•°ä¸ calc() ä¸€èµ·ä½¿ç”¨çš„å¯èƒ½æ€§ï¼Œå½“å‘ç°è¿™å°±æ˜¯çº¯æ•°å­¦å‡½æ•°æ—¶ï¼Œæˆ‘çŸ¥é“å°±ç¼ºä¸€ä¸ªå˜é‡äº†ã€‚è¿™æ˜¯ä½¿ç”¨è§†å£çš„å…³é”®åŒºåˆ«ï¼šè§†å£å¤§å°å°±æ˜¯å˜é‡ã€‚100vw çš„å€¼å°±æ˜¯è¿™ä¸ªæ–¹ç¨‹å¼çš„å˜é‡ï¼Œå› ä¸ºå½“è§†å£å˜åŒ–æ—¶ 100vw çš„å€¼ä¹Ÿæ˜¯å˜åŒ–çš„ã€‚æœ‰äº†è¿™ä¸ªåˆå§‹æƒ³æ³•ï¼Œæˆ‘èŠ±äº†ä¸€æ®µæ—¶é—´ä½¿å¾—è¿™ä¸ªå‡½æ•°å·¥ä½œã€‚calc() å‡½æ•°ä»¥ç‰¹å®šæ–¹å¼å¤„ç†æ–¹ç¨‹å¼ä¸­çš„å•ä½ç±»å‹ã€‚å¦‚æœä½ å¯¹è¿™ç±»äº‹æƒ…æ„Ÿå…´è¶£ï¼Œæˆ‘æåŠ›æ¨èé˜…è¯» W3C è§„èŒƒï¼šå•ä½çš„ç±»å‹ä¸å€¼ï¼›å¦‚æœä¸å‡ºæ„å¤–ï¼ŒæŒæ¡è¿™ä¸ªä½ å°±å¯ä»¥å»æ˜¾æ‘†äº†ã€‚ å°½ç®¡è¿™ä¸ªè®¡ç®—å¼çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œä½†å…¶å®ç›¸å½“ç®€å•ã€‚æˆ‘ä»¬é€‰å®šæœ€å°å­—ä½“å¤§å°å’Œæœ€å¤§å­—ä½“å¤§å°ï¼Œæœ€å°å±å¹•å°ºå¯¸å’Œæœ€å¤§çš„å±å¹•å°ºå¯¸ï¼Œä¸æ˜¯é€‰å®šå­—ä½“åº”è¯¥ç¼©æ”¾çš„å¤§å°ï¼Œç„¶åå°†é€‰å®šçš„å€¼ä»£å…¥æ–¹ç¨‹ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•ç±»å‹çš„å•ä½ï¼ŒåŒ…æ‹¬ emï¼Œrem æˆ– pxã€‚åœ¨æ–‡ç« çš„ä¾‹å­ä¸­æˆ‘å–œæ¬¢ä½¿ç”¨ px è¿™ä¸ªå•ä½ï¼Œå› ä¸º px è®©æ¦‚å¿µæ›´å®¹æ˜“ç†è§£ï¼Œä½†åœ¨å®é™…å·¥ä½œä¸­æˆ‘æ›´å–œæ¬¢ä½¿ç”¨ remã€‚ä½†æ— è®ºä½ é€‰æ‹©å“ªä¸ªå•ä½ï¼Œéƒ½è¦ä¿è¯æ–¹ç¨‹å¼ä¸­æ‰€æœ‰çš„å€¼éƒ½ä½¿ç”¨ç›¸åŒç±»å‹çš„å•ä½ï¼Œä½ å¿…é¡»å‰¥ç¦»å•ä½çš„å½±å“ï¼Œå¦‚ä¾‹å­æ‰€ç¤ºã€‚ å¦‚æœä½ ä¸æƒ³æ‰‹å†™ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå·¥å…·ï¼Œæ¯”å¦‚ Sass å’Œ LESS çš„ mixinsï¼Œè¿˜æœ‰ PostCSS çš„æ’ä»¶ã€‚ä½ æƒ³æ€ä¹ˆç©ï¼Œå°±æ€ä¹ˆç©ã€‚ ç»´æŒå®Œç¾è¡Œå®½Robert åœ¨ä»–çš„ä¹¦ã€Šå°åˆ·é£æ ¼è¦ç´ ã€‹ä¸­å»ºè®®ï¼Œä¸€ä¸ªä»¤äººæ„Ÿè§‰èˆ’é€‚çš„è¡Œå®½å¤§æ¦‚æ˜¯ 45 åˆ° 75 ä¸ªå­—ç¬¦ã€‚ å¯¹äºåœ¨æ­£æ–‡ä¸­ä½¿ç”¨è¡¬çº¿å­—ä½“ï¼ˆè¯‘è€…æ³¨ï¼šè‹±è¯­ä¸­çš„ä¸€ç§æ ¼å¼ï¼‰çš„å•æ é¡µé¢æ¥è¯´ï¼Œ45 åˆ° 75 ä¸ªå­—ç¬¦è¢«å¹¿æ³›è®¤ä¸ºæ˜¯ä»¤äººæ»¡æ„çš„è¡Œå®½ã€‚66 ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬å­—ç¬¦ä¸ç©ºæ ¼ï¼‰åˆ™è¢«å…¬è®¤ä¸ºå®Œç¾è¡Œå®½ã€‚ è¿™ä¸ªè§„åˆ™å¯ä»¥ç›´æ¥å¤ç”¨åˆ°æµå¼æ–‡å­—æ’ç‰ˆä¸­ï¼Œå¦å¤–åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œéšç€æ–‡å­—çš„ç¼©æ”¾å®ç°ä¸€è‡´çš„è¡Œå®½ä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ã€‚ åœ¨å“åº”å¼æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®åˆ†ç•Œç‚¹æ¥è°ƒæ•´å­—ä½“å¤§å°ï¼Œè¿˜ä¼šç»å¸¸ä»»æ„è°ƒæ•´å®¹å™¨å®½åº¦æ¥ç»´æŒæ­£ç¡®çš„è¡Œå®½ã€‚ç„¶è€Œï¼Œåœ¨æµå¼æ–‡å­—æ’ç‰ˆä¸­ï¼ŒæŒ‡å®šåˆ†ç•Œç‚¹å¤„çš„æ–‡å­—è°ƒæ•´å·²ç»æ²¡æœ‰å¿…è¦äº†ã€‚ç°åœ¨åªéœ€è¦è®¾ç½®å®¹å™¨å®½åº¦éšç€å­—ä½“å¤§å°çš„å˜åŒ–é€Ÿç‡è€Œç¼©æ”¾å°±è¡Œã€‚å¯ä»¥åœ¨ width å±æ€§ä¸­ä½¿ç”¨ calc() æŠ€æœ¯ï¼Œä¸ font-size çš„è®¾ç½®ä¸€æ ·ç®€å•ã€‚è¿™æ ·å°±èƒ½è½»æ¾ç»´æŒå®Œç¾è¡Œå®½â€”â€”åŒæ—¶æˆ‘ä¹Ÿæ³¨æ„åˆ°æ ·å¼è¡¨æ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤äº†ã€‚ ä¿æŒå®Œç¾è¡Œå®½åœ¨éå¸¸å°çš„å±å¹•ä¸‹æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ä¸ºäº†ç»´æŠ¤â€œå®Œç¾çš„â€é˜…è¯»å®½åº¦è€Œç¼©å°å­—ä½“ï¼Œå½“ç¼©å°åˆ°æŸä¸ªç‚¹åæ€»ä¼šæŸå®³å¯è¯»æ€§ã€‚æˆ‘ä»¬åªèƒ½æ¥å—è¿™ä¸ªäº‹å®ï¼Œç„¶åé’ˆå¯¹ç§»åŠ¨è®¾å¤‡ä¸ºæŸäº›å…³é”®å†…å®¹çš„å®¹å™¨è®¾ç½®å®½åº¦ã€‚ å®ç°ä¸€ä¸ªæ¨¡å—åŒ–æ¯”ä¾‹å°ºæ¨¡å—åŒ–æ¯”ä¾‹å°ºå°±æ˜¯ä¸€ç³»åˆ—ç›¸äº’ä¹‹é—´æ¯”ä¾‹åè°ƒçš„æ•°å­—ã€‚ä¸€å›¾èƒœåƒè¨€ï¼š æ¯ä¸ªæ ‡é¢˜éƒ½æ¯”å‰ä¸€ä¸ªæ ‡é¢˜çš„ç¼©å°äº† 1.2 å€ï¼ˆè¯‘è€…æ³¨ï¼šåŸæ–‡å†™çš„æ˜¯ biggerï¼Œåº”è¯¥æ˜¯é”™è¯¯çš„ï¼‰ã€‚ï¼ˆç‚¹å‡»æŸ¥çœ‹å¤§å›¾ï¼‰ ä¸åŒçš„æ¯”ä¾‹å°ºåœ¨ä¸åŒå°ºå¯¸çš„å±å¹•ä¸‹æ•ˆæœæ›´å¥½ã€‚ ï¼ˆç‚¹å‡»æŸ¥çœ‹å¤§å›¾ï¼‰ åœ¨å°å±å¹•ä¸­ï¼Œæ ‡é¢˜å¤§å°åº”è¯¥æ›´ç»Ÿä¸€ï¼›å› ä¸ºå¤§å±å¹•æœ‰æ›´å¤šçš„ç©ºé—´åº”ä»˜æ›´å¤šæ ·çš„å˜åŒ–ã€‚åœ¨ä¸åŒçš„æ¨¡å—åŒ–æ¯”ä¾‹å°ºä¹‹é—´ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šæ–‡æåˆ°çš„åŠ¨æ€å˜åŒ–çš„æ–‡å­—æ’ç‰ˆæŠ€æœ¯ã€‚åªéœ€ä¸ºå°å±å¹•é€‰æ‹©ä¸€ä¸ªæ¯”ä¾‹å°ºï¼Œä¸ºå¤§å±å¹•é€‰æ‹©å¦ä¸€ä¸ªæ¯”ä¾‹å°ºï¼Œç„¶åä¸ºæ¯ä¸€ä¸ªçº§åˆ«çš„æ ‡é¢˜è®¡ç®—å‡ºæœ€å°å­—ä½“å¤§å°ä¸æœ€å¤§å­—ä½“å¤§å°ã€‚ ä¸ºäº†è®¡ç®—å‡ºæ¨¡å—åŒ–æ¯”ä¾‹å°ºï¼Œæˆ‘ä»¬å…ˆå–åŸºç¡€çš„å­—ä½“å¤§å°ä¸é€‰å®šæ¯”ä¾‹ç›¸ä¹˜å¾—åˆ°ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ã€‚é™¤ä»¥é€‰å®šæ¯”ä¾‹å¾—åˆ°ä¸€ä¸ªè¾ƒå°çš„æ•°å­—ã€‚æ ¹æ®å¾—åˆ°çš„æ•°å­—å†é‡å¤æ­¤æ­¥éª¤ï¼Œå°±ä¼šå¾—åˆ°ç¼©æ”¾è¿‡ç¨‹ä¸­æ¯ä¸ªå¿…éœ€çš„å€¼ã€‚ æ”¾å¤§ 1em Ã— 1.125em = 1.125em 1.125em Ã— 1.125em = 1.266em 1.266em Ã— 1.125em = 1.424em 1.424em Ã— 1.125em = 1.602em ç¼©å° 1em Ã· 1.125em = 0.889em 0.889em Ã· 1.125em = 0.790em 0.790em Ã· 1.125em = 0.702em 0.702em Ã· 1.125em = 0.624em æˆ‘ä»¬å– 1.125 ä½œä¸ºæœ€å°ç¼©æ”¾æ¯”ä¾‹ï¼Œå– 1.250 ä½œä¸ºæœ€å¤§ç¼©æ”¾æ¯”ä¾‹ ï¼Œç„¶ååšé‡å¤è®¡ç®—ã€‚ç„¶ååœ¨ä¸åŒçº§åˆ«çš„æ ‡é¢˜ä¸­ä½¿ç”¨æ¯”ä¾‹å°ºä¸­çš„ä¸åŒæ¯”ä¾‹ã€‚ æœ€å°ç¼©æ”¾æ¯”ä¾‹ï¼š 1.125 æœ€å¤§ç¼©æ”¾æ¯”ä¾‹ï¼š1.250 æ ‡é¢˜çº§åˆ« æœ€å°å­—ä½“å¤§å° æœ€å¤§å­—ä½“å¤§å° h1 1.602em 2.441em h2 1.424em 1.953em h3 1.266em 1.563em h4 1.125em 1.250em æˆ‘åœ¨ Codepen ä¸Šå®ç°äº†ä¸€ä¸ªæµå¼æ¨¡å—åŒ–æ¯”ä¾‹å°ºæ ‡é¢˜çš„ä¾‹å­ã€‚ä½ è¿˜å¯ä»¥åœ¨ Tim Brown çš„æ–‡ç« ã€Šæ›´æœ‰æ„ä¹‰çš„æ–‡å­—æ’ç‰ˆã€‹ä¸­é˜…è¯»æ›´å¤šå…³äºæ¨¡å—åŒ–æ¯”ä¾‹å°ºçš„å†…å®¹ã€‚ å¦‚æœä½ åœ¨é€‰æ‹©åˆé€‚çš„æ¯”ä¾‹å°ºæ—¶éœ€è¦å¸®åŠ©ï¼Œæˆ‘æ¨è Jeremy Church çš„ç½‘ç«™ Type Scale å’Œ Tim Brown ä¸ Scott Kellum çš„ç½‘ç«™ Modular Scaleã€‚ ä¿æŒå‚ç›´èŠ‚å¥å‚ç›´èŠ‚å¥å°±æ˜¯è®©é¡µé¢ä¸Šçš„å…ƒç´ ä¹‹é—´ä¿æŒä¸€è‡´ä¸”æˆæ¯”ä¾‹çš„é—´è·ã€‚ä½ å¯ä»¥åœ¨ Espen Brunborg çš„æ–‡ç« ã€ŠCSS åŸºçº¿ï¼šå¥½çš„ï¼Œåçš„å’Œä¸‘çš„ã€‹ä¸­æ‰¾åˆ°æ›´å¤šå…³äºå‚ç›´èŠ‚å¥çš„ä¿¡æ¯ã€‚ åœ¨æµå¼å¸ƒå±€ä¸­è¦ä¿æŒå‚ç›´èŠ‚å¥ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¯ä¸ªå…ƒç´ çš„å‚ç›´é—´è·è®¾ç½®ä¸ºåŸºå‡†å€¼çš„æŸä¸ªæ¯”ä¾‹å€¼ã€‚å“åº”å¼æ–‡å­—æ’ç‰ˆä¸­ä»¤è®¸å¤šäººæ„Ÿåˆ°æŒ‘æˆ˜çš„æ˜¯å¦‚ä½•æ‰¾åˆ°åœ¨å°å±å¹•å’Œå¤§å±å¹•ä¸‹éƒ½èƒ½å·¥ä½œçš„å‚ç›´èŠ‚å¥ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸ºå°å±å¹•ä¸å¤§å±å¹•è®¾ç½®ä¸åŒçš„åŸºå‡†å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ¯”ä¾‹ã€‚ åœ¨æµå¼æ–‡å­—æ’ç‰ˆä¸­ï¼ŒåŸºå‡†å€¼ä¹Ÿå¯ä»¥åƒå­—ä½“å¤§å°ä¸€æ ·è®¾ç½®ä¸ºåŠ¨æ€çš„ã€‚å…¶å®ï¼Œå¦‚æœå·²ç»ç»™æ ¹å…ƒç´ è®¾ç½®äº†ä¸€ä¸ªåŠ¨æ€å€¼ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨å•ä½ em æˆ–è€… remï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ calc() ã€‚ å‡è®¾åŸºå‡†å€¼æ˜¯ 1.5remã€‚é‚£ä¹ˆå…ƒç´  body çš„ padding å€¼å°±æ˜¯ 1.5remã€‚ 123body &#123; padding: 1.5rem;&#125; åŒæ ·çš„ï¼Œæˆ‘ä»¬å°† line-height å’Œ margin ä¹Ÿè®¾ç½®ä¸º 1.5remã€‚ 1234p &#123; line-height: 1.5rem; margin-bottom: 1.5rem;&#125; å¯¹äºæ ‡é¢˜å…ƒç´ ï¼Œæˆ‘æƒ³è®¾ç½®ä¸€ä¸ªä¸åŒçš„è¡Œé«˜ã€‚ç„¶è€Œï¼Œæˆ‘åˆæƒ³è®©è¡Œé«˜åŠ ä¸Š margin ä¹‹åç­‰äºåŸºå‡†å€¼çš„å¢é‡ã€‚è¿™æ—¶ calc() å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ 123456h1 &#123; font-size: 2rem; line-height: 2rem; margin-top: calc((1.5rem - 2rem) + 1.5rem); margin-bottom: 1.5rem;&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ ‡é¢˜å…ƒç´ çš„æ€»é«˜åº¦åŠ ä¸Š margin å€¼å°†ä¼šæ˜¯ 3remï¼Œåˆšå¥½ç­‰äºåŸºå‡†å€¼çš„ä¸¤å€ã€‚ æˆ‘åœ¨ Codepen ä¸Šä½¿ç”¨ Sass å˜é‡å†™äº†ä¸€ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥è®¾ç½®ä¸åŒçš„åŸºå‡†å€¼æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ æœªæ¥ï¼Œè‡ªå®šä¹‰ CSS å±æ€§å°†ä¼šä½¿å¾—è¿™ä¸ªæŠ€å·§æ›´æœ‰è¶£ã€‚é‚£æ—¶æˆ‘ä»¬å¯ä»¥åœ¨ calc() ä¸­ä½¿ç”¨ CSS å˜é‡æ¥æ”¹å˜åª’ä½“æŸ¥è¯¢ä¸­çš„åŸºçº¿å€¼ã€‚ å¦‚ä½•å¤„ç†é™åˆ¶æ¡ä»¶ä¹Ÿè®¸ä½ æƒ³åœ¨æœ‰å¸ƒå±€é™åˆ¶çš„ç½‘ç«™ä¸Šå®ç°æµå¼æ–‡å­—æ’ç‰ˆï¼Œåˆæˆ–è®¸ä½ ä¸å¾—ä¸ä½¿ç”¨ WordPress æˆ– Bootstrap ä¸­çš„é¢„å®šä¹‰å¸ƒå±€ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå®¹å™¨å¾ˆæœ‰å¯èƒ½ä¸æ˜¯æµå¼çš„ï¼Œå¦‚æœæ˜¯ï¼Œå¤§æ¦‚ä¹Ÿä¸ä¼šä¸å­—ä½“å¤§å°ä»¥åŒé€Ÿç‡å˜åŒ–ã€‚ æˆ‘æœ€è¿‘ä¸ºæ¾³å¤§åˆ©äºšæ”¿åºœæ°‘æ”¿éƒ¨é—¨çš„ç½‘ç«™å®ç°æµå¼æ–‡å­—æ’ç‰ˆã€‚è¿™æ˜¯ä¸ªå……æ»¡æŒ‘æˆ˜çš„å¤§ç½‘ç«™ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»åŸºäºç°æœ‰çš„è®¾è®¡å·¥ä½œã€‚åœ¨è¿™æ ·ä¸€ä¸ªè®¿é—®é‡å·¨å¤§çš„ç½‘ç«™ä¸Šå®ç°æµå¼æ–‡å­—æ’ç‰ˆï¼Œæˆ‘ä¸»è¦å…³æ³¨ä¸¤ä¸ªé—®é¢˜ã€‚ ç¬¬ä¸€ï¼Œæˆ‘å¦‚ä½•é¿å…ç ´åå¸ƒå±€ï¼Ÿå°¤å…¶æ˜¯å½“å­—ä½“å¤§å°ä»¥ä¸åŒé€Ÿç‡å˜åŒ–æ—¶æˆ‘ä»¥ä¸ºå¯¼èˆªå®¹å™¨ä¸­çš„å†…å®¹ä¼šæº¢å‡ºã€‚ä½†ä»¤æˆ‘æƒŠè®¶çš„æ˜¯ï¼Œè¿™æ ¹æœ¬ä¸æ˜¯ä¸ªé—®é¢˜ã€‚ å®é™…ä¸Šï¼Œå†…å®¹å¯ä»¥è‡ªç„¶åœ°è°ƒæ•´ä»¥é€‚åº”å®¹å™¨ï¼Œè€Œåœ¨ä¹‹å‰éœ€è¦æŒ‡å®šåˆ†ç•Œç‚¹æ¥è°ƒæ•´ã€‚æ€»ä¹‹ï¼Œæ ·å¼è¡¨éœ€è¦æ›´å°‘çš„åª’ä½“æŸ¥è¯¢ï¼Œå¹¶ä¸”åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¹Ÿéœ€è¦çš„æ ·å¼å£°æ˜æ¯”åŸæ¥å°‘å¾—å¤šã€‚ è¿™æ˜¯ä¸ªæ„å¤–æ”¶è·ï¼Œæˆ‘ä»¬è¿˜åœ¨è®¸å¤šåœ°æ–¹æŠ›å¼ƒäº†å¯¹å¹³æ¿ç”µè„‘çš„ä¼˜åŒ–è®¾è®¡ï¼Œå› ä¸ºæ¡Œé¢ç‰ˆç°åœ¨ä¹Ÿèƒ½åœ¨æ›´å°çš„å±å¹•ä¸Šå·¥ä½œäº†ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¹‹å‰éœ€è¦åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸­éœ€è¦è‹¥å¹²è°ƒæ•´çš„å¯¼èˆªç»„ä»¶å®ä¾‹ã€‚è™½ç„¶åœ¨å°å±å¹•ä¸‹ä¸å®Œç¾ï¼Œä½†å­—ä½“ç´§å‡‘ï¼ŒåŠŸèƒ½å¥å…¨ï¼Œä¹Ÿæ²¡æœ‰ç ´åå¸ƒå±€ã€‚ (ç‚¹å‡»æŸ¥çœ‹å¤§å›¾) æˆ‘çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œæœ‰äº›å…ƒç´ æ˜¯å›ºå®šå®½åº¦ï¼Œæˆ‘ä¹ŸçŸ¥é“ä¸å¯èƒ½æ¯ä¸€è¡Œéƒ½è¾¾åˆ°å®Œç¾è¡Œå®½ã€‚å®é™…ä¸Šï¼Œæˆ‘å°†å­—ä½“å¤§å°è°ƒæ•´ä¸ºæ‰‹æœºå’Œå¹³æ¿ä¸Šé¢çš„å®Œç¾é•¿åº¦ â€”â€” æˆ‘è®¤ä¸ºè¿™æ˜¯æœ€é‡è¦çš„ã€‚ è¿˜æœ‰ä¸å¾—ä¸æ¥å—çš„æƒ…å†µæ˜¯ï¼Œç”±äºä¸»å®¹å™¨æ²¡æœ‰ä»¥å’Œæ–‡å­—ä»¥åŒé€Ÿç‡ç¼©æ”¾ï¼Œä¸€äº›æ–‡å­—å¯èƒ½åœ¨æµè§ˆå™¨è°ƒæ•´å¤§å°çš„æ—¶å€™ä¸å¯é¿å…åœ°å›æµã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å› ä¸ºæˆ‘ä¸æƒ³è®©è¯»è€…åœ¨æ—‹è½¬è®¾å¤‡æ—¶ä¸¢å¤±ä»–ä»¬çš„é˜…è¯»ç„¦ç‚¹ã€‚ä½†å› ä¸ºæˆ‘ä»¬æ— æ³•é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å”¯ä¸€èƒ½åšçš„å°±æ˜¯åœ¨æŒ‡å®šè®¾å¤‡ä¸Šæµ‹è¯•ä¸€ä¸‹æœ‰å¤šå°‘å½±å“ã€‚å¾ˆå¹¸è¿çš„æ˜¯å›æµåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå‡ ä¹å¾ˆéš¾è¢«æ³¨æ„åˆ°ï¼Œç”šè‡³åœ¨å¤§çš„å¹³æ¿ç”µè„‘ä¸Šè¿™ä¸ªå½±å“ä¹Ÿæ˜¯æå°çš„ã€‚ æˆ‘ä»¬å¯¹æœ€ç»ˆçš„æ•ˆæœå¾ˆæ»¡æ„ã€‚ç„¶è€Œæˆ‘ä»¬å¯ä»¥åšæ›´å¤šæ¥æå‡å­—ä½“æ’ç‰ˆï¼Œæ¯«æ— ç–‘é—®è¿™ä¹ˆåšæå‡äº†ç½‘ç«™çš„å¯è¯»æ€§ã€‚é‰´äºä»å®ç°æµå¼å­—ä½“æ’ç‰ˆä¸­å¸å–çš„æ•™è®­ï¼Œè¯¥ç½‘ç«™è®¾è®¡çš„ä¸‹ä¸€ä¸ªè¿­ä»£åº”ä¸»è¦å…³æ³¨å­—ä½“å¦‚ä½•æ’ç‰ˆä»¥åŠç½‘ç«™çš„å¯è¯»æ€§æ–¹é¢ã€‚ åœ¨å·²æœ‰ç½‘ç«™ä¸Šå®ç°æµå¼æ–‡å­—æ’ç‰ˆçš„å»ºè®® è®¤çœŸåœ°é€‰æ‹©ç¼©æ”¾æ¯”ä¾‹ã€æœ€å°å’Œæœ€å¤§å­—ä½“å¤§å°ï¼Œç¡®ä¿èƒ½ä¸ä½ çš„è®¾è®¡å®Œç¾å¥‘åˆã€‚ å­—ä½“å¤§å°ä½¿ç”¨å•ä½ emã€‚å¦‚æœä½ éœ€è¦åœ¨æŸä¸€ç‰¹å®šå®¹å™¨ä¸­ç¦ç”¨æµå¼æ–‡å­—æ’ç‰ˆï¼Œä¾‹å¦‚å¯¼èˆªæ ï¼Œé‚£ä¹ˆå¯å°†å®¹å™¨çš„å­—ä½“å¤§å°è®¾ä¸ºä¸€ä¸ªå›ºå®šå€¼ã€‚è¿™æ—¶è¯¥å®¹å™¨ä¸­å•ä½ä¸º em çš„å€¼å°†ä¸è¿™ä¸ªå›ºå®šå€¼ç›¸å…³ã€‚ åŒæ ·åœ°ï¼Œå¦‚æœä½ éœ€è¦ç»™æŸä¸€ç‰¹å®šå®¹å™¨è®¾ç½®æµå¼å­—ä½“æ’ç‰ˆã€‚é‚£ä½ å¯ä»¥ç»™è¯¥å®¹å™¨çš„å­—ä½“å¤§å°è®¾ç½®ä¸€ä¸ªä¸å®šå€¼ï¼Œé‚£å®¹å™¨ä¸­å•ä½ä¸º em çš„å€¼ä¼šå˜æˆæµå¼çš„ã€‚ å¦‚æœæ–‡å­—å›æµåªå‘ç”Ÿåœ¨æµè§ˆå™¨è°ƒæ•´å¤§å°æˆ–è®¾å¤‡æ—‹è½¬çš„æ—¶å€™ï¼Œé‚£æ²¡å¿…è¦æŠŠå®ƒå½“ä½œä¸€ä¸ªåäº‹æƒ…ã€‚ ä¿æŒå®Œç¾è¡Œå®½æ˜¯ä¸å¯èƒ½çš„ã€‚ä¸»è¦è€ƒè™‘æ‰‹æœºå’Œå¹³æ¿ç”µè„‘çš„å®Œç¾è¡Œå®½å°±è¡Œã€‚ æµè§ˆå™¨æ”¯æŒä¸ Bugsæˆ‘ç»å¸¸å¬è¯´ Safariï¼Œå°¤å…¶æ˜¯ç§»åŠ¨ç‰ˆ Safariï¼Œåœ¨ä½¿ç”¨è§†å£å•ä½å’Œ calc() è¡¨è¾¾å¼æ—¶éƒ½æœ‰ä¸¥é‡çš„ bugã€‚ç„¶è€Œï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ²¡æœ‰æåˆ°å…·ä½“é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘æƒ³æˆ‘å¾—è‡ªå·±æµ‹è¯•ã€‚ æˆ‘åˆ†åˆ«æµ‹è¯•äº† calc() è¡¨è¾¾å¼å’Œè§†å£å•ä½ï¼Œä»¥åŠç»“åˆäº†è§†å£å•ä½å’Œ calc() çš„è¿›é˜¶ç‰ˆæµå¼å­—ä½“æ’ç‰ˆæŠ€æœ¯ã€‚ä½†æˆ‘æ²¡æœ‰å‘ç°ä»»ä½•é˜»æ­¢æˆ‘ä½¿ç”¨è¿™äº›æŠ€æœ¯çš„é—®é¢˜ã€‚ calc() å’Œè§†å£å•ä½åœ¨é«˜çº§æµè§ˆå™¨ä¸Šéƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯åœ¨ä½äº Safari8 å’Œ IE11 çš„ç‰ˆæœ¬é‡Œï¼Œå½“ calc() è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†è§†å£å•ä½æ—¶ï¼Œæµè§ˆå™¨çª—å£æ”¹å˜æ—¶ä¸ä¼šé‡æ–°è®¡ç®—ç»“æœã€‚ ä½ å¯ä»¥é€šè¿‡é¢å¤–çš„åª’ä½“æŸ¥è¯¢æ¥å¼ºåˆ¶è¡¨è¾¾å¼é‡æ–°è®¡ç®—ï¼š 123456789101112131415/* è€ç‰ˆæœ¬æµè§ˆå™¨ */html &#123; font-size: 16px; &#125;/* é«˜çº§æµè§ˆå™¨åªéœ€è¦ä¸‹é¢è¿™ä¸ª*/@media screen and (min-width: 25em)&#123; html &#123; font-size: calc( 16px + (24 - 16) * (100vw - 400px) / (800 - 400) ); &#125;&#125;/* Safari &lt;8 å’Œ IE &lt;11 */@media screen and (min-width: 25em)&#123; html &#123; font-size: calc( 16px + (24 - 16) * (100vw - 400px) / (800 - 400) ); &#125;&#125;@media screen and (min-width: 50em)&#123; html &#123; font-size: calc( 16px + (24 - 16) * (100vw - 400px) / (800 - 400) ); &#125;&#125; è¿™ä¸ªæŠ€æœ¯å¼ºåˆ¶ä½äº Safari8 å’Œ IE11 çš„æµè§ˆå™¨åœ¨æŒ‡å®šåˆ†ç•Œç‚¹å¤„é‡æ–°è®¡ç®—å­—ä½“å¤§å°ã€‚ åœ¨ JavaScript ä¸­ä½¿ç”¨çª—å£é‡ç»˜äº‹ä»¶æ¥å¼ºåˆ¶ä½ç‰ˆæœ¬æµè§ˆå™¨é‡æ–°å¸ƒå±€ä¹Ÿè®¸å¯ä»¥ï¼Œä½†æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªå¯ä¾èµ–æ–¹æ³•æ¥è¿™ä¹ˆåšï¼Œè¿˜æœ‰è¿™æ ·åšå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨æŒ‡å®šåˆ†ç•Œç‚¹å¤„é‡æ–°è®¡ç®—æ˜¯è¿™äº›æµè§ˆå™¨å¯æ¥å—çš„ä¸€ä¸ªé™çº§æ–¹æ¡ˆã€‚ å¯¹äºé‚£äº›ä¸æ”¯æŒè§†å£å•ä½å’Œ calc() è¡¨è¾¾å¼çš„å¤è‘£æµè§ˆå™¨ï¼Œæµå¼æŠ€æœ¯å¯ä»¥ç›´æ¥å¿½ç•¥ã€‚å¦‚æœè®¾ç½®äº†åˆç†çš„é»˜è®¤å€¼ï¼Œè¿™äº›æŠ€æœ¯ä¹Ÿå¯ä»¥ä½œä¸ºæ¸è¿›å¢å¼ºæ–¹æ¡ˆã€‚ ä»Šå¤©å¦‚ä½•ä½¿ç”¨æµå¼å­—ä½“æ’ç‰ˆå¦‚æœä½ è®¡åˆ’å®ç°æµå¼å­—ä½“æ’ç‰ˆï¼Œé¦–å…ˆä½ å¾—ç¡®å®šé‡‡ç”¨å“ªç§æ–¹æ³•ã€‚ å¦‚æœæ•´ä¸ªè®¾è®¡éƒ½æ˜¯æµå¼çš„ï¼Œé‚£ä½ å¯ä»¥è€ƒè™‘å°† root em è®¾ç½®ä¸ºæµå¼çš„ï¼Œé€šè¿‡åœ¨å…ƒç´  html ä¸Šå£°æ˜ä¸€ä¸ªä½¿ç”¨æµå¼å•ä½çš„å­—ä½“å¤§å°ã€‚ç„¶åï¼Œæ•´ä¸ªè®¾è®¡çš„å…¶ä»–éƒ¨åˆ†éƒ½ä½¿ç”¨ em æˆ–è€… rem å•ä½å°±å¯ä»¥äº†ã€‚ è®¤çœŸåœ°é€‰æ‹©æœ€å°å’Œæœ€å¤§çš„å­—ä½“å¤§å°ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä½ éœ€è¦å†³å®šæ˜¯å¦ç›´æ¥ä½¿ç”¨è§†å£å•ä½ï¼Œè¿˜æ˜¯æ›´ç²¾ç¡®æ§åˆ¶ç¼©æ”¾é€Ÿç‡ã€‚å¦‚æœé€‰æ‹©åè€…ï¼Œé‚£ä¹ˆSassæˆ–è€… LESS çš„ mixin æˆ–è€… PostCSS æ’ä»¶ä¼šå¸®ä½ çœä¸å°‘å·¥ä½œã€‚ ä¸€å¼€å§‹å°±é€‰æ‹©å¥½æœ€å°å’Œæœ€å¤§çš„å­—ä½“å¤§å°ã€‚è¿™æ˜¯æœ€é‡è¦çš„é€‰æ‹©ã€‚å› ä¸ºå…¶ä»–æ‰€æœ‰ç»„ä»¶çš„å­—ä½“å¤§å°éƒ½ä¾èµ– root emã€‚åœ¨é¡¹ç›®åæœŸä¿®æ”¹ root emï¼Œæ„å‘³ç€ä½ å¿…é¡»è°ƒæ•´æ‰€æœ‰çš„ä¸€åˆ‡ã€‚ åœ¨ä½¿ç”¨æµå¼æŠ€æœ¯ä¹‹å‰åˆ«å¿˜äº†å£°æ˜çš„ä¸€ä¸ªé»˜è®¤çš„å­—ä½“å¤§å°ã€‚è¿™ä¸ªé»˜è®¤å€¼ä¼šåœ¨ä¸æ”¯æŒæµå¼å•ä½çš„æµè§ˆå™¨ä¸Šå·¥ä½œï¼Œå®ƒä¸ç”¨ç­‰äºæœ€å°çš„å­—ä½“å¤§å°ã€‚ æœ€åï¼Œä½ è¿˜éœ€è¦è€ƒè™‘è®¾è®¡ç¨¿çš„é™åˆ¶ï¼Œä»¥åŠå¦‚ä½•å¤„ç†å¦‚æ ‡é¢˜çº§åˆ«å’Œè¡Œå®½ç­‰äº‹æƒ…ã€‚çœ‹çœ‹æ–‡ç« ä¸­æåˆ°çš„è¿™äº›æŠ€æœ¯ã€‚å¦‚æœä½ æƒ³è®©ç»„ä»¶è€Œä¸æ˜¯æ ‡é¢˜ä»¥ä¸å¸¸è§„æ–‡æœ¬ä¸åŒçš„é€Ÿç‡ç¼©æ”¾ï¼Œé‚£åœ¨æ·»åŠ  calc() è¡¨è¾¾å¼ä¹‹å‰è€ƒè™‘å¯è¯»æ€§å’Œæ ·å¼è¡¨çš„ç»´æŠ¤ã€‚ å¸Œæœ›ä½ çœ‹å®Œæœ¬æ–‡èƒ½æœ‰æ‰€å¯å‘ï¼Œè€ƒè™‘ä¸‹ä¸ªé¡¹ç›®æ˜¯å¦é€‚åˆä½¿ç”¨æµå¼å­—ä½“å¸ƒå±€ã€‚ å¿…è¯» â€œFit to Scale,â€ Trent Walton â€œFluid Type,â€ Trent Walton â€œViewport Sized Typography,â€ Chris Coyier ç›¸å…³é˜…è¯» â€œResponsive Typography With SASS Maps,â€ Jonathan Suh â€œBenton Modern: A Case Study on Art-Directed Responsive Web Typography,â€ Marko DugonjiÄ‡ â€œAdvanced Web Typography: Responsive Web Typography,â€ Elliot Jay Stocks æ‰©å±•é˜…è¯» â€œEverything I Know About Responsive Web Typography,â€ Zell Liew â€œResponsive Typography With REMs: How to Build a Scalable Typographic Foundation in Three Steps,â€ Max Luster â€œFluid Typography for Responsive Websites,â€ Ana Sampaio â€œResponsive Typography,â€ Responsivedesign.is åŸæ–‡ï¼šTruly Fluid Typography With vh And vw Units ä½œè€…ï¼š Michael Riethmuller","tags":[{"name":"CSS","slug":"CSS","permalink":"http://zhouweicsu.github.io/blog/tags/CSS/"},{"name":"fluid","slug":"fluid","permalink":"http://zhouweicsu.github.io/blog/tags/fluid/"},{"name":"Typography","slug":"Typography","permalink":"http://zhouweicsu.github.io/blog/tags/Typography/"}]},{"title":"ã€Œè¯‘ã€å“ªäº›ç¼–ç¨‹è¯­è¨€æ˜¯å‡½æ•°å¼çš„ï¼Ÿ","date":"2016-03-09T16:00:00.000Z","path":"2016/03/10/which-programming-languages-are-functional/","text":"åœ¨æœ¬æ–‡çš„ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘æ²¡æœ‰ä»å­¦æœ¯è§’åº¦ï¼Œä¹Ÿæ²¡æœ‰ä»è¥é”€è§’åº¦ï¼Œè€Œæ˜¯ä»¥ä¸€ç§æ¬ç –ç å†œèƒ½çœ‹æ‡‚çš„æ–¹å¼ï¼Œè§£é‡Šäº†ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘å¸Œæœ›æˆ‘å¯¹å‰¯ä½œç”¨çš„å®šä¹‰ï¼Œèƒ½å¸®åŠ©æ¬ç –ç å†œæ›´è½»æ¾åœ°åœ¨åº”ç”¨ç¨‹åºå¤±æ§å‰æ‰¾åˆ°å®ƒä»¬ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ç°å®ä¸–ç•Œçš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å§â€¦ ç¼–ç¨‹é¢†åŸŸç›˜ç‚¹æœ‰äº†å¿«é€Ÿå®šä½å‰¯ä½œç”¨çš„æŠ€èƒ½ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸ªæŒ‡å®šå‡½æ•°å¹¶æŒ‡å‡ºå®ƒçš„éšè—å¤æ‚ä½“ã€‚æœ‰äº†å‡½æ•°å¼ç¼–ç¨‹çš„å®šä¹‰ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›˜ç‚¹ä¸€ä¸‹ç¼–ç¨‹é¢†åŸŸï¼Œåœ¨æ¯ä¸ªæ–¹å‘ä¸Šæå‡ºä¸€äº›æ–°è§‚ç‚¹â€¦ å‡½æ•°å¼ç¼–ç¨‹ä¸æ˜¯â€¦å®ƒä¸æ˜¯ map å’Œ reduceå³ä½¿ä½ çŸ¥é“å‡½æ•°å¼è¯­è¨€ä¸­éƒ½æœ‰è¿™äº›å‡½æ•°ï¼Œä½†å®ƒä»¬å¹¶ä¸æ˜¯å†³å®šè¯­è¨€æ˜¯å‡½æ•°å¼çš„å…³é”®ã€‚åªä¸è¿‡æ¯æ¬¡åœ¨ä½ è¯•å›¾ä»ä¸€ç³»åˆ—å¤„ç†ä¸­åˆ†ç¦»å¤æ‚æ€§æ—¶ï¼Œå®ƒä»¬éƒ½æ„å¤–åœ°å‡ºç°ç½¢äº†ã€‚ å®ƒä¸æ˜¯ Î» å‡½æ•°åŒæ ·ï¼Œä½ å¯èƒ½çŸ¥é“æ¯ä¸€ä¸ª FP(å‡½æ•°å¼ç¼–ç¨‹) è¯­è¨€éƒ½æ¨å´‡â€œå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘â€ã€‚ä½†å®ƒåªæ˜¯ä½ åˆ›å»ºä¸€é—¨é¿å…å‰¯ä½œç”¨è¯­è¨€çš„è‡ªç„¶äº§ç‰©ã€‚å®ƒæ˜¯ä¸€ä¸ªåŠ©æ¨å™¨ï¼Œä½†ä¸æ˜¯æ ¹æœ¬åŸå› ã€‚ å®ƒä¸æ˜¯ç±»å‹é™æ€ç±»å‹æ£€æµ‹æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œä½†å®ƒä¸æ˜¯ FP çš„å¿…å¤‡æ¡ä»¶ã€‚Lisp æ˜¯æœ€æ—©çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œä¹Ÿæ˜¯æœ€æ—©çš„åŠ¨æ€è¯­è¨€ã€‚ ä¸è¿‡é™æ€ç±»å‹éå¸¸æœ‰ç”¨ã€‚Haskell åœ¨å¯¹æŠ—å‰¯ä½œç”¨æ—¶éå¸¸ä¼˜é›…åœ°ä½¿ç”¨äº†ç±»å‹ç³»ç»Ÿã€‚ä½†å®ƒä»¬ä¸æ˜¯æ„æˆæˆ–ç ´åå‡½æ•°å¼è¯­è¨€çš„è¦ç´ ã€‚ ä¸€ç›´è¯´ï¼Œå¤§å£°è¯´ï¼Œå‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯è®¨è®ºå‰¯ä½œç”¨ã€‚ ï¼ˆå½“ç„¶ï¼Œä¹Ÿè®¨è®ºå‰¯åŸå› ã€‚ï¼‰ è¿™å¯¹äºè¯­è¨€æ¥è¯´æ„å‘³ç€ä»€ä¹ˆï¼ŸJavaScript ä¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å‡½æ•°å¼è¯­è¨€ä¼šå¸®ä½ æ¶ˆé™¤å‰¯ä½œç”¨ï¼Œä¸èƒ½æ¶ˆé™¤æ—¶ä¼šæ§åˆ¶å‰¯ä½œç”¨ã€‚JavaScript å¹¶ä¸ç¬¦åˆè¿™æ¡å‡†åˆ™ã€‚å®é™…ä¸Šï¼Œå¾ˆå®¹æ˜“å‘ç° JavaScript è®¸å¤šæ¨èä½¿ç”¨å‰¯ä½œç”¨çš„åœ°æ–¹ã€‚ æœ€æ˜æ˜¾çš„å°±æ˜¯ thisã€‚è¿™ä¸ªéšå«è¾“å…¥å­˜åœ¨æ¯ä¸€ä¸ªå‡½æ•°é‡Œã€‚ç‰¹åˆ«ä¸å¯æ€è®®çš„æ˜¯ this çš„å«ä¹‰æ”¹å˜çš„æ˜¯é‚£ä¹ˆä»»æ€§ã€‚å³ä½¿æ˜¯ JavaScript ä¸“å®¶ä¹Ÿä¼šåœ¨å®šä½ this å½“å‰æ‰€æŒ‡å¯¹è±¡æ—¶é‡åˆ°å›°éš¾ã€‚ä»å‡½æ•°å¼çš„è§’åº¦çœ‹ï¼Œthis çš„ç¥å‡ºé¬¼æ²¡åº”è¯¥ç®—è®¾è®¡ä¸Šçš„ä¸€ä¸ªè´¥ç¬”ã€‚ ä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨ JavaScript çš„å‡½æ•°å¼ç¼–ç¨‹åº“ï¼ˆä¾‹å¦‚ï¼ŒImmutable.jsï¼‰ï¼Œå®ƒå¯ä»¥è½»æ¾å°†ç¼–ç¨‹å˜æˆå‡½æ•°å¼é£æ ¼ï¼Œè€Œä¸ä¼šæ”¹å˜è¯­è¨€çš„æœ¬è´¨ã€‚ ï¼ˆé¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœä½ å–œæ¬¢è¿™ä¸ª JavaScript é¢†åŸŸå¤§å—æ¬¢è¿çš„ å‡½æ•°å¼åº“ï¼Œé‚£æƒ³è±¡ä¸€ä¸‹ä½ ä¼šå¤šå–œæ¬¢ä¸€é—¨å®Œå…¨æ”¯æŒå‡½æ•°å¼é£æ ¼çš„è¯­è¨€ã€‚ï¼‰ Java ä¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€Java ç»ä¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ã€‚Java 1.8 ç‰ˆæœ¬åŠ å…¥çš„é‚£äº› Î» å‡½æ•°ä¹Ÿä¸ä¼šæ”¹å˜è¿™ä¸ªäº‹å®ã€‚Java æ˜¯å®Œå…¨ç«™åœ¨å‡½æ•°å¼ç¼–ç¨‹çš„å¯¹ç«‹é¢ã€‚å®ƒçš„æ ¸å¿ƒè®¾è®¡åŸåˆ™è¡¨æ˜ï¼Œä»£ç åº”è¯¥ä»¥ä¸€ç³»åˆ—å‰¯ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯ä¾èµ–åŒæ—¶åˆä¼šæ”¹å˜å¯¹è±¡æœ¬åœ°çŠ¶æ€çš„æ–¹æ³•æ¥å®ç°ã€‚ äº‹å®ä¸Šï¼ŒJava å¯¹å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸å‹å¥½çš„ã€‚å¦‚æœä½ å†™äº†ä¸€æ®µæ— å‰¯ä½œç”¨çš„ Java ä»£ç ï¼Œè¿™æ®µä»£ç ä¸è¯»å–ä¹Ÿä¸æ”¹å˜ä»»ä½•æœ¬åœ°å¯¹è±¡çš„çŠ¶æ€ï¼Œé‚£ä½ å°±æ˜¯ä¸€ä¸ªç³Ÿç³•çš„ Java ç¨‹åºå‘˜ã€‚å› ä¸º Java ä»£ç ä¸åº”è¯¥é‚£ä¹ˆå†™å•Šã€‚æ— å‰¯ä½œç”¨çš„ä»£ç å°†ä¼šå¤„å¤„éƒ½æ˜¯ static å…³é”®å­—ï¼Œå…¶ä»–äººçœ‹äº†ä¹‹åä¼šçš±èµ·çœ‰å¤´ç„¶åæŠŠä½ èµ¶å‡ºå»ã€‚ æˆ‘ä¸æ˜¯è¯´ Java é”™äº†ã€‚ï¼ˆå‘ƒï¼Œå¥½å§ï¼Œæˆ‘å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚ï¼‰ä½†å…³é”®æ˜¯å®ƒå¯¹å‰¯ä½œç”¨çš„å¤ªå¯¹ä¸ FP å®Œå…¨ä¸åŒã€‚Java è®¤ä¸ºå±€éƒ¨å‰¯ä½œç”¨æ˜¯ä¼˜è´¨ä»£ç çš„åŸºçŸ³ï¼›è€Œ FP è®¤ä¸ºå®ƒä»¬æ˜¯é­”é¬¼ã€‚ ä½ å¯ä»¥ä»ç•¥å¾®ä¸åŒçš„è§’åº¦çœ‹å¾…è¿™ä¸ªäº‹æƒ…ã€‚ä½ å¯ä»¥æŠŠ Java å’Œ FP çœ‹åšè§£å†³å‰¯ä½œç”¨é—®é¢˜çš„ä¸¤ä¸ªä¸åŒç­”æ¡ˆã€‚ä¸¤ç§æ¨¡å¼éƒ½è®¤ä¸ºå‰¯ä½œç”¨æ˜¯ä¸ªé—®é¢˜ï¼Œåªæ˜¯è§£å†³æ–¹æ³•ä¸åŒã€‚é¢å‘å¯¹è±¡çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œâ€œå°†å®ƒä»¬åŒ…å«åœ¨è¢«ç§°ä¹‹ä¸ºâ€˜å¯¹è±¡â€™çš„èŒƒå›´å†…â€ï¼Œè€Œ FP çš„è§£å†³æ–¹æ¡ˆæ˜¯â€œæ¶ˆç­ä»–ä»¬â€ã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­ Java å¹¶ä¸ä»…ä»…è¯•å›¾å°è£…å‰¯ä½œç”¨ï¼›è¿˜åˆ©ç”¨å®ƒä»¬ã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨æœ‰çŠ¶æ€çš„å¯¹è±¡åˆ¶é€ å‰¯ä½œç”¨ï¼Œé‚£ä½ å°±æ˜¯ä¸€ä¸ªç³Ÿç³•çš„ Java ç¨‹åºå‘˜ã€‚ç»å¸¸å†™ static çš„äººå®é™…ä¸Šä¼šè¢«é±¿é±¼ã€‚ Scala èº«è´Ÿé‡ä»»å…¶å®ï¼ŒScala æ˜¯ä¸€ä¸ªéå¸¸æœ‰æŒ‘æˆ˜æ€§çš„å‘½é¢˜ã€‚å¦‚æœå®ƒçš„ç›®æ ‡æ˜¯ç»Ÿä¸€ OO å’Œ FP è¿™ä¸ªä¸¤ä¸ªä¸–ç•Œï¼Œé‚£ä¹ˆä»å‰¯ä½œç”¨æ¥çœ‹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒè¯•å›¾å¼¥åˆâ€œå¼ºåˆ¶æ€§å‰¯ä½œç”¨â€ä¸â€œç¦æ­¢å‰¯ä½œç”¨â€ä¹‹é—´çš„é¸¿æ²Ÿï¼ˆå¯¹ï¼Œæ­¤å¤„æˆ‘è¯´çš„ OO å°±æ˜¯æŒ‡ Javaï¼Œåœ¨ Scala è¿™ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘è®¤ä¸ºæŠŠä»–ä»¬åˆ’ä¸Šç­‰å·æ²¡æœ‰ä»€ä¹ˆä¸å¦¥ã€‚ï¼‰ã€‚è¿™ä¹ˆå¤šç›¸å¯¹çš„è§‚ç‚¹ï¼Œæˆ‘ä¸èƒ½ç¡®å®šå®ƒä»¬éƒ½èƒ½è¢«åŒ–è§£ã€‚ä»…é€šè¿‡è®©å¯¹è±¡æ”¯æŒ map å‡½æ•°æ˜¯ç»å¯¹ä¸èƒ½ç»Ÿä¸€è¿™ä¸¤è€…çš„ã€‚ä½ éœ€è¦æ›´æ·±å…¥å’Œåè°ƒå…³äºå‰¯ä½œç”¨çš„è¿™ä¸¤ä¸ªå¯¹ç«‹ç«‹åœºä¹‹é—´çš„å†²çªã€‚ Scala æ˜¯å¦æˆåŠŸåè°ƒç•™ç»™ä½ è‡ªå·±åˆ¤æ–­ã€‚ä½†å¦‚æœæˆ‘è´Ÿè´£æ¨å¹¿ Scalaï¼Œæˆ‘ä¼šæŠŠå®ƒçš„å–ç‚¹å®šä½ä¸ºä»Javaçš„å‰¯ä½œç”¨å‘çº¯ç²¹FPçš„ä¸€ä¸ªå¹³æ»‘è¿‡æ¸¡ã€‚ä¸å…¶ç»Ÿä¸€ä»–ä»¬ï¼Œä¸å¦‚è®©å®ƒæˆä¸ºä¸€æ¡æ¡¥æ¢ã€‚äº‹å®ä¸Šï¼Œè®¸å¤šäººåœ¨å®è·µä¸­éƒ½æ˜¯è¿™ä¹ˆè®¤ä¸ºçš„ã€‚ ClojureClojure å¯¹å‰¯ä½œç”¨çš„æ€åº¦å¾ˆæœ‰æ„æ€ã€‚å®ƒçš„å¼€å‘è€…ï¼ŒRich Hickeyï¼Œè¯´è¿‡ Clojure â€œ80% æ˜¯å‡½æ•°å¼çš„â€ã€‚æˆ‘æƒ³æˆ‘èƒ½è§£é‡Šä¸ºä»€ä¹ˆåªæœ‰ 80%ã€‚ä»ä¸€å¼€å§‹ï¼ŒClojure å°±è¢«è®¾è®¡ä¸ºè§£å†³ä¸€ä¸ªç‰¹å®šç±»å‹çš„å‰¯ä½œç”¨ï¼š æ—¶é—´ã€‚ ä¸¾ä¾‹è¯´æ˜ï¼Œè¿™é‡Œæœ‰ä¸ª Java ç¬‘è¯ï¼š 5 åŠ  2 ç­‰äºå¤šå°‘ï¼Ÿ 7ã€‚ ç­”å¯¹äº†ã€‚ 5 åŠ  3 ç­‰äºå¤šå°‘ï¼Ÿ 8ã€‚ é”™ã€‚ç­‰äº 10ï¼Œå› ä¸ºä¸Šä¸€æ­¥çš„ 5 å˜æˆ 7 äº†ï¼Œè¿˜è®°å¾—å—ï¼Ÿ å¥½å§ï¼Œè¿™ä¸æ˜¯å¾ˆå¥½ç¬‘ã€‚ä½†å…³é”®æ˜¯ï¼Œåœ¨ Java ä¸­ï¼Œå€¼ä¸ä¼šä¸€æˆä¸å˜ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ 5 èµ‹ç»™æŸä¸ªå€¼ï¼Œç„¶åè°ƒç”¨å‡½æ•°ï¼Œä½ ä¼šå‘ç°é‚£ä¸ªå€¼ä¸å†æ˜¯ 5 äº†ã€‚æ•°å­¦å‘Šè¯‰æˆ‘ä»¬ 5 æ°¸è¿œä¸å¯èƒ½æ”¹å˜â€”â€”æˆ‘ä»¬å¯ä»¥è°ƒç”¨å‡½æ•°è¿”å›ä¸€ä¸ªæ–°å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å¯èƒ½å½±å“æ•°å­— 5 çš„æœ¬è´¨ã€‚è€Œ Java å´è¯´å€¼ä¸€ç›´åœ¨å‘ç”Ÿç€å˜åŒ–ï¼Œé™¤éæŠŠå®ƒä»¬æ”¾åœ¨æŸä¸ªå¯¹è±¡é‡Œã€‚ è¿™ä¸ªæ•´æ•°çš„ä¾‹å­å¯èƒ½çœ‹ä¸å‡ºæ¥ä»€ä¹ˆï¼Œä½†é‡åˆ°æ›´å¤§çš„å€¼æ—¶å½±å“ä¹Ÿä¼šè¢«æ”¾å¤§ã€‚è¿˜è®°å¾—ç¬¬ä¸€éƒ¨åˆ†ä¸­ InboxQueue çš„ä¾‹å­å—ï¼Ÿ InboxQueue çš„çŠ¶æ€æ˜¯ä¸€ä¸ªéšç€æ—¶é—´å˜åŒ–çš„å€¼ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ—¶é—´å°±æ˜¯ InboxQueue çš„ä¸€ä¸ªå‰¯åŸå› ã€‚ Clojure ä¸€ç›´æ¶ç‹ ç‹ åœ°ç›¯ç€æ—¶é—´çš„å‰¯åŸå› ã€‚Rich Hickey çš„è§‚ç‚¹ï¼ˆæ‰€æœ‰è§‚ç‚¹ä¹‹ä¸€ï¼ï¼‰æ˜¯ï¼Œæ—¶é—´çš„éšå«å½±å“æ„å‘³ç€æˆ‘ä»¬æ— æ³•ä¾èµ–ä¸å˜çš„è¾“å…¥å€¼ï¼›å¦‚æœæˆ‘ä»¬ä¸èƒ½ä¾èµ–è¿™ä¸ªå€¼ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå°±ä¸èƒ½ä¾èµ–å‡½æ•°è¾“å…¥ï¼Œç»“æœå°±æ˜¯æˆ‘ä»¬æ— æ³•ä¾èµ–ä»»ä½•å¯é¢„è§çš„æˆ–é‡å¤çš„è¡Œä¸ºã€‚å¦‚æœè¿è¾“å…¥å€¼éƒ½æœ‰å‰¯ä½œç”¨ï¼Œé‚£ä¸€åˆ‡éƒ½ä¼šæœ‰å‰¯ä½œç”¨ã€‚å¦‚æœè¾“å…¥å€¼ä¸æ˜¯çº¯å‡€çš„ï¼Œé‚£ç¨‹åºé‡Œçš„ä»»ä½•ä¸œè¥¿éƒ½ä¸ä¼šçº¯å‡€ã€‚ æ‰€ä»¥ Clojure æ‹¿æ—¶é—´å¼€åˆ€äº†ã€‚å®ƒæ‰€æœ‰çš„å€¼é»˜è®¤éƒ½æ˜¯ä¸å¯å˜çš„ï¼ˆéšæ—¶é—´ä¸å¯å˜ï¼‰ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªå¯å˜å€¼ï¼ŒClojure æä¾›å¯¹ä¸å¯å˜å€¼çš„åŒ…è£…å™¨ï¼Œè¿™äº›åŒ…è£…å™¨çš„ä½¿ç”¨éƒ½æœ‰ç€ä¸¥æ ¼çš„é™åˆ¶ï¼š å¿…é¡»ä½¿ç”¨åŒ…è£…å™¨æ¥æ”¹å˜å€¼ã€‚ ä½ ä¸èƒ½ä¸çŸ¥ä¸è§‰åœ°åˆ›å»ºä¸€ä¸ªå¯å˜å€¼ã€‚ä½ å¿…é¡»ä½¿ç”¨ guards æ˜¾å¼åœ°æ ‡æ˜æ½œåœ¨çš„å‰¯ä½œç”¨ã€‚ ä½ ä¹Ÿä¸ä¼šä¸çŸ¥ä¸è§‰åœ°é”€æ¯ä¸€ä¸ªå¯å˜å€¼ã€‚ä½ å¿…é¡»ä½¿ç”¨ guards æ˜¾å¼åœ°å‘ŠçŸ¥å‰¯ä½œç”¨çš„é£é™©ã€‚ å½“ä½ æ‰“å¼€ä¸€ä¸ªå¯å˜å€¼çš„åŒ…è£…å™¨ï¼Œä½ å¾—åˆ°çš„ä¾ç„¶æ˜¯ä¸å¯å˜å€¼ã€‚è¿™æ ·å°±å¯ä»¥è½»æ¾æ‘†è„±ä¾èµ–æ—¶é—´çš„ç¯å¢ƒï¼Œè¿›å…¥ä¸€ä¸ªçº¯å‡€çš„ç¯å¢ƒã€‚ ä»æ—¶é—´çš„è§’åº¦çœ‹ï¼ŒClojure æ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸€ä¸ªæä½³çš„ä¾‹å­ã€‚è¿™ä¸ªè¯­è¨€å¼ºçƒˆæ•Œè§†æ—¶é—´å‰¯ä½œç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹å®ƒä¼šæ¶ˆé™¤å‰¯ä½œç”¨ï¼Œä½†å½“ä½ å¿…é¡»ä½¿ç”¨å‰¯ä½œç”¨æ—¶ï¼Œå®ƒå¸®ä½ ç‰¢ç‰¢çš„æ§åˆ¶å®ƒï¼Œé˜²æ­¢å‰¯ä½œç”¨æ±¡æŸ“å…¶ä»–çš„ç¨‹åºã€‚ Haskellå¦‚æœè¯´ Clojure åªæ˜¯æ•Œè§†æ—¶é—´ï¼Œé‚£ Haskell å°±æ˜¯æ˜æ˜¾çš„æ•Œæ„äº†ã€‚ä½† Haskell çœŸçš„ä¹Ÿå¾ˆè®¨åŒå‰¯ä½œç”¨ï¼Œä¸”èŠ±è´¹äº†å¤§é‡åŠªåŠ›æ¥æ§åˆ¶å®ƒä»¬ã€‚ Haskell ä¸å‰¯ä½œç”¨æ–—äº‰è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæ–¹å¼å°±æ˜¯ä½¿ç”¨ç±»å‹ã€‚å®ƒå°†æ‰€æœ‰çš„å‰¯ä½œç”¨éƒ½æ¨è¿›ç±»å‹ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ª getPerson çš„å‡½æ•°ã€‚åœ¨ Haskell ä¸­å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š 1getPerson :: UUID -&gt; Database Person ä½ å¯ä»¥æŠŠå®ƒè§£è¯»æˆï¼Œâ€œåœ¨ Database çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¼ å…¥ä¸€ä¸ª UUIDï¼Œè¿”å›ä¸€ä¸ª Person â€ã€‚è¿™å¾ˆæœ‰è¶£â€”â€”ä½ åªéœ€çœ‹ä¸€ä¸‹ Haskell å‡½æ•°çš„ç±»å‹ç­¾åå°±å¯ä»¥ç¡®å®šåŒ…å«äº†å“ªäº›å‰¯ä½œç”¨ï¼Œæ²¡åŒ…å«å“ªäº›å‰¯ä½œç”¨ã€‚ä½ ä¹Ÿå¯ä»¥åšå¦‚ä¸‹æ‹…ä¿ï¼Œâ€œè¯¥å‡½æ•°ä¸ä¼šè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œå› ä¸ºå®ƒæ²¡æœ‰ç”³æ˜é‚£ç§ç±»å‹çš„å‰¯ä½œç”¨ã€‚â€ä¸¥æ ¼æ§åˆ¶ï¼ˆPureScript è¿›ä¸€æ­¥é‡‡å–äº†è¿™ä¸ªæ€æƒ³ï¼Œè¿™ä¹Ÿæ˜¯å€¼å¾—ç ”ç©¶ï¼‰ã€‚ åŒæ ·çš„ï¼Œä½ å¯ä»¥çœ‹çœ‹å¦‚ä¸‹å‡½æ•°ï¼š 1formatName :: Person -&gt; String â€¦è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¼ å…¥ä¸€ä¸ª Personï¼Œè¿”å›ä¸€ä¸ª Stringã€‚æ²¡æœ‰åˆ«çš„äº†ï¼Œå› ä¸ºå¦‚æœå­˜åœ¨å‰¯ä½œç”¨ï¼Œä½ ä¼šçœ‹åˆ°å®ƒä»¬è¢«é”è¿›äº†ç±»å‹ç­¾åä¸­ã€‚ ä½†ä¹Ÿè®¸æœ€æœ‰è¶£çš„æ˜¯ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 1formatName :: Person -&gt; Database String è¿™ä¸ªç­¾åå‘Šè¯‰æˆ‘ä»¬ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„ formatName å‡½æ•°åŒ…å«æ•°æ®åº“ç›¸å…³çš„å‰¯ä½œç”¨ã€‚ä»€ä¹ˆé¬¼ï¼Ÿä¸ºä»€ä¹ˆ formatName å‡½æ•°éœ€è¦æ•°æ®åº“ï¼Ÿä½ çš„æ„æ€æ˜¯æˆ‘å°†éœ€è¦åˆå§‹åŒ–å’Œæ¨¡æ‹Ÿå‡ºä¸€ä¸ªæ•°æ®åº“å°±ä¸ºäº†æµ‹è¯•ä¸€ä¸ªåå­—æ ¼å¼å™¨ï¼Ÿè¿™çœŸçš„å¾ˆå¥‡æ€ªã€‚ ä»…ä»…é€šè¿‡å‡½æ•°ç­¾åï¼Œæˆ‘å°±çŸ¥é“è¿™ä¸ªå‡½æ•°è®¾è®¡çš„æœ‰é—®é¢˜ã€‚æˆ‘ä¸éœ€è¦æŸ¥çœ‹ä»£ç ï¼Œä»…ä»æ¦‚è§ˆå°±çŸ¥é“è¿™ä¸ªå‡½æ•°ä¸å¯¹åŠ²ã€‚å¤šä¹ˆç¥å¥‡ï¼ ç®€çŸ­åœ°ä¸ Java çš„ç­¾åå¯¹æ¯”ä¸€ä¸‹ï¼š 1public String formatName(Person person) &#123;..&#125; è¿™ä¸å“ªä¸ª Haskell ç‰ˆæœ¬ç­‰ä»·ï¼Ÿå¦‚æœä¸çœ‹å‡½æ•°ä½“ï¼Œä½ æ²¡æœ‰åŠæ³•çŸ¥é“ã€‚å®ƒä¹Ÿè®¸æ˜¯ä¸ªçº¯å‡€ç‰ˆï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šè®¿é—®æ•°æ®åº“ï¼Œè¿˜æœ‰å¯èƒ½ä¼šåˆ é™¤æ–‡ä»¶ç³»ç»Ÿç„¶åè¿”å›ï¼Œ=â€œå»ä½ çš„è€æ¿ï¼â€=ã€‚Java çš„ç±»å‹ç­¾åé‡Œå…³äºå‡½æ•°çš„åŠŸèƒ½ä¿¡æ¯å’Œè¡¨é¢ä¿¡æ¯éƒ½å¾ˆæœ‰é™ã€‚ ç›¸åï¼ŒHaskell çš„ç±»å‹ç­¾ååˆ™å‘Šè¯‰äº†ä½ å¾ˆå¤šå…³äºå‡½æ•°è®¾è®¡çš„ä¸œè¥¿ã€‚åˆå› ä¸ºå®ƒä»¬æ˜¯ç”±ç¼–è¯‘å™¨æ£€æŸ¥ï¼Œé‚£å®ƒä»¬å‘Šè¯‰ä½ çš„ä¸œè¥¿ä½ èƒ½ç¡®å®šéƒ½æ˜¯çœŸçš„ã€‚è¿™å°±æ„å‘³ç€å®ƒä»¬æ˜¯ä¸ªéå¸¸å¥½çš„æ¶æ„å·¥å…·ã€‚å®ƒä»¬èƒ½éå¸¸é«˜æ•ˆåœ°æš´éœ²è®¾è®¡ç¼ºé™·ï¼Œå®ƒä»¬ä¹Ÿèƒ½æš´éœ²ä»£ç æ¨¡å¼ã€‚æˆ‘ä¼šåœ¨æœ¬æ–‡ä¹‹å¤–ä¹Ÿä¼šç»§ç»­ä½¿ç”¨ â€œfunctorâ€ å’Œ â€œmonadâ€ï¼Œä½†æˆ‘ä¾ç„¶è®¤ä¸ºé«˜æ°´å‡†çš„è½¯ä»¶è®¾è®¡æ¨¡å¼é¦–å…ˆå¾—æœ‰é«˜æ°´å‡†çš„éœ€æ±‚åˆ†æï¼Œä½†å½“ä½ æœ‰ä¸€ä¸ªé«˜æ°´å‡†çš„ç¬¦å·ç³»ç»Ÿï¼Œé‚£é«˜æ°´å‡†çš„éœ€æ±‚åˆ†æä¹Ÿä¼šæ›´å®¹æ˜“ï¼ˆæˆ‘æœ‰ä¸€äº›ä¼Ÿå¤§çš„å…³äº Clojure çš„è®¾è®¡è®¨è®ºï¼Œåœ¨è¿™äº›è®¨è®ºä¸­æˆ‘ä»¬ä½¿ç”¨ Haskell ç­¾åæ¥è§£é‡Šæˆ‘ä»¬è‡ªå·±ï¼ŒéªŒè¯è®¾è®¡çš„ä¸€è‡´æ€§ï¼Œå¹¶æ€»ç»“æˆ‘ä»¬çš„ç»“è®ºã€‚æ˜¯çš„ï¼Œä½ æ²¡å¬é”™ï¼Œå°±æ˜¯ Clojure çš„è®¨è®ºã€‚Haskell çš„ç¬¦å·ç³»ç»Ÿå…·æœ‰è¿œè¶…è¯­è¨€æœ¬èº«çš„ä»·å€¼ã€‚ï¼‰ã€‚ PerlPerl åœ¨ä»»ä½•å…³äºå‰¯ä½œç”¨çš„è®¨è®ºä¸­éƒ½å€¼å¾—è¢«æåŠã€‚å› ä¸ºå®ƒæœ‰ä¸ªç¥å¥‡çš„å‚æ•°ï¼Œ$_ï¼Œè¯¥å‚æ•°æ˜¯â€œä¸Šä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„è¿”å›å€¼ï¼ˆæŸ¥çœ‹ man perlvar è·å–å‡†ç¡®å®šä¹‰ï¼‰ã€‚â€å®ƒè¢«è®¸å¤šæ ¸å¿ƒå‡½æ•°åº“éšå¼åœ°ä½¿ç”¨å’Œ/æˆ–æ”¹å˜ã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œè¿™è®© Perl æˆä¸ºäº†å”¯ä¸€çš„å°†å…¨å±€å‰¯ä½œç”¨å½“åšæ ¸å¿ƒç‰¹æ€§çš„è¯­è¨€ã€‚ Pythonæˆ‘ä»¬æ¥å¿«é€Ÿæµè§ˆä¸€ä¸‹ Java ä¸­ä¸€ä¸ªåŸºæœ¬çš„å‰¯ä½œç”¨æ¨¡å¼ï¼š123public String getName() &#123; return this.name;&#125; æˆ‘ä»¬å¦‚ä½•ä½¿è¿™ä¸ªè°ƒç”¨çº¯å‡€åŒ–ï¼Ÿå› ä¸ºï¼Œthis æ˜¯ä¸€ä¸ªéšå«è¾“å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†å®ƒä½œä¸ºä¸€ä¸ªå‚æ•°è¾“å…¥ï¼š123public String getName(Person this) &#123; return this.name;&#125; ç°åœ¨ getName æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ Python é»˜è®¤é€‰æ‹©äº†ç¬¬äºŒç§æ–¹å¼ã€‚åœ¨ Python ä¸­ï¼Œæ‰€æœ‰å¯¹è±¡æ–¹æ³•ä½¿ç”¨ this ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒæŒ‰ç…§æƒ¯ä¾‹ä¸€èˆ¬å†™æˆ self:12def getName(self): self.name æ˜¾å¼ç¡®å®ä¼˜äºéšå¼ã€‚ æ•°æ®æ¨¡æ‹Ÿæ•°æ®æ¨¡æ‹Ÿæ¡†æ¶ä¸€èˆ¬æ¥è¯´ä¼šåšä¸¤ä»¶äº‹æƒ…ã€‚ ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å¸®ä½ åˆå§‹åŒ–è¾“å…¥å¯¹è±¡ã€‚è¯­è¨€åˆå§‹åŒ–å¤æ‚å€¼æ—¶è¶Šå›°éš¾ï¼Œæ•°æ®æ¨¡æ‹Ÿè¶Šæœ‰ç”¨ã€‚ä½†è¿™ä¸é‡è¦ã€‚ ç¬¬äºŒä»¶äº‹æ‰æ˜¯æœ¬æ¬¡è®¨è®ºçš„é‡ç‚¹â€”â€”é€šè¿‡æµ‹è¯•ç»™å‡½æ•°åˆå§‹åŒ–æ­£ç¡®çš„å‰¯åŸå› ï¼Œæµ‹è¯•ä¹‹åæŸ¥çœ‹æ­£ç¡®çš„å‰¯ä½œç”¨æ˜¯å¦å‘ç”Ÿã€‚ é€šè¿‡å‰¯ä½œç”¨çš„è§†è§’ï¼Œæ•°æ®æ¨¡æ‹Ÿæ˜¯ä»£ç ä¸çº¯çš„ä¸€ä¸ªæ ‡å¿—ï¼Œåœ¨å‡½æ•°å¼ç¨‹åºå‘˜çš„çœ¼é‡Œï¼Œæ•°æ®æ¨¡æ‹Ÿå°±æ˜¯è¯æ˜æŸäº›äº‹æƒ…æ˜¯é”™è¯¯çš„ã€‚æˆ‘ä»¬åº”è¯¥æ¶ˆé™¤å‰¯ä½œç”¨ï¼Œè€Œä¸æ˜¯å»ä¸‹è½½ä¸€äº›åº“æ¥æ£€æŸ¥å®ƒçš„æ­£ç¡®æ€§ã€‚ ä¸€ä¸ªé“æ† TDD/Java å…„å¼Ÿæ›¾ç»é—®æˆ‘ï¼Œåœ¨ Clojure ä¸­å¦‚ä½•æ¨¡æ‹Ÿæ•°æ®ã€‚ç­”æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬ä¸æ¨¡æ‹Ÿã€‚å¦‚æœéœ€è¦æ¨¡æ‹Ÿæ•°æ®ï¼Œè¯´æ˜æˆ‘ä»¬éœ€è¦é‡æ„ä»£ç äº†ã€‚ è®¾è®¡ç¼ºé™·å¦‚æœæˆ‘æ˜¯å°é—´è°ï¼ˆI-Spyï¼‰å‡ºä¸€æœ¬å…³äºå‰¯ä½œç”¨çš„ä¹¦ï¼Œé‚£æœ€å®¹æ˜“æ‰¾åˆ°çš„ç›®æ ‡å°±æ˜¯æ— å‚æ•°è¾“å…¥çš„å‡½æ•°ï¼Œä¸æ— è¿”å›å€¼çš„å‡½æ•°ã€‚ æ²¡æœ‰å‚æ•°æ„å‘³ç€å‰¯åŸå› æ— è®ºä½•æ—¶ä½ çœ‹åˆ°ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„å‡½æ•°ï¼Œä»¥ä¸‹ä¸¤ä¸ªè¯´æ³•å®šæœ‰ä¸ªå¯¹çš„ï¼šè¦ä¹ˆå‡½æ•°æ˜¯æ€»è¿”å›ç›¸åŒçš„å€¼ï¼Œè¦ä¹ˆå‡½æ•°çš„è¾“å…¥æ¥è‡ªå…¶ä»–åœ°æ–¹ï¼ˆå‡½æ•°æœ‰å‰¯åŸå› ï¼‰ã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªå‡½æ•°å¿…é¡»å§‹ç»ˆè¿”å›ä¸€ä¸ªç›¸åŒçš„æ•´æ•°å€¼ï¼ˆå¦åˆ™å°±æœ‰å‰¯åŸå› ï¼‰ï¼š 1public Int foo() &#123;&#125; æ²¡æœ‰è¿”å›å€¼æ„å‘³ç€å‰¯ä½œç”¨æ— è®ºä½•æ—¶ä½ çœ‹åˆ°ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°è¦ä¹ˆæœ‰å‰¯ä½œç”¨ï¼Œè¦ä¹ˆè°ƒç”¨å®ƒå°±æ¯«æ— æ„ä¹‰ï¼š 1public void foo(...) &#123;...&#125; æ ¹æ®å‡½æ•°ç­¾åï¼Œç»å¯¹æ²¡æœ‰ç†ç”±å»è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å› ä¸ºå®ƒä¸ä¼šç»™ä½ ä»»ä½•ä¸œè¥¿ã€‚å”¯ä¸€è°ƒç”¨å®ƒçš„ç†ç”±å°±æ˜¯ï¼Œå®ƒä¼šæ‚„æ‚„åœ°åˆ¶é€ ä¸€äº›ç¥å¥‡çš„å‰¯ä½œç”¨ã€‚ æ¦‚è¦/æ€»ç»“å¯¹å‰¯ä½œç”¨çœŸæ­£çš„ï¼Œç›´è§‚çš„è®¤è¯†ï¼Œä¼šæ”¹å˜ä½ å¯¹å†™ç çš„çœ‹æ³•ã€‚ä¼šæ”¹å˜ä¸€åˆ‡ä½ å¯¹å•ç‹¬çš„å‡½æ•°ï¼Œç”šè‡³æ•´ä¸ªç³»ç»Ÿæ¶æ„çš„çœ‹æ³•ã€‚ä¼šæ”¹å˜ä½ è¯„åˆ¤ç¼–ç¨‹è¯­è¨€ï¼Œå·¥å…·å’Œç¼–ç¨‹æŠ€å·§çš„æ–¹å¼ã€‚å®ƒä¼šæ”¹å˜ä¸€åˆ‡ã€‚ä»ä»Šå¼€å§‹æ¶ˆç­å‰¯ä½œç”¨â€¦ åŸæ–‡é“¾æ¥ï¼šWhich Programming Languages Are Functional? è¯‘è€…ï¼šzhouweicsu","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"FP","slug":"FP","permalink":"http://zhouweicsu.github.io/blog/tags/FP/"},{"name":"Functional Programming","slug":"Functional-Programming","permalink":"http://zhouweicsu.github.io/blog/tags/Functional-Programming/"},{"name":"Clojure","slug":"Clojure","permalink":"http://zhouweicsu.github.io/blog/tags/Clojure/"},{"name":"Haskell","slug":"Haskell","permalink":"http://zhouweicsu.github.io/blog/tags/Haskell/"},{"name":"Python","slug":"Python","permalink":"http://zhouweicsu.github.io/blog/tags/Python/"},{"name":"Perl","slug":"Perl","permalink":"http://zhouweicsu.github.io/blog/tags/Perl/"}]},{"title":"ã€Œè¯‘ã€ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Ÿ","date":"2016-01-13T16:00:00.000Z","path":"2016/01/14/what-is-functional-programming/","text":"æœ¬æ–‡è®²çš„æ˜¯æˆ‘è®¤ä¸ºçš„å‡½æ•°å¼ç¼–ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œè¿™åº”è¯¥å¯¹äºæ¬ç –å†™ç ç»™åˆ«äººæ‰“å·¥ä¸€å¿ƒåªæƒ³å¿«ç‚¹æŠŠæ´»å¹²å®Œçš„ç å†œæ¥è¯´ï¼Œåº”è¯¥æ˜¯å¾ˆåˆé€‚çš„ã€‚ é¦–å…ˆæˆ‘å‘Šè¯‰ä½ ï¼Œä½ å†™çš„æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸¤ç»„è¾“å…¥å’Œä¸¤ç»„è¾“å‡ºã€‚ ä¸¤ä¸ªï¼Ÿåªæœ‰ä¸€ä¸ªå§ï¼Œä½ ç¡®å®šï¼Ÿ æ˜¯çš„ï¼Œä¸¤ä¸ªã€‚ç»å¯¹æ˜¯ä¸¤ä¸ªã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬ä¸€ä¸ªä¾‹å­ï¼š 12345public int square(int x) &#123; return x * x;&#125;// æ³¨æ„ï¼šå…¶å®ä»€ä¹ˆè¯­è¨€æ— æ‰€è°“ï¼Œä½†ä¸ºäº†å¼ºè°ƒï¼Œæˆ‘é€‰æ‹©äº†ä¸€ä¸ªæœ‰æ˜ç¡®çš„è¾“å…¥è¾“å‡ºç±»å‹çš„è¯­è¨€ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé€šå¸¸ä½ è®¤ä¸ºè¾“å…¥å°±æ˜¯int xï¼Œè¾“å‡ºä¹Ÿæ˜¯intã€‚ ä½†è¿™åªæ˜¯è¾“å…¥è¾“å‡ºçš„ç¬¬ä¸€ä¸ªé›†åˆã€‚å¦‚æœä½ æƒ³å«å®ƒä¼ ç»Ÿé›†åˆä¹Ÿå¯ä»¥ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹ç¬¬äºŒç»„è¾“å…¥è¾“å‡ºé›†åˆçš„ä¾‹å­ï¼š 1234567public void processNext() &#123; Message message = InboxQueue.popMessage(); if (message != null) &#123; process(message); &#125;&#125; ä»è¯­æ³•ä¸Šçœ‹ï¼Œè¿™ä¸ªå‡½æ•°æ—¢æ²¡æœ‰è¾“å…¥ä¹Ÿæ²¡æœ‰è¾“å‡ºï¼Œç„¶è€Œå¾ˆæ˜æ˜¾å®ƒä¾èµ–ç€ä»€ä¹ˆï¼Œå¹¶ä¸”å¾ˆæ˜¾ç„¶ä¹Ÿåœ¨åšç€ä»€ä¹ˆã€‚äº‹å®æ˜¯ï¼Œå®ƒæœ‰ä¸€ä¸ªéšå«çš„è¾“å…¥è¾“å‡ºé›†åˆã€‚è¿™ä¸ªéšå«çš„è¾“å…¥æ˜¯popMessage()å‡½æ•°è°ƒç”¨ä¹‹å‰IndexQueueçš„çŠ¶æ€ï¼Œéšå«çš„è¾“å‡ºæ˜¯processäº§ç”Ÿçš„ä»»ä½•ç»“æœï¼Œå†åŠ ä¸Šå‡½æ•°è¿è¡Œä¹‹åInboxQueueçš„çŠ¶æ€ã€‚ æ¯«æ— ç–‘é—® â€”â€” IndexQueueçš„çŠ¶æ€æ˜¯è¿™ä¸ªå‡½æ•°çœŸæ­£çš„è¾“å…¥ã€‚å¦‚æœä¸çŸ¥é“è¿™ä¸ªå€¼ï¼Œé‚£processNextçš„è¡Œä¸ºä¸å¯é¢„æµ‹ã€‚å¹¶ä¸”å®ƒä¹Ÿæ˜¯çœŸæ­£çš„è¾“å‡º â€”â€” å¦‚æœä¸è€ƒè™‘IndexQueueçš„æ–°çŠ¶æ€ï¼Œé‚£è°ƒç”¨ processNextä¹‹åçš„ç»“æœä¹Ÿä¸èƒ½è¢«å®Œå…¨ç†è§£ã€‚ æ‰€ä»¥ç¬¬äºŒæ®µä»£ç æœ‰éšå«çš„è¾“å…¥å’Œè¾“å‡ºã€‚å®ƒä¾èµ–ä¸€äº›å¤–éƒ¨è¾“å…¥ï¼Œä¹Ÿä¼šäº§ç”Ÿä¸€äº›ç»“æœï¼Œä½†æ˜¯å¦‚æœä½ åªçœ‹ APIï¼Œé‚£ä½ æ°¸è¿œçŒœä¸å¯¹å®ƒåœ¨å¹²ä»€ä¹ˆã€‚ è¿™äº›éšå«çš„è¾“å…¥å’Œè¾“å‡ºæœ‰ä¸€ä¸ªæ­£å¼çš„åå­—ï¼šâ€œå‰¯ä½œç”¨[side-effects]â€ã€‚å‰¯ä½œç”¨æœ‰å¾ˆå¤šç±»å‹ï¼Œä½†å®ƒä»¬æœ¬è´¨éƒ½ä¸€æ ·ï¼šâ€œå½“æˆ‘ä»¬è°ƒç”¨å‡½æ•°æ—¶ï¼Œå®ƒéœ€è¦çš„ä»€ä¹ˆä¸œè¥¿ä¸åœ¨å‚æ•°åˆ—è¡¨ä¸­ï¼Œå®ƒçš„è¿”å›å€¼é‡Œä½“ç°ä¸å‡ºå®ƒåšè¿‡ä»€ä¹ˆäº‹æƒ…ã€‚â€ ï¼ˆå®é™…ä¸Šæˆ‘è®¤ä¸ºæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ¦‚å¿µï¼šéšå«è¾“å‡ºçš„â€œå‰¯ä½œç”¨[side-effects]â€ï¼Œå’Œéšå«è¾“å…¥çš„â€œå‰¯åŸå› [side-causes]â€ã€‚ä¸ºäº†ç®€ä¾¿ï¼Œæ¥ä¸‹æ¥æœ¬æ–‡ä¼šä½¿ç”¨â€œå‰¯ä½œç”¨â€ï¼Œä½†æˆ‘ç»å¯¹ä¹Ÿåœ¨è®¨è®ºå‰¯åŸå› ã€‚æˆ‘åœ¨è®¨è®ºæ‰€æœ‰çš„éšå«è¾“å…¥å’Œè¾“å‡ºã€‚ï¼‰ å‰¯ä½œç”¨æ˜¯æ°´ä¸‹é¢çš„å†°å±±å½“å‡½æ•°æœ‰å‰¯ä½œç”¨ï¼ˆå’Œå‰¯åŸå› ï¼‰æ—¶ï¼Œå‡½æ•°çœ‹èµ·æ¥åƒè¿™æ ·ï¼š 1public boolean processMessage(Channel channel) &#123;...&#125; â€¦å¦‚æœä½ è‡ªä»¥ä¸ºçŸ¥é“å®ƒåœ¨å¹²ä»€ä¹ˆï¼Œé‚£å°±å¤§é”™ç‰¹é”™äº†ã€‚å¦‚æœä¸çœ‹å†…éƒ¨ä»£ç ï¼Œä½ æ ¹æœ¬å°±ä¸çŸ¥é“å®ƒéœ€è¦ä»€ä¹ˆï¼Œå®ƒä¼šäº§ç”Ÿä»€ä¹ˆç»“æœã€‚å®ƒä¼šä» channelï¼ˆé€šé“ï¼‰ä¸­å–å¾—ä¸€æ®µæ¶ˆæ¯ç„¶åå¤„ç†å®ƒå—ï¼Ÿå¯èƒ½ã€‚å¦‚æœæŸä¸ªæ¡ä»¶ä¸ºçœŸå®ƒä¼šå…³é—­ channel å—ï¼Ÿä¹Ÿè®¸ã€‚å®ƒä¼šåœ¨æ•°æ®åº“çš„æŸå¤„æ›´æ–°ä¸€ä¸ªæ•°å€¼å—ï¼Ÿæˆ–è®¸ä¼šã€‚å¦‚æœæ‰¾ä¸åˆ°å®ƒæœŸæœ›çš„æ—¥å¿—å­˜å‚¨è·¯å¾„å®ƒä¼šå´©æºƒå—ï¼Ÿå¯èƒ½ä¼šã€‚ å‰¯ä½œç”¨æ˜¯å¤æ‚çš„å†°å±±ã€‚ä½ çœ‹ç€å‡½æ•°ç­¾åä¸åå­—ï¼Œè®¤ä¸ºçŸ¥é“è¿™ä¸ªå‡½æ•°åœ¨å¹²å˜›ã€‚ä½†éšå«åœ¨å‡½æ•°ç­¾åçš„è¡¨é¢ä¹‹ä¸‹çš„ï¼Œæœ‰å¯èƒ½æ˜¯å…¶ä»–ä»»ä½•æ“ä½œã€‚ä»»ä½•éšå«çš„ä¾èµ–ï¼Œä»»ä½•éšå«çš„æ”¹å˜ã€‚ä¸çœ‹å…·ä½“çš„å®ç°ä»£ç ï¼Œä½ ä¸ä¼šçŸ¥é“å®ƒåˆ°åº•æ¶‰åŠäº†å“ªäº›æ“ä½œã€‚API çš„è¡¨é¢ä¹‹ä¸‹åˆæ˜¯å¦ä¸€ä¸ªæ½œåœ¨çš„å·¨å¤§å¤æ‚ä½“ã€‚å¦‚æœæƒ³è¦æŒæ§å®ƒï¼Œä½ åªæœ‰ä¸‰ä¸ªé€‰æ‹©ï¼šé€‰æ‹©ä¸€ï¼Œæ·±å…¥äº†è§£å‡½æ•°å®šä¹‰ï¼Œå°†é‡Œé¢çš„å¤æ‚ä½“æš´éœ²å‡ºæ¥ï¼›é€‰æ‹©äºŒï¼Œå¿½ç•¥å®ƒï¼Œç„¶åç¥ˆæ±‚å‡ºç°æœ€å¥½çš„ç»“æœï¼›é€‰æ‹©ä¸‰ï¼Œé€‰æ‹©äºŒé€šå¸¸æ˜¯ä¸ªä¸¥é‡çš„é”™è¯¯ã€‚ éš¾é“è¿™ä¸å°±æ˜¯æ‰€è°“çš„å°è£…å—ï¼Ÿä¸æ˜¯ã€‚ å°è£…æ˜¯éšè—å®ç°ç»†èŠ‚ã€‚éšè—è°ƒç”¨è€…ä¸éœ€è¦å…³å¿ƒçš„å†…éƒ¨ä»£ç ã€‚å°è£…æ˜¯ä¸ªå¥½çš„è®¾è®¡åŸåˆ™ï¼Œä½†è·Ÿæˆ‘ä»¬åˆšæ‰è¯´çš„éšå«çš„ä¸œè¥¿ä¸æ˜¯ä¸€å›äº‹ã€‚ å‰¯ä½œç”¨å¹¶ä¸æ˜¯â€œéšè—å®ç°ç»†èŠ‚â€â€”â€”è€Œæ˜¯éšè—äº†ä¸å‡½æ•°å¤–éƒ¨ç¯å¢ƒç›¸å…³çš„ä»£ç ã€‚ä¸€ä¸ªæœ‰å‰¯åŸå› çš„å‡½æ•°ï¼Œä¼šæœ‰è®¸å¤šæ‰¾ä¸åˆ°è¯´æ˜çš„å¤–éƒ¨ä¾èµ–ã€‚ä¸€ä¸ªæœ‰å‰¯ä½œç”¨çš„å‡½æ•°ï¼Œä¸ä¼šå‘Šè¯‰ä½ å®ƒå¯èƒ½ä¼šæ”¹å˜å“ªäº›å¤–éƒ¨å› ç´ ã€‚ å‰¯ä½œç”¨ä¸å¥½å—ï¼Ÿå½“å®ƒä»¬å®Œå…¨æŒ‰ç…§æœ€åˆç¨‹åºå‘˜çš„é¢„æœŸé‚£æ ·å·¥ä½œï¼Œå°±ä¸æ˜¯ä¸å¥½çš„ï¼Œä»–ä»¬å¯èƒ½ä¼šæ­£å¸¸å·¥ä½œã€‚ä½†è¿™æœ‰ä¸ªå‰æï¼šæˆ‘ä»¬å¿…é¡»ç›¸ä¿¡æœ€åˆç¨‹åºå‘˜çš„éšå«æœŸæœ›å€¼æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œå¹¶ä¸”éšç€æ—¶é—´çš„æ¨ç§»ä¾ç„¶æ­£ç¡®ã€‚ æˆ‘ä»¬æœ‰æ²¡æœ‰æŒ‰ç…§è¿™ä¸ªå‡½æ•°å½“åˆç¼–å†™æ—¶å¸Œæœ›çš„é‚£æ ·æ­£ç¡®åœ°åˆå§‹åŒ–ç¯å¢ƒçŠ¶æ€å‘¢ï¼Ÿåˆæˆ–è€…è¿™ä¸ªç¯å¢ƒæœ‰æ²¡æœ‰åœ¨æŸä¸ªåœ°æ–¹å·²ç»æ”¹å˜äº†å—ï¼Ÿä¹Ÿè®¸å› ä¸ºä¸€å°æ®µçœ‹ä¼¼æ— å…³çš„ä»£ç çš„æ”¹å˜ã€‚åˆæˆ–è€…æˆ‘ä»¬æŠŠå®ƒå®‰è£…åœ¨äº†ä¸€ä¸ªæ–°ç¯å¢ƒä¸­ã€‚å¯¹äºç¯å¢ƒçŠ¶æ€çš„éšå«å‡è®¾ï¼Œæ„å‘³ç€æˆ‘ä»¬é»˜è®¤äº†ä½¿ç¯å¢ƒå¦‚æ­¤è¿è¡Œçš„å¸Œæœ›ã€‚ æˆ‘ä»¬èƒ½æµ‹è¯•è¿™äº›ä»£ç å—ï¼Ÿç­”æ¡ˆæ˜¯æ— æ³•å•ç‹¬æµ‹è¯•ã€‚è¿™ä¸åƒç”µè·¯æ¿ï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•çš„ç»™å‡ºè¾“å…¥ç„¶åæ£€æŸ¥è¾“å‡ºã€‚æˆ‘ä»¬å¾—æ‰“å¼€ä»£ç ï¼Œæ‰¾å‡ºå®ƒéšå«çš„ä¾èµ–ä¸å½±å“ï¼Œç„¶åæ¨¡æ‹Ÿå®ƒæœ¬è¯¥å­˜åœ¨çš„å¤–éƒ¨ç¯å¢ƒã€‚æˆ‘å·²ç»è§è¯†è¿‡å¥½å‡ ä¸ªTDDâ€™ersï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘è€…ï¼‰åœ¨é»‘ç›’è¿˜æ˜¯ç™½ç›’æµ‹è¯•çš„é€‰æ‹©ä¹‹é—´å›¢å›¢è½¬äº†ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ï¼Œä½ åº”è¯¥åšé»‘ç›’æµ‹è¯•â€”â€”å¿½ç•¥å…·ä½“çš„å®ç°ç»†èŠ‚â€”â€”ä½†æ˜¯å¦‚æœä½ å…è®¸å‰¯ä½œç”¨çš„å­˜åœ¨ï¼Œé‚£å°±ä¸èƒ½åšé»‘ç›’æµ‹è¯•äº†ã€‚å‰¯ä½œç”¨å¯¹é»‘ç›’å½»åº•çš„å…³ä¸Šäº†å¤§é—¨ï¼Œå› ä¸ºå¦‚æœä¸æ‰“å¼€ç›’å­çœ‹çœ‹é‡Œé¢çš„ä»£ç ï¼Œä½ éƒ½ä¸çŸ¥é“è¾“å…¥å’Œè¾“å‡ºæ˜¯ä»€ä¹ˆã€‚ è¿™ä¸ªå½±å“åœ¨è°ƒè¯•çš„æ—¶å€™ä¼šæ›´å¤æ‚ã€‚å¦‚æœå‡½æ•°ä¸å…è®¸å‰¯ä½œç”¨ï¼ˆæˆ–å‰¯åŸå› ï¼‰ï¼Œé‚£ä½ å¯ä»¥é€šè¿‡ç»™å‡ºç‰¹å®šè¾“å…¥ç„¶åæ£€æŸ¥è¾“å‡ºç»“æœï¼Œè½»æ¾åˆ¤æ–­å‡½æ•°æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚ä½†å¦‚æœå‡½æ•°æœ‰å‰¯ä½œç”¨å‘¢ï¼Ÿé‚£ä½ å¿…é¡»è€ƒè™‘å¤šå°‘ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†å°±ä¸å¥½è¯´äº†ã€‚å°¤å…¶æ˜¯å½“å‡½æ•°ä»€ä¹ˆéƒ½å¯ä»¥ä¾èµ–ï¼Œä»€ä¹ˆç»“æœéƒ½å¯èƒ½å‡ºç°çš„æƒ…å†µä¸‹ï¼Œé‚£ä»»ä½•åœ°æ–¹éƒ½å¯èƒ½æœ‰ bugã€‚ è®©å‰¯ä½œç”¨æµ®å‡ºæ°´é¢å¯¹äºè¿™ä¸ªå¤æ‚ä½“æˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå—ï¼Ÿå½“ç„¶å¯ä»¥ã€‚å®é™…ä¸Šæ­¥éª¤ç›¸å½“ç®€å•ï¼šæŠŠå‡½æ•°çš„ä¾èµ–å˜æˆè¾“å…¥ï¼Œå£°æ˜å‡½æ•°çš„è¿”å›å¹¶å°†å®ƒå½“åšè¾“å‡ºã€‚å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚ æˆ‘ä»¬å†™ä¸ªä¾‹å­è¯•ä¸€ä¸‹ã€‚ä¸‹é¢æœ‰ä¸ªéšå«è¾“å…¥çš„å‡½æ•°ã€‚å¿«é€Ÿæ‰¾å‡ºå®ƒä½ å°±èƒ½å¾—åˆ°é¢å¤–å¥–åŠ±ï¼š 12345public Program getCurrentProgram(TVGuide guide, int channel) &#123; Schedule schedule = guide.getSchedule(channel); Program current = schedule.programAt(new Date()); return current;&#125; è¿™ä¸ªå‡½æ•°çš„éšå«è¾“å…¥å°±æ˜¯å½“å‰æ—¶é—´ï¼ˆnew Date()ï¼‰ã€‚æˆ‘ä»¬åªéœ€å°†è¿™ä¸ªæ—¶é—´å½“åšä¸€ä¸ªå‚æ•°è¾“å…¥å°±èƒ½å°†è¿™ä¸ªå¤æ‚çš„é—®é¢˜è§£å†³ï¼š 12345public Program getProgramAt(TVGuide guide, int channel, Date when) &#123; Schedule schedule = guide.getSchedule(channel); Program program = schedule.programAt(when); return program;&#125; å‡½æ•°ç°åœ¨æ²¡æœ‰éšå«çš„è¾“å…¥ï¼ˆå’Œè¾“å‡ºï¼‰ã€‚ æˆ‘ä»¬æ¥å¯¹æ¯”ä¸€ä¸‹è¿™ä¸ªæ–°ç‰ˆæœ¬çš„ä¼˜åŠ£ï¼š ç¼ºç‚¹çœ‹èµ·æ¥ä¼¼ä¹æ›´å¤æ‚äº†ã€‚æœ¬æ¥æ˜¯2ä¸ªå‚æ•°ï¼Œç°åœ¨å˜æˆäº†3ä¸ªã€‚ ä¼˜ç‚¹å‡½æ•°å¹¶æ²¡æœ‰å˜å¤æ‚ã€‚éšå«ä¸€ä¸ªä¾èµ–å¹¶æ²¡æœ‰ä½¿ä¹‹å˜å¾—æ›´ç®€å•ï¼Œå®äº‹æ±‚æ˜¯åœ°å†™å‡ºæ¥ä¹Ÿå¹¶æ²¡æœ‰ä½¿ä¹‹å˜å¾—æ›´å¤æ‚ã€‚ å®ƒè®©æµ‹è¯•å˜å¾—æ— æ¯”ç®€å•ã€‚æµ‹è¯•ä¸€å¤©çš„ä¸åŒæ—¶é—´ï¼Œæ—¶é’Ÿçš„å˜æ¢ï¼Œé—°å¹´ç­‰ç­‰ï¼Œéƒ½å¾ˆæ˜ç¡®ï¼Œå› ä¸ºå¯ä»¥ä¼ å…¥ä»»ä½•æƒ³è¦çš„æ—¶é—´å€¼ã€‚æˆ‘åœ¨äº§å“ä¸­è§è¿‡åŠ å‚æ•°ä¹‹å‰çš„ä»£ç ç‰ˆæœ¬ï¼Œè¿˜æœ‰ä¸ºäº†æµ‹è¯•æ–¹ä¾¿å¯¹ç³»ç»Ÿæ—¶é’Ÿçš„å„ç§æ¬ºéª—ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¤šå†™ä¸€å‚æ•°å¯ä»¥çœå¤šå¤§äº‹å•Šï¼ å¾ˆå®¹æ˜“å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šç°åœ¨å‡½æ•°ä»…ä»…æ˜¯æè¿°è¾“å…¥ä¸è¾“å‡ºä¹‹é—´çš„ä¸€ç§å…³ç³»ã€‚å¦‚æœä½ çŸ¥é“è¾“å…¥æ˜¯ä»€ä¹ˆï¼Œä½ å°±åº”è¯¥çŸ¥é“ç»“æœæ˜¯ä»€ä¹ˆï¼Œä½ å¯¹å‡½æ•°äº§ç”Ÿçš„ç»“æœäº†å¦‚æŒ‡æŒã€‚è¿™ä¸ªæ„ä¹‰é‡å¤§ã€‚ç°åœ¨å¯ä»¥ç‹¬ç«‹æµ‹è¯•ä»£ç äº†ã€‚æˆ‘ä»¬åªéœ€æµ‹è¯•è¾“å…¥ä¸è¾“å‡ºä¹‹é—´çš„å…³ç³»ï¼Œå°±å¯å®Œæˆæ•´ä¸ªå‡½æ•°çš„æµ‹è¯•äº†ã€‚ ï¼ˆå¦ä¸€æ–¹é¢ï¼Œå®ƒä¹Ÿå¾ˆæœ‰ç”¨ã€‚æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªå‡½æ•°ï¼Œè¿˜å¯ä»¥çŸ¥é“â€œä¸€ä¸ªå°æ—¶ä¹‹åä¼šæ’­æ”¾ä»€ä¹ˆèŠ‚ç›®â€ã€‚ï¼‰ ä»€ä¹ˆæ˜¯â€œçº¯å‡½æ•°â€ï¼Ÿæ­¤å¤„åº”è¯¥æœ‰æŒå£°ã€‚ ç»ˆäºï¼Œåœ¨æ¸…æ¥šåœ°çŸ¥é“éšå«è¾“å…¥ä¸è¾“å‡ºä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç»™å‡ºâ€œä¸€ä¸ªæ¬ç –ç å†œå¯¹çº¯å‡½æ•°çš„å®šä¹‰â€ï¼š ä¸€ä¸ªå‡½æ•°èƒ½ç§°ä¹‹ä¸ºâ€œçº¯â€å‡½æ•°ï¼Œåˆ™è¯¥å‡½æ•°æ‰€æœ‰çš„è¾“å…¥éƒ½æ˜¯æ˜¾ç¤ºçš„ï¼ˆæ— éšå«è¾“å…¥ï¼‰ï¼ŒåŒæ ·å®ƒçš„æ‰€æœ‰è¾“å‡ºéƒ½æ˜¯æ˜¾ç¤ºè¾“å‡ºã€‚ ç›¸åï¼Œè‹¥å‡½æ•°æœ‰éšå«è¾“å…¥æˆ–è¾“å‡ºï¼Œé‚£å®ƒå°±æ˜¯â€œä¸çº¯â€çš„ï¼Œè€Œå‡½æ•°ç»™æˆ‘ä»¬çš„åè®®å¹¶ä¸å®Œæ•´ã€‚å¤æ‚çš„å†°å±±éšéšå¯è§ã€‚æˆ‘ä»¬ç»ä¸èƒ½â€œå•ç‹¬â€ä½¿ç”¨ä¸çº¯çš„ä»£ç ã€‚æˆ‘ä»¬ä¹Ÿç»ä¸èƒ½å•ç‹¬æµ‹è¯•è¿™äº›ä»£ç ã€‚å› ä¸ºå®ƒæ€»æ˜¯ä¾èµ–åˆ«çš„ä¸œè¥¿ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™æµ‹è¯•æˆ–è°ƒè¯•ï¼Œéƒ½è¦è€ƒè™‘è¿™äº›ä¾èµ–ã€‚ ä»€ä¹ˆæ˜¯â€œå‡½æ•°å¼ç¼–ç¨‹â€ï¼Ÿåœ¨äº†è§£çº¯å‡½æ•°ä¸ä¸çº¯å‡½æ•°ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡ºâ€œä¸€ä¸ªæ¬ç –ç å†œå¯¹å‡½æ•°å¼ç¼–ç¨‹çš„å®šä¹‰â€ï¼š å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯ç¼–å†™çº¯å‡½æ•°ï¼Œå°½å¯èƒ½ç§»é™¤éšå«çš„è¾“å…¥ä¸è¾“å‡ºï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç å°±æ˜¯ä»…æè¿°è¾“å…¥ä¸è¾“å‡ºä¹‹é—´å…³ç³»çš„ä»£ç ã€‚ æˆ‘ä»¬æ¥å—æœ‰äº›å‰¯ä½œç”¨æ˜¯ä¸å¯é¿å…çš„â€”â€”å› ä¸ºè®¸å¤šç¨‹åºå°±æ˜¯ä¸ºäº†æ‰§è¡ŒæŸäº›æ“ä½œè€Œä¸æ˜¯è·å–è¿”å›å€¼ï¼Œä½†åœ¨æˆ‘ä»¬çš„ç¨‹åºé‡Œï¼Œæˆ‘ä»¬å°†ä¸¥æ ¼æ§åˆ¶å®ƒã€‚æˆ‘ä»¬ä¼šå°½æˆ‘ä»¬æ‰€èƒ½æ¶ˆé™¤å‰¯ä½œç”¨ï¼ˆå’Œå‰¯åŸå› ï¼‰ï¼Œå½“ä¸èƒ½æ¶ˆé™¤æ—¶ï¼Œæˆ‘ä»¬ä¼šä¸¥æ ¼æ§åˆ¶ã€‚ æˆ–è€…æ¢ä¸€ç§è¯´æ³•ï¼šä¸è¦éšå¼åœ°åŒ…å«ä»»ä½•ä¸€æ®µä»£ç éœ€è¦çš„ä»»ä½•ä¸œè¥¿ï¼Œä¹Ÿä¸è¦éšè—å®ƒå°†ä¼šäº§ç”Ÿçš„ä»»ä½•ç»“æœã€‚å¦‚æœä»£ç éœ€è¦æŸäº›ä¸œè¥¿æ‰èƒ½æ­£ç¡®æ‰§è¡Œï¼Œå°±è®©å®ƒæˆä¸ºè¾“å…¥å‚æ•°ã€‚å¦‚æœå‡½æ•°åšäº†ä»€ä¹ˆæœ‰ç”¨çš„äº‹æƒ…ï¼Œå£°æ˜å®ƒè®©å®ƒæˆä¸ºè¾“å‡ºã€‚å½“æˆ‘ä»¬è¿™ä¹ˆåšäº†ä¹‹åï¼Œæˆ‘ä»¬çš„ä»£ç å°†ä¼šéå¸¸æ¸…æ™°ã€‚å¤æ‚ä½“å°†ä¼šæµ®å‡ºæ°´é¢ï¼Œé‚£æ—¶æˆ‘ä»¬å°±èƒ½æ¶ˆé™¤æˆ–è€…å¤„ç†å®ƒã€‚ ä»€ä¹ˆæ˜¯â€œå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€â€ï¼Ÿæ¯ä¸€ç§è¯­è¨€éƒ½æ”¯æŒçº¯å‡½æ•°â€”â€”å¾ˆéš¾ä½¿å¾—add(x,y)ä¸çº¯ï¼ˆå¯¹ Java æ¥è¯´ï¼Œè¿˜æ˜¯å¾ˆéš¾ï¼‰ã€‚è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ‰€æœ‰çš„è¾“å…¥å’Œè¾“å‡ºæå‡åˆ°å‡½æ•°ç­¾åä¸­ï¼Œå°±èƒ½å°†ä¸€ä¸ªä¸çº¯çš„å‡½æ•°è½¬æ¢ä¸ºçº¯å‡½æ•°ï¼Œè¿™æ ·ç­¾åå°±èƒ½å®Œæ•´æè¿°è¯¥å‡½æ•°çš„è¡Œä¸ºã€‚é‚£æ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€éƒ½æ˜¯â€œå‡½æ•°å¼â€å—ï¼Ÿ å½“ç„¶ä¸æ˜¯ã€‚å¦‚æœæ˜¯é‚£ä¸ªè¯ä¸å°±æ¯«æ— æ„ä¹‰äº†ã€‚ é‚£æˆ‘ä»¬èƒ½ç»™å‡ºçš„â€œæ¬ç –ç å†œå¯¹å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„å®šä¹‰â€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å°±æ˜¯æ”¯æŒå’Œé¼“åŠ±ä¸ä½¿ç”¨å‰¯ä½œç”¨æ¥ç¼–ç¨‹çš„è¯­è¨€ã€‚ æ›´ç¡®åˆ‡çš„è¯´æ³•ï¼šå‡½æ•°å¼è¯­è¨€ä¼šå°½å¯èƒ½å¸®ä½ æ¶ˆé™¤å‰¯ä½œç”¨ï¼Œå½“ä¸èƒ½æ¶ˆé™¤æ—¶å°±ä¸¥æ ¼æ§åˆ¶ã€‚ æ›´ç”ŸåŠ¨çš„è¯´æ³•ï¼šå‡½æ•°å¼è¯­è¨€éå¸¸ä»‡è§†å‰¯ä½œç”¨ã€‚å‰¯ä½œç”¨æ˜¯å¤æ‚ä½“ï¼Œå¤æ‚ä½“æ˜¯ bugï¼Œbug å°±æ˜¯é­”é¬¼ã€‚å‡½æ•°å¼è¯­è¨€ä¹Ÿä¼šå¸®åŠ©ä½ ä»‡è§†å‰¯ä½œç”¨ã€‚ä½ ä»¬ä¸€èµ·å°±èƒ½æŠŠå‰¯ä½œç”¨æ•´å¾—æœæœå¸–å¸–ã€‚ å°±è¿™æ ·ï¼Ÿå¯¹ï¼Œå°±è¿™æ ·ã€‚æœ‰äº›ç»†å¾®ä¹‹å¤„â€”â€”ä½ ä¹‹å‰ä¹Ÿè®¸æ°¸è¿œéƒ½ä¸ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªéšè—è¾“å…¥çš„äº‹æƒ…ï¼Œä½†è¿™ä¸ªæ˜¯å…³é”®ã€‚æ„å»ºè½¯ä»¶ä¹‹å‰ï¼Œå¸¦ä¸Šâ€œå‰¯ä½œç”¨æ˜¯å¤´ç­‰æ•Œäººâ€çš„çœ‹æ³•ï¼Œå®ƒä¼šæ”¹å˜ä½ å¯¹ç¼–ç¨‹çš„ä¸€åˆ‡è®¤çŸ¥ã€‚æˆ³æˆ‘æŸ¥çœ‹ç¬¬äºŒç¯‡æ–‡ç« ï¼Œåœ¨å¯¹å‰¯ä½œç”¨ï¼Œå‡½æ•°å¼ç¼–ç¨‹æœ‰åˆæ­¥äº†è§£ä¹‹åï¼Œæ‹¿å‡ºæœºå…³æªå‘ç¼–ç¨‹é¢†åŸŸå¼€ä¸€æ¢­å­ï¼Œçœ‹çœ‹èƒ½æ‰“åˆ°è°ã€‚ è‡´è°¢æœ¬æ–‡æ˜¯å¯¹å‡½æ•°å¼ç¼–ç¨‹æœ¬è´¨çš„ä¸€ç³»åˆ—è®¨è®ºçš„æ€»ç»“ã€‚ç‰¹åˆ«æ˜¯ä¸ Sleepyfox å…³äºâ€œå¦‚æœä½¿ç”¨æ­£ç¡®çš„åº“ï¼ŒJavaScript æ˜¯å¦å¯ä»¥è¢«è®¤ä¸ºæ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€â€çš„è®¨è®ºã€‚æˆ‘çš„ç›´è§‰å½“ç„¶ä¸æ˜¯ï¼Œä½†é€šè¿‡æ€è€ƒâ€œä¸ºä»€ä¹ˆâ€ï¼Œæˆ‘èµ°å‘äº†ä¸€æ¡éå¸¸æœ‰ä»·å€¼çš„æ€è€ƒé“¾ã€‚ è·Ÿ James Henderson æ‰“ä¸ªæ‹›å‘¼ï¼Œä»–ä»Šå¹´è·Ÿæˆ‘çŒè¾“äº†è®¸å¤šå¾ˆæœ‰ä»·å€¼çš„å‡½æ•°å¼æ€æƒ³ã€‚ æ„Ÿè°¢ Malcolm Sparks, Ivan Uemlianin, Joel Clermont, Katy Moe å’Œæˆ‘çš„å½±åˆ†èº« Chris Jenkins å¯¹æœ¬æ–‡çš„æ ¡å¯¹ä¸æŒ‡å¯¼ã€‚ åŸæ–‡ï¼šWhat Is Functional Programming? è¯‘è€…ï¼šzhouweicsu","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"FP","slug":"FP","permalink":"http://zhouweicsu.github.io/blog/tags/FP/"},{"name":"Functional Programming","slug":"Functional-Programming","permalink":"http://zhouweicsu.github.io/blog/tags/Functional-Programming/"}]},{"title":"ã€Œè¯‘ã€2015 å¹´åº¦ JavaScript å¼€å‘è€…è°ƒæŸ¥ç»“æœ","date":"2015-12-16T16:00:00.000Z","path":"2015/12/17/javascript-developer-survey-results/","text":"å¹´å…³å°†è‡³ï¼ŒJavaScript å¼€å‘è€…é—®å·è°ƒæŸ¥ä¹Ÿå·²ç»ç»“æŸäº†ã€‚æœ¬æ¬¡è°ƒæŸ¥æ”¶åˆ°äº†è¶…å‡ºæˆ‘æƒ³è±¡çš„å›å¤ï¼Œæˆ‘ä¹Ÿå¾ˆé«˜å…´ä¸ä½ ä»¬åˆ†äº«è°ƒæŸ¥ç»“æœã€‚ æˆªè‡³ç›®å‰ï¼Œæœ‰è¶…è¿‡ 5000 äººå‚ä¸äº†é—®å·è°ƒæŸ¥ï¼Œå‡†ç¡®çš„è¯´æ˜¯ 5350 äººï¼Œæˆ‘çœŸçš„è¿«ä¸åŠå¾…æƒ³ä¸å¤§å®¶åˆ†äº«è¯¦ç»†è¿™æ¬¡è°ƒæŸ¥çš„ç»†èŠ‚ã€‚åˆ†äº«ä¹‹å‰å…ˆæ„Ÿè°¢å‚ä¸è°ƒæŸ¥çš„æ¯ä¸€ä¸ªäººã€‚è¿™æ˜¯ä¸€ä¸ª JavaScript ç¤¾åŒºçš„ä¼Ÿå¤§æ—¶åˆ»ï¼Œæˆ‘çœŸçš„å¯¹æœªæ¥çš„äº‹æƒ…æ„Ÿåˆ°æ— æ¯”æ¿€åŠ¨ã€‚ æˆ‘æ²¡æœ‰æƒ³åˆ°å¤§å®¶è¿™ä¹ˆç§¯æï¼Œä¸‹æ¬¡æˆ‘ä¸€å®šä¼šå¯¹è¡¨å•åšä¸€äº›æ”¹è¿›ã€‚ä¸‹æ¬¡æˆ‘ä¼šå…ˆå°†è°ƒæŸ¥é—®å·æ”¾åœ¨ GitHub ä¸Šï¼Œè¿™æ ·åœ¨è°ƒæŸ¥å¼€å§‹å‰ï¼Œç¤¾åŒºæœ‰ä¸€ä¸¤ä¸ªæ˜ŸæœŸçš„æ—¶é—´æ¥æ”¶é›†é—®é¢˜å’Œé€‰é¡¹ã€‚è¿™æ ·ï¼Œæˆ‘å°±å¯ä»¥å¾—åˆ°æ›´å‡†ç¡®åœ°ç»“æœï¼Œä¹Ÿå¯ä»¥é¿å…å‡ºç°â€œä½ ç«Ÿç„¶æ²¡æœ‰åŒ…å«Emacsï¼â€è¿™æ ·çš„æŠ±æ€¨ã€‚ ç°åœ¨ï¼ŒåŸºäºè°ƒæŸ¥ç»“æœã€‚æˆ‘å°†ä¿æŒä¸­ç«‹çš„ç»™å¤§å®¶åˆ†æç»“æœï¼Œè¿™æ ·å¤§å®¶å°±å¯ä»¥å¾—å‡ºè‡ªå·±çš„æ— åè§ç»“è®ºã€‚ 1ã€ä½ å†™ä»€ä¹ˆç±»å‹çš„ JavaScriptï¼Ÿæœ‰é«˜è¾¾ 97.4% çš„å—è®¿è€…ç”¨ JavaScript å†™ web æµè§ˆå™¨ç«¯ç¨‹åºï¼Œå…¶ä¸­æœ‰ 37% å†™ç§»åŠ¨ç«¯ Web åº”ç”¨ã€‚è¶…è¿‡ 3000 äººï¼ˆ56.6%ï¼‰ä¹Ÿä½¿ç”¨ JavaScript å†™æœåŠ¡ç«¯ã€‚åœ¨è¿™äº›å‚ä¸è°ƒæŸ¥çš„äººä¸­é—´ï¼Œæœ‰ 5.5% çš„äººè¿˜åœ¨ä¸€äº›åµŒå…¥å¼ç¯å¢ƒä¸­ä½¿ç”¨ JavaScriptï¼Œä¾‹å¦‚ Tessel æˆ– Raspberry Piï¼ˆæ ‘è“æ´¾ï¼‰ã€‚ å°‘æ•°å—è®¿è€…åé¦ˆä»–ä»¬è¿˜åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨äº† JavaScriptï¼Œä¸»è¦æœ‰ CLI å’Œæ¡Œé¢åº”ç”¨çš„å¼€å‘ã€‚è¿˜æœ‰å°‘æ•°æåˆ°äº† Pebble å’Œ Apple TVã€‚è¿™äº›éƒ½å½’ç±»åœ¨å…¶ä»–é€‰é¡¹ä¸­ï¼Œå æ€»ç¥¨æ•°çš„ 2.2%ã€‚ 2ã€ä½ åœ¨å“ªä½¿ç”¨ JavaScriptï¼Ÿä¸å‡ºæ‰€æ–™ï¼Œ94.9% çš„æŠ•ç¥¨è€…åœ¨å·¥ä½œä¸­ä½¿ç”¨ JavaScriptã€‚ä½†æ˜¯ï¼Œä¹Ÿæœ‰ 82.3% çš„æŠ•ç¥¨è€…åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨ã€‚å…¶ä»–å›å¤åŒ…æ‹¬æ•™å­¦ï¼Œå¥½ç©ï¼Œå’Œéç›ˆåˆ©ç›®çš„ä½¿ç”¨ã€‚ 3ã€ä½ å†™ JavaScript å¤šé•¿æ—¶é—´äº†ï¼Ÿè¶…è¿‡ 33% çš„å—è®¿è€…æœ‰è¶…è¿‡ 6 å¹´ JavaScript ä»£ç çš„ç¼–ç¨‹ç»éªŒã€‚é™¤äº†è¿™äº›ï¼Œè¿˜æœ‰ 5.2% çš„äºº 1 å¹´å‰å¼€å§‹å†™JavaScriptï¼Œ12.4% çš„äººæ˜¯ 2 å¹´å‰ï¼Œ15.1% çš„äººæ˜¯ 3 å¹´å‰ã€‚è¿™è¯´æ˜åœ¨ 5350 ä¸ªæŠ•ç¥¨è€…ä¸­æœ‰ 32.7% çš„äººæ˜¯è¿‘å‡ å¹´æ‰å¼€å§‹å†™ JavaScript çš„ã€‚ 4ã€å¦‚æœå¯ä»¥çš„è¯ï¼Œä½ ä¼šä½¿ç”¨ä»¥ä¸‹å“ªç§ compile-to-JavaScript è¯­è¨€ï¼Ÿæœ‰é«˜è¾¾ 85% çš„å—è®¿è€…è¡¨ç¤ºä»–ä»¬å°†ä½¿ç”¨ ES6 ç¼–è¯‘æˆ ES5ã€‚åŒæ—¶ä¾ç„¶æœ‰ 15% çš„äººç”¨ CoffeeScriptï¼Œ15.2% çš„äººç”¨ TypeScriptï¼Œåªæœ‰åŒºåŒº 1.1% çš„äººåœ¨ä½¿ç”¨ Dartã€‚ è¿™æ˜¯æˆ‘æƒ³è¿›ä¸€æ­¥æ¢è®¨çš„é—®é¢˜ä¹‹ä¸€ï¼Œå› ä¸ºæœ‰ 13% çš„äººé€‰æ‹©äº†â€œå…¶ä»–â€ã€‚é€‰æ‹©å…¶ä»–çš„ç»å¤§éƒ¨åˆ†ç­”æ¡ˆæ˜¯ ClojureScriptï¼Œemlï¼ŒFlowï¼Œå’Œ JSXã€‚ 5ã€ä½ ä¼šé€‰æ‹©ä»¥ä¸‹å“ªç§ JavaScript ç¼–ç¨‹é£æ ¼ï¼Ÿç»å¤§å¤šæ•°ï¼ˆ79.9%ï¼‰çš„ JavaScript å¼€å‘è€…åœ¨è¿™ä¸ªé—®é¢˜ä¸Šé€‰æ‹©åˆ†å·ã€‚ç›¸åï¼Œ11% çš„å¼€å‘è€…é€‰æ‹©ä¸ä½¿ç”¨åˆ†å·ã€‚é€—å·æ–¹é¢ï¼Œ44.9% çš„å¼€å‘è€…é€‰æ‹©å°†é€—å·æ”¾åœ¨è¡¨è¾¾å¼æœ«å°¾ï¼Œç„¶è€Œæœ‰ 4.9% çš„å¼€å‘è€…å–œæ¬¢å…ˆå†™é€—å·ã€‚ç¼©è¿›æ–¹é¢ï¼Œ65.5% çš„å¼€å‘è€…å–œæ¬¢ç©ºæ ¼ï¼Œå¦å¤– 29.1% çš„åˆ™æ›´å–œæ¬¢åˆ¶è¡¨ç¬¦ã€‚ 6ã€ä½ ä½¿ç”¨ä»¥ä¸‹å“ªäº› ES5 ç‰¹æ€§ï¼Ÿ79.2% çš„å—è®¿è€…éƒ½ä½¿ç”¨è¿‡æ•°ç»„åŠŸèƒ½å‡½æ•°ï¼Œ76.3% çš„å¼€å‘è€…ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œ30% çš„å¼€å‘è€…é€‰æ‹©äº† Object.creatï¼Œè€Œä»…æœ‰ 28% çš„å¼€å‘è€…é€‰æ‹© getters å’Œ settersã€‚ 7ã€ä½ ä½¿ç”¨ä»¥ä¸‹å“ªäº› ES6 ç‰¹æ€§ï¼Ÿå€¼å¾—æŒ‡å‡ºçš„æ˜¯ï¼ŒæŠ•ç¥¨è¡¨æ˜ç®­å¤´å‡½æ•°æ˜¯ä½¿ç”¨æœ€å¤šçš„ ES6 ç‰¹æ€§ï¼Œæœ‰ 79.6%ã€‚Let å’Œ const åŠ ä¸€èµ·ä¸€èµ·æœ‰77.8% çš„å¾—ç¥¨ç‡ï¼Œpromises ä¹Ÿæœ‰ 74.4% çš„å¼€å‘è€…é€‰æ‹©ã€‚ä¸å‡ºæ‰€æ–™ï¼Œä»…æœ‰ 4% çš„å‚ä¸è€…ä½¿ç”¨è¿‡ proxiesã€‚ä»…æœ‰ 13.1% çš„ç”¨æˆ·è¡¨ç¤ºä»–ä»¬ä½¿ç”¨ symbolsï¼ŒåŒæ—¶æœ‰è¶…è¿‡ 30% çš„äººä½¿ç”¨ iteratorsã€‚ 8ã€ä½ å†™æµ‹è¯•å—ï¼Ÿæœ‰ 21.7% çš„å¼€å‘è€…ä»ä¸å†™ä»»ä½•æµ‹è¯•ï¼Œå¤§éƒ¨åˆ†äººå¶å°”å†™æµ‹è¯•ï¼Œ34.8% çš„äººç»å¸¸å†™æµ‹è¯•ã€‚ 9ã€ä½ è¿è¡ŒæŒç»­é›†æˆæµ‹è¯•å—ï¼Ÿä¸ CI ç±»ä¼¼ï¼Œè®¸å¤šäººä¸ä½¿ç”¨ CI æœåŠ¡å™¨ï¼ˆè¶…è¿‡40%ï¼‰ã€‚ä½† 60% çš„å—è®¿è€…æœ‰æ—¶å€™ä¼šä½¿ç”¨ CIï¼Œæœ‰ 32% çš„äººåœ¨ CI æœåŠ¡å™¨ä¸Šè·‘æµ‹è¯•ã€‚ 10ã€ä½ æ€ä¹ˆæµ‹è¯•ï¼Ÿ59% çš„äººå–œæ¬¢ä½¿ç”¨ PhantomJS æˆ–ç±»ä¼¼å·¥å…·è¿è¡Œè‡ªåŠ¨åŒ–æµè§ˆå™¨æµ‹è¯•ï¼Œ51.3% çš„äººè¿˜åœ¨ Web æµè§ˆå™¨ä¸Šæ‰‹åŠ¨æµ‹è¯•ã€‚æœ‰ 53.6% çš„äººä¼šåœ¨æœåŠ¡ç«¯è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚ 11ã€ä½ ä½¿ç”¨è¿‡ä»¥ä¸‹å“ªä¸ªå•å…ƒæµ‹è¯•åº“ï¼Ÿä¼¼ä¹å¤§éƒ¨åˆ†æŠ•ç¥¨è€…é€‰æ‹©çš„ä¸æ˜¯ Mocha å°±æ˜¯ Jasmine æ¥è¿è¡Œ JavaScript æµ‹è¯•ç”¨ä¾‹ï¼ŒTape æœ‰ 9.8% çš„æŠ•ç¥¨ã€‚ 12ã€ä½ ä½¿ç”¨è¿‡ä»¥ä¸‹å“ªä¸ªä»£ç è´¨é‡æ£€æµ‹å·¥å…·ï¼Ÿä¼¼ä¹å—è®¿è€…åœ¨è¿™ä¸ªé—®é¢˜ä¸Šè¢«åˆ†ä¸º ESLint æ´¾å’Œ JSHint æ´¾ï¼Œä½†æ˜¯ JSLint è¿˜æœ‰å‡ ä¹ 30% çš„äººæ”¯æŒï¼Œè¿™ä¹ˆå¤šå¹´ä¾ç„¶åšæŒºå¾ˆæ˜¯ä»¤äººæƒŠå¥‡ã€‚ 13ã€ä½ æ˜¯å¦‚ä½•å¤„ç†å®¢æˆ·ç«¯ä¾èµ–é—®é¢˜ï¼Ÿnpm æ¥ç®¡äº†å®¢æˆ·ç«¯ä¾èµ–ç®¡ç†ç³»ç»Ÿçš„å¤©ä¸‹ï¼Œ60% çš„æ”¯æŒç‡å°±æ˜¯è¯æ®ã€‚Bower ä¾ç„¶æœ‰ 20% çš„è§‚ä¼—ï¼Œè€Œæ™®é€šçš„è€å¼ &lt;script&gt; ä¸‹è½½å’Œæ’å…¥åˆ™è·å¾—äº† 13.7% çš„é€‰ç¥¨ã€‚ 14ã€ä½ é¦–é€‰çš„è„šæœ¬æ„å»ºæ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæ„å»ºå·¥å…·çš„é€‰æ‹©å¾ˆåˆ†æ•£ï¼Œéƒ¨åˆ†åŸå› åº”è¯¥æ˜¯æˆ‘ä»¬æœ‰å¤ªå¤šé€‰æ‹©ã€‚Gulp æœ€æµè¡Œï¼Œæœ‰è¶…è¿‡ 40% çš„é€‰ç¥¨ã€‚ç´§æ¥ç€æ˜¯ 27.8% çš„ npm runï¼ŒGrunt æœ‰ 18.5% çš„æ”¯æŒè€…ã€‚ 15ã€ä½ é¦–é€‰çš„ JavaScript æ¨¡å—åŠ è½½å·¥å…·æ˜¯ä»€ä¹ˆï¼Ÿç›®å‰ï¼Œä¼¼ä¹å¤§éƒ¨åˆ†å¼€å‘è€…éƒ½åœ¨ Browserify å’Œ Webpack ä¹‹é—´å¾˜å¾Šï¼Œè€Œåè€…é«˜å‡º 7 ä¸ªç™¾åˆ†ç‚¹ã€‚29% çš„ç”¨æˆ·è¡¨ç¤ºä»–ä»¬åœ¨é€‰æ‹©å‰é¢ä¸¤ä¸ªæåˆ°çš„å·¥å…·æ‰“åŒ…æ¨¡å—ä¹‹å‰ï¼Œä¼šå…ˆä½¿ç”¨ Babelã€‚ 16ã€ä½ ä½¿ç”¨ä»¥ä¸‹å“ªäº›åº“ï¼Ÿç°åœ¨å›æƒ³èµ·æ¥ï¼Œè¿™æ˜¯ä¸ªå¾—ç›ŠäºååŒç¼–è¾‘çš„é—®é¢˜ä¹‹ä¸€ã€‚jQuery å¾—åˆ°äº†è¶…è¿‡ 50% çš„æ”¯æŒï¼Œè¡¨ç°ä¾ç„¶å¼ºåŠ¿ã€‚Lodash ä¸ Underscore åœ¨å‚ä¸æŠ•ç¥¨çš„ JavaScript ä½¿ç”¨è€…ä¸­ä¹Ÿå æ®æ˜¾è‘—åœ°ä½ï¼ŒXHR å¾®å‹åº“ä»…è·å¾—äº† 8% çš„ç¥¨æ•°ã€‚ 17ã€ä½ ä½¿ç”¨ä»¥ä¸‹å“ªäº›æ¡†æ¶ï¼ŸReact å’Œ Angular çš„é¥é¥é¢†å…ˆå¹¶ä¸ä»¤äººå¥‡æ€ªã€‚æœ‰ 22.8% å¾—ç¥¨çš„ Backbone ä¾ç„¶å¤„äºå®‰å…¨ä½ç½®ã€‚ 18ã€ä½ ä½¿ç”¨ ES6 å—ã€‚ã€‚ã€‚è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ¯”è¾ƒåˆ†æ•£ï¼Œæœ‰è¿‘ 20% çš„äººå‡ ä¹ä»ä¸ä½¿ç”¨ ES6ï¼Œè¶…è¿‡ 10% çš„äººåªå†™ ES6ï¼Œè¿‘ 30% çš„äººå¹¿æ³›ä½¿ç”¨ï¼Œè¿‘ 40% çš„äººç»å¸¸ä½¿ç”¨ã€‚ 19ã€ä½ çŸ¥é“ ES2016 ä¼šæœ‰ä»€ä¹ˆç‰¹æ€§å—ï¼Ÿå¤§è‡´è¯´æ¥ï¼Œæœ‰ä¸€åŠçš„æŠ•ç¥¨è€…ä¸çŸ¥é“ ES2016 å°†ä¼šæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Œå¦å¤–ä¸€åŠå¯¹æ–°ç‰¹æ€§æœ‰æ‰€äº†è§£ã€‚ 20ã€ä½ äº†è§£ ES6 å—ï¼Ÿè¶…è¿‡ 60% çš„å—è®¿è€…äº†è§£åŸºæœ¬çš„æ¦‚å¿µï¼Œ10% çš„äººå®Œå…¨ä¸äº†è§£ ES6ï¼Œæœ‰è¶…è¿‡ 25% çš„äººè®¤ä¸ºä»–ä»¬å¯¹ ES6 éå¸¸äº†è§£ã€‚ 21ã€ä½ è®¤ä¸º ES6 æ˜¯ä¸€ä¸ªè¿›æ­¥å—ï¼Ÿå‡ ä¹æœ‰ 95% çš„å—è®¿è€…è®¤ä¸º ES6 æ˜¯ JavaScript çš„ä¸€ä¸ªè¿›æ­¥ã€‚ä¸‹æ¬¡ç¢°åˆ° TC39 çš„ä¼šå‘˜æˆ‘å¾—ç¥è´ºä»–ä»¬ï¼ 22ã€ä½ é¦–é€‰çš„ç¼–è¾‘å™¨æ˜¯ä»€ä¹ˆï¼Ÿåˆä¸€æ¬¡ï¼Œå› ä¸ºé€‰æ‹©å¤ªå¤šå¯¼è‡´ç­”æ¡ˆå¾ˆåˆ†æ•£ã€‚è¶…è¿‡ä¸€åŠçš„å—è®¿è€…å–œæ¬¢ Sublime Textï¼Œè¶…è¿‡ 30% çš„äººå–œæ¬¢ç”¨ Atom å’Œå®ƒçš„å¼€æºå…‹éš†ç‰ˆã€‚è¶…è¿‡ 25% çš„ç¥¨æŠ•ç»™äº† WebStormï¼Œvi/vim ä¹Ÿæœ‰è¶…è¿‡ 25% çš„å¾—ç¥¨ç‡ã€‚ 23ã€ä½ é¦–é€‰çš„å¼€å‘æ“ä½œç³»ç»Ÿæ˜¯ä»€ä¹ˆï¼Ÿ Mac æœ‰è¶…è¿‡ 60% çš„æŠ•ç¥¨è€…ä½¿ç”¨ï¼ŒLinux å’Œ Windows çš„ç”¨æˆ·éƒ½æ¥è¿‘ 20%ã€‚ 24ã€ä½ å¦‚ä½•æœç´¢å¯é‡ç”¨ä»£ç ï¼Œåº“å’Œå·¥å…·ï¼Ÿå—è®¿è€…æœ€å–œæ¬¢ Github å’Œæœç´¢å¼•æ“ï¼Œä½†é€šè¿‡åšå®¢ï¼ŒTwitter å’Œ npm ç½‘ç«™æœç´¢ä¹Ÿå äº†å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ 25ã€ä½ å‚åŠ  JavaScript ç¤¾ä¼šæ´»åŠ¨å—ï¼Ÿæœ‰è¿‘ 60% çš„äººè‡³å°‘å‚åŠ è¿‡ä¸€æ¬¡ä¼šè®®ï¼Œ74% çš„äººè¡¨ç¤ºä»–ä»¬å–œæ¬¢å‚åŠ èšä¼šã€‚ 26ã€ä½ çš„ JavaScript åº”ç”¨æ”¯æŒå“ªäº›æµè§ˆå™¨ï¼Ÿç›¸å½“åˆ†æ•£çš„ç­”æ¡ˆï¼Œä½†è¿˜å¥½å¤§éƒ¨åˆ†å—è®¿è€…ä¸å†è€ƒè™‘ IE6 çš„ä½¿ç”¨è€…äº†ã€‚ 27ã€ä½ ä¼šå®šæœŸäº†è§£ JavaScript çš„æœ€æ–°ç‰¹æ€§å—ï¼Ÿæœ‰å¤§æ¦‚ 80% çš„å—è®¿è€…ä¼šå®æ—¶äº†è§£æœ€æ–°çš„ JavaScript ç‰¹æ€§ã€‚ 28ã€ä½ åœ¨å“ªäº†è§£æœ€æ–°çš„ JavaScript ç‰¹æ€§ï¼Ÿä¸å‡ºæ‰€æ–™ï¼ŒMozilla å¼€å‘è€…ç½‘ç»œåœ¨æ–‡æ¡£å’Œæ–°é—»æ–¹é¢å¤„äºé¢†å…ˆåœ°ä½ã€‚JavaScript å‘¨åˆŠä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ–°é—»å’Œæ–‡ç« çš„ç›´æ¥æ¥æºï¼Œæœ‰è¶…è¿‡ 40% çš„æ”¯æŒç‡ã€‚ 29ã€ä½ å¬è¯´è¿‡ä»¥ä¸‹å“ªäº›ç‰¹æ€§ï¼Ÿè¶…è¿‡ 85% çš„æŠ•ç¥¨è€…å¬è¯´è¿‡ ServiceWorkerï¼Œä½†æˆ‘å¾ˆæƒ³çŸ¥é“è¿™äº›äººæœ‰æ²¡æœ‰ä½¿ç”¨å®ƒï¼ 30ã€é™¤äº† JavaScriptï¼Œä½ è¿˜ä¸»è¦ä½¿ç”¨å“ªäº›è¯­è¨€ï¼Ÿæœ‰å¤ªå¤šçš„è¯­è¨€å¯ä¾›é€‰æ‹©ï¼Œæˆ‘è‚¯å®šä¼šæ¼é‚£ä¹ˆå‡ ä¸ªï¼Œä½†ç»“æœä¸è¨€è‡ªæ˜ã€‚ è°¢è°¢ï¼ æœ€åï¼Œæ„Ÿè°¢æ¯ä¸€ä½å‚ä¸è¿™æ¬¡è°ƒæŸ¥çš„äººã€‚æœ¬æ¬¡é—®å·è°ƒæŸ¥å—åˆ°äº†è¶…å‡ºæˆ‘é¢„æœŸçš„æ¬¢è¿ï¼ŒæœŸå¾…æ˜å¹´å†è¿›è¡Œä¸€æ¬¡ç±»ä¼¼çš„è°ƒæŸ¥ã€‚æˆ‘å¸Œæœ›ï¼Œé‚£ä¼šæ˜¯ä¸€ä¸ªæ›´å¤šæ ·æ€§ï¼Œä¹Ÿè®¸å†å°‘ä¸€ç‚¹åè§çš„è°ƒæŸ¥ã€‚ è¿™æ¬¡é—®å·è°ƒæŸ¥ä½ è·å¾—äº†ä»€ä¹ˆï¼Ÿ ä½œè€…ï¼šNicolÃ¡s Bevacquaï¼Œæ—¶é—´ï¼š2015-12-11 åŸæ–‡é“¾æ¥: https://ponyfoo.com/articles/javascript-developer-survey-results è¯‘è€…ï¼šzhouweicsu","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"è°ƒæŸ¥","slug":"è°ƒæŸ¥","permalink":"http://zhouweicsu.github.io/blog/tags/è°ƒæŸ¥/"}]},{"title":"ã€Œè¯‘ã€ECMAScript 2016 (ES7) æ–°ç‰¹æ€§ä¸€è§ˆ","date":"2015-12-03T16:00:00.000Z","path":"2015/12/04/tc39-process/","text":"æœ¬æ–‡å›ç­”äº†å…³äºä¸‹ä¸€ç‰ˆ JavaScriptï¼ˆECMAScript 2016ï¼‰çš„ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š è°åœ¨è®¾è®¡ï¼Ÿ å¦‚ä½•è®¾è®¡ï¼Ÿ ä¼šæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿ æœ¬æ–‡ä¼šæŒç»­æ›´æ–°ä»¥åŠæ—¶åé¦ˆæœ€æ–°è¿›å±•ã€‚ 1ã€è°åœ¨è®¾è®¡ ECMAScriptï¼Ÿç­”ï¼šTC39 (Technical Committee 39)ã€‚ TC39 æ˜¯æ¨è¿› JavaScript å‘å±•çš„å§”å‘˜ä¼šã€‚å…¶ä¼šå‘˜éƒ½æ˜¯å…¬å¸ï¼ˆå…¶ä¸­ä¸»è¦æ˜¯æµè§ˆå™¨å‚å•†ï¼‰ã€‚TC39 å®šæœŸå¬å¼€ä¼šè®®ï¼Œä¼šè®®ç”±ä¼šå‘˜å…¬å¸çš„ä»£è¡¨ä¸ç‰¹é‚€ä¸“å®¶å‡ºå¸­ã€‚ä¼šè®®çºªå½•éƒ½å¯åœ¨ç½‘ä¸ŠæŸ¥çœ‹ï¼Œå¯ä»¥è®©ä½ å¯¹ TC39 å¦‚ä½•å·¥ä½œæœ‰ä¸€ä¸ªæ¸…æ™°çš„æ¦‚å¿µã€‚ æœ‰æ—¶å€™ï¼ˆå®é™…ä¸Šæœ¬æ–‡å°±å¦‚æ­¤ï¼‰ï¼Œä½ ä¼šå‘ç° TC39 ä¼šå‘˜è¿™ä¸ªè¯è¢«ç”¨æ¥æŒ‡ä»£ä¸€ä¸ªäººï¼Œå…¶å®æŒ‡çš„æ˜¯ TC39 ä¼šå‘˜å…¬å¸æ´¾å‡ºçš„ä»£è¡¨ã€‚ å¾ˆæœ‰æ„æ€çš„æ˜¯ï¼ŒTC39 å®è¡Œçš„æ˜¯åå•†ä¸€è‡´çš„åŸåˆ™ï¼šé€šè¿‡ä¸€é¡¹å†³è®®å¿…é¡»å¾—åˆ°æ¯ä¸€ä½ä¼šå‘˜ï¼ˆå…¬å¸ä»£è¡¨ï¼‰çš„èµæˆã€‚ 2ã€å¦‚ä½•è®¾è®¡ ECMAScriptï¼Ÿ2.1 é—®é¢˜ï¼šECMAScript 2015 (ES6) è¿™ä¸ªç‰ˆæœ¬å¤ªå¤§äº†æœ€è¿‘å‘å¸ƒçš„ ECMAScriptï¼ˆES6ï¼‰æ–°å¢å†…å®¹å¾ˆå¤šï¼Œåœ¨ ES5 å‘å¸ƒè¿‘ 6 å¹´ï¼ˆ2009-11 è‡³ 2015-6ï¼‰ä¹‹åæ‰å°†å…¶æ ‡å‡†åŒ–ã€‚ä¸¤ä¸ªå‘å¸ƒç‰ˆæœ¬ä¹‹é—´æ—¶é—´è·¨åº¦å¦‚æ­¤ä¹‹å¤§ä¸»è¦æœ‰ä¸¤å¤§åŸå› ï¼š æ¯”æ–°ç‰ˆç‡å…ˆå®Œæˆçš„ç‰¹æ€§ï¼Œå¿…é¡»ç­‰å¾…æ–°ç‰ˆçš„å®Œæˆæ‰èƒ½å‘å¸ƒã€‚ é‚£äº›éœ€è¦èŠ±é•¿æ—¶é—´å®Œæˆçš„ç‰¹æ€§ï¼Œä¹Ÿé¡¶ç€å¾ˆå¤§çš„å‹åŠ›è¢«çº³å…¥è¿™ä¸€ç‰ˆæœ¬ï¼Œå› ä¸ºå¦‚æœæ¨è¿Ÿåˆ°ä¸‹ä¸€ç‰ˆæœ¬å‘å¸ƒæ„å‘³ç€åˆè¦ç­‰å¾ˆä¹…ï¼Œè¿™ç§ç‰¹æ€§ä¹Ÿä¼šæ¨è¿Ÿæ–°çš„å‘å¸ƒç‰ˆæœ¬ã€‚ å› æ­¤ï¼Œä» ECMAScript 2016ï¼ˆES7ï¼‰å¼€å§‹ï¼Œç‰ˆæœ¬å‘å¸ƒå°†ä¼šå˜å¾—æ›´åŠ é¢‘ç¹ï¼Œæ¯å¹´å‘å¸ƒä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œè¿™ä¹ˆä¸€æ¥æ–°å¢å†…å®¹ä¹Ÿä¼šæ›´å°ã€‚æ–°ç‰ˆæœ¬å°†ä¼šåŒ…å«æ¯å¹´æˆªæ­¢æ—¶é—´ä¹‹å‰å®Œæˆçš„æ‰€æœ‰ç‰¹æ€§ã€‚ 2.2 è§£å†³æ–¹æ¡ˆï¼š TC39 è®¾è®¡è¿‡ç¨‹æ¯ä¸ª ECMAScript ç‰¹æ€§çš„å»ºè®®å°†ä¼šä»é˜¶æ®µ 0 å¼€å§‹ï¼Œ ç„¶åç»è¿‡ä¸‹åˆ—å‡ ä¸ªæˆç†Ÿé˜¶æ®µã€‚å…¶ä¸­ä»ä¸€ä¸ªé˜¶æ®µåˆ°ä¸‹ä¸€ä¸ªé˜¶æ®µå¿…é¡»ç»è¿‡ TC39 çš„æ‰¹å‡†ã€‚ é˜¶æ®µ 0ï¼š Strawman åˆç¨¿ä»€ä¹ˆæ˜¯ Strawmanï¼Ÿä¸€ä¸ªæ¨è¿› ECMAScript å‘å±•çš„è‡ªç”±å½¢å¼çš„æƒ³æ³•ã€‚è¯¥æƒ³æ³•å¿…é¡»ç”± TC39 çš„ä¼šå‘˜æäº¤ï¼Œå¦‚æœæ˜¯éä¼šå‘˜åˆ™å¿…é¡»æ³¨å†Œæˆä¸º TC39 è´¡çŒ®è€…æ‰èƒ½æäº¤ã€‚ å¿…å¤‡æ¡ä»¶ï¼šæ–‡ä»¶å¿…é¡»åœ¨ TC39 çš„ä¼šè®®ä¸Šé€šè¿‡å®¡è®®ï¼ˆåŸæ–‡ï¼‰ï¼Œç„¶åæ‰èƒ½åŠ å…¥é˜¶æ®µ 0 çš„å»ºè®®é¡µé¢ã€‚ é˜¶æ®µ 1ï¼šProposal å»ºè®®ä»€ä¹ˆæ˜¯ Proposalï¼Ÿä¸€ä»½æ–°ç‰¹æ€§çš„æ­£å¼å»ºè®®æ–‡æ¡£ã€‚ å¿…å¤‡æ¡ä»¶ï¼šå¿…é¡»ç¡®å®šä¸€ä½å¸¦å¤´äººæ¥ä¸ºè´Ÿè´£è¿™ä»½å»ºè®®ã€‚æ— è®ºæ˜¯å¸¦å¤´äººæˆ–è€…è”åˆå¸¦å¤´äººéƒ½å¿…é¡»æ˜¯ TC39 çš„ä¼šå‘˜ï¼ˆåŸæ–‡ï¼‰ã€‚å»ºè®®è¦è§£å†³çš„é—®é¢˜å¿…é¡»ä»¥ç®€æ˜çš„æ–‡å­—æè¿°ï¼Œè€Œè§£å†³æ–¹æ¡ˆåˆ™è¦ç»™å‡ºç›¸åº”çš„å®ä¾‹å’Œ APIï¼Œå¹¶è¯¦ç»†æè¿°è¯­ä¹‰åŠç®—æ³•ã€‚æœ€åï¼Œå¿…é¡»æŒ‡æ˜æ­¤å»ºè®®çš„æ½œåœ¨é—®é¢˜ï¼Œä¾‹å¦‚ä¸å…¶ä»–ç‰¹æ€§ä¹‹é—´çš„å…³è”ï¼Œå®ç°éš¾ç‚¹ç­‰ã€‚å®ç°æ–¹å¼ï¼Œpolyfills å’Œ demo ä¹Ÿæ˜¯éœ€è¦çš„ã€‚ ä¸‹ä¸€æ­¥ï¼šé€šè¿‡ä¸€ä¸ªé˜¶æ®µ 1 çš„å»ºè®®ï¼Œè¡¨æ˜ TC39 æ„¿æ„ç ”ç©¶ã€è®¨è®ºå¹¶ä¿ƒæˆè¯¥å»ºè®®ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æœŸå¾…è¯¥å»ºè®®çš„é‡å¤§æ”¹å˜äº†ã€‚ é˜¶æ®µ 2ï¼šDraft è‰æ¡ˆä»€ä¹ˆæ˜¯ Draftï¼Ÿè‰æ¡ˆæ˜¯è§„èŒƒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚å…¶ä¸æœ€ç»ˆæ ‡å‡†ä¸­åŒ…å«çš„ç‰¹æ€§ä¸ä¼šæœ‰å¤ªå¤§å·®åˆ«ã€‚ å¿…å¤‡æ¡ä»¶ï¼šå»ºè®®æ­¤æ—¶å¿…é¡»è¦é™„åŠ è¯¥ç‰¹æ€§çš„è¯­æ³•å’Œè¯­ä¹‰çš„æ­£å¼è¯´æ˜ï¼ˆä½¿ç”¨ ECMAScript æ ‡å‡†çš„å½¢å¼è¯­è¨€ï¼‰ã€‚è¯´æ˜åº”è¯¥å°½å¯èƒ½å®Œå–„ï¼Œä½†å¯ä»¥åŒ…å«å¾…åŠäº‹é¡¹å’Œå ä½ç¬¦ã€‚è¯¥ç‰¹æ€§éœ€è¦ä¸¤ä¸ªå®éªŒæ€§çš„å®ç°ï¼Œå…¶ä¸­ä¸€ä¸ªå¯ä»¥åœ¨ç±»ä¼¼ Babel çš„è½¬è¯‘å™¨ï¼ˆtranspilerï¼‰ä¸­å®ç°ã€‚ ä¸‹ä¸€æ­¥ï¼šä»è¯¥é˜¶æ®µå¼€å§‹åªæ¥å—å¢é‡è°ƒæ•´ã€‚ é˜¶æ®µ 3ï¼šCandidate å€™é€‰ä»€ä¹ˆæ˜¯ Candidateï¼Ÿå€™é€‰é˜¶æ®µï¼Œå»ºè®®åŸºæœ¬å®Œæˆï¼Œæ­¤æ—¶å°†ä»å®ç°è¿‡ç¨‹å’Œç”¨æˆ·ä½¿ç”¨ä¸¤æ–¹é¢è·å–åé¦ˆæ¥è¿›ä¸€æ­¥å®Œå–„å»ºè®®ã€‚ å¿…å¤‡æ¡ä»¶ï¼šè§„èŒƒæ–‡æ¡£å¿…é¡»æ˜¯å®Œæ•´çš„ã€‚æŒ‡å®šçš„è¯„å®¡äººï¼ˆç”± TC39 è€Œä¸æ˜¯å¸¦å¤´äººæŒ‡å®šï¼‰å’Œ ECMAScript è§„èŒƒçš„ç¼–è¾‘é¡»åœ¨è§„èŒƒä¸Šç­¾å­—ã€‚è¿˜æœ‰è‡³å°‘è¦ä¸¤ä¸ªç¬¦åˆè§„èŒƒçš„å®ç°ï¼ˆä¸å¿…æŒ‡å®šé»˜è®¤å®ç°ï¼‰ã€‚ ä¸‹ä¸€æ­¥ï¼šæ­¤åï¼Œåªæœ‰åœ¨å®ç°å’Œä½¿ç”¨è¿‡ç¨‹ä¸­å‡ºç°äº†é‡å¤§é—®é¢˜æ‰ä¼šä¿®æ”¹å»ºè®®ã€‚ é˜¶æ®µ 4ï¼šFinished å®Œæˆä»€ä¹ˆæ˜¯ Finishedï¼Ÿå»ºè®®å·²ç»å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æ·»åŠ åˆ°æ ‡å‡†ä¹‹ä¸­ã€‚ å¿…å¤‡æ¡ä»¶ï¼šå»ºè®®è¿›å…¥å®Œæˆé˜¶æ®µä¹‹å‰éœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ç‚¹ï¼š Test 262 çš„éªŒæ”¶æµ‹è¯•ï¼ˆåŸºæœ¬ä¸Šéƒ½æ˜¯ JavaScript å†™çš„ç”¨æ¥éªŒè¯è¯­è¨€ç‰¹æ€§çš„å•å…ƒæµ‹è¯•ï¼‰ã€‚ ä¸¤ä¸ªé€šè¿‡æµ‹è¯•çš„ç¬¦åˆè§„èŒƒçš„å®ç°ã€‚ ç‰¹æ€§å®ç°ç›¸å…³çš„é‡è¦å®è·µç»éªŒã€‚ ECMAScript è§„èŒƒçš„ç¼–è¾‘åœ¨è§„èŒƒæ–‡æœ¬ä¸Šçš„ç­¾å­—ã€‚ ä¸‹ä¸€æ­¥ï¼š å»ºè®®å°†ä¼šå°½å¿«åŠ å…¥ ECMAScript è§„èŒƒä¹‹ä¸­ã€‚å½“è§„èŒƒé€šè¿‡å¹´åº¦å®¡æ ¸æˆä¸ºæ ‡å‡†ï¼Œè¯¥å»ºè®®ä¹Ÿæ­£å¼æˆä¸ºæ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚ 3ã€åˆ«æŠŠå®ƒä»¬ç§°åš ECMASript 20xx ç‰¹æ€§ç»¼ä¸Šæ‰€è¿°ï¼Œåªæœ‰å»ºè®®è¿›å…¥é˜¶æ®µ 4ï¼Œä½ æ‰èƒ½ç¡®å®šè¿™ä¸ªç‰¹æ€§ä¼šè¢«çº³å…¥æ ‡å‡†ä¹‹ä¸­ã€‚å› ä¸ºæ­¤æ—¶å®ƒå¾ˆæœ‰å¯èƒ½è¢«åŠ å…¥åˆ°ä¸‹ä¸€ç‰ˆæœ¬çš„ ECMAScriptï¼Œä½†ä¹Ÿä¸æ˜¯ 100% ç¡®å®šï¼ˆå› ä¸ºæœ‰å¯èƒ½ä¼šèŠ±æ›´é•¿æ—¶é—´ï¼‰ã€‚å› æ­¤ï¼Œä½ ä¸èƒ½ç§°è¿™ä¸ªå»ºè®®ä¸ºâ€œES7 ç‰¹æ€§â€æˆ–â€œES2016 ç‰¹æ€§â€ã€‚æ‰€ä»¥æˆ‘å–œæ¬¢æŠŠæ–‡ç« æˆ–åšå®¢çš„æ ‡é¢˜å†™æˆè¿™æ ·ï¼š â€œECMAScript å»ºè®®ï¼šæŸç‰¹æ€§â€ã€‚åœ¨æ–‡ç« å¼€å¤´è¯´æ˜å»ºè®®æ‰€å¤„çš„é˜¶æ®µã€‚ â€œES.é˜¶æ®µ 2ï¼šæŸç‰¹æ€§â€ã€‚ å¦‚æœå»ºè®®å¤„äºé˜¶æ®µ 4ï¼Œæˆ‘è§‰å¾—ç§°å®ƒ ES20xx ç‰¹æ€§æ˜¯ OK çš„ï¼Œä½†è¿˜æ˜¯ç­‰è§„èŒƒçš„ç¼–è¾‘ç¡®è®¤è¯¥ç‰¹æ€§å°†ä¼šåŠ å…¥å“ªä¸ªç‰ˆæœ¬ä¹‹åæ‰æœ€ä¿é™©ã€‚ä¾‹å¦‚ Object.observe å°±æ˜¯ä¸€ä¸ªå·²ç»è¿›å…¥é˜¶æ®µ 2 ï¼Œå´æœ€ç»ˆè¢«æ’¤å›çš„ ECMAScript å»ºè®®ã€‚ 4ã€ECMAScript 2016 å°†ä¼šæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿå·²è¢«çº³å…¥ ES2016 çš„ç‰¹æ€§ï¼š Array.prototype.includes (Domenic Denicola, Rick Waldron) ä»¥ä¸‹å¤„äºé˜¶æ®µ 4 çš„ç‰¹æ€§å°†å¯èƒ½ä¼šçº³å…¥ ES2016ï¼š ï¼ˆæš‚æ—¶æ²¡æœ‰ã€‚ï¼‰ ä»¥ä¸‹å¤„äºé˜¶æ®µ 3 çš„ç‰¹æ€§ä¹Ÿè®¸ä¼šçº³å…¥ ES2016ï¼š æŒ‡æ•°è¿ç®—ç¬¦ï¼ˆRick Waldronï¼‰ SIMD.JS â€“ SIMD APIs + polyfillï¼ˆJohn McCutchan, Peter Jensen, Dan Gohman, Daniel Ehrenbergï¼‰ å¼‚æ­¥å‡½æ•°ï¼ˆBrian Terlsonï¼‰ Object.values/Object.entriesï¼ˆJordan Harbandï¼‰ å­—ç¬¦ä¸²å¡«å……ï¼ˆJordan Harband &amp; Rick Waldronï¼‰ å‡½æ•°å‚æ•°åˆ—è¡¨ä¸è°ƒç”¨ä¸­çš„å°¾é€—å·ï¼ˆJeff Morrisonï¼‰ å¦‚æœä½ ä¸çŸ¥é“æŸä¸ªå»ºè®®ç‰¹æ€§å¤„äºå“ªä¸ªé˜¶æ®µï¼Œä½ å¯ä»¥åœ¨ ECMA-262 GitHub åº“çš„ readme ä¸­æŸ¥é˜…ã€‚ 5ã€Array.prototype.includes (Domenic Denicola, Rick Waldron)æ•°ç»„çš„ includes æ–¹æ³•æœ‰å¦‚ä¸‹ç­¾åï¼š1Array.prototype.includesï¼ˆvalueï¼šä»»æ„å€¼ï¼‰ï¼š boolean å¦‚æœä¼ å…¥çš„å€¼åœ¨å½“å‰æ•°ç»„ï¼ˆthisï¼‰ä¸­åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseï¼š1234&gt; ['a', 'b', 'c'].includes('a')true&gt; ['a', 'b', 'c'].includes('d')false includes æ–¹æ³•ä¸ indexOf æ–¹æ³•å¾ˆç›¸ä¼¼â€”â€”ä¸‹é¢ä¸¤ä¸ªè¡¨è¾¾å¼æ˜¯ç­‰ä»·çš„ï¼š12arr.includes(x)arr.indexOf(x) &gt;= 0 å”¯ä¸€çš„åŒºåˆ«æ˜¯ includes() æ–¹æ³•èƒ½æ‰¾åˆ° NaNï¼Œè€Œ indexOf() ä¸è¡Œï¼š1234&gt; [NaN].includes(NaN)true&gt; [NaN].indexOf(NaN)-1 includes ä¸ä¼šåŒºåˆ† +0 å’Œ -0 ï¼ˆè¿™ä¹Ÿä¸å…¶ä»– JavaScript ç‰¹æ€§è¡¨ç°ä¸€è‡´ï¼‰ï¼š12&gt; [-0].includes(+0)true ç±»å‹æ•°ç»„ä¹Ÿæœ‰ includes() æ–¹æ³•ï¼š Typed Arrays will also have a method includes():12let tarr = Uint8Array.of(12, 5, 3);console.log(tarr.includes(5)); // true 5.1 å¸¸è§é—®é¢˜ ä¸ºä»€ä¹ˆæ–¹æ³•å–å includes è€Œä¸æ˜¯ containsï¼Ÿåè€…æ˜¯æœ€åˆçš„é€‰æ‹©ï¼Œä½†åœ¨ web ä¸Šå°†ä¼šç ´åå·²æœ‰çš„ä»£ç ï¼ˆMooTools åœ¨ Array.prototype ä¸Šæ·»åŠ äº† contains æ–¹æ³•ï¼‰ã€‚ ä¸ºä»€ä¹ˆæ–¹æ³•å–å includes è€Œä¸æ˜¯ hasï¼Ÿhas é€šå¸¸ç”¨äºé”®ï¼ˆMap.prototype.hasï¼‰ï¼Œincludes é€šå¸¸ç”¨äºå…ƒç´ ï¼ˆString.prototype.includesï¼‰ã€‚é›†åˆä¸­çš„å…ƒç´ æ—¢å¯ä»¥è¢«çœ‹å½“åš é”® ä¹Ÿå¯è¢«å½“åš å€¼ï¼Œæ‰€ä»¥æ‰æœ‰ Set.prototype.has ï¼ˆè€Œä¸æ˜¯ includesï¼‰ã€‚ ES6 çš„ String.prototype.includes æ–¹æ³•å¯ç”¨äºå­—ç¬¦ä¸²ï¼Œè€Œä¸èƒ½ç”¨äºå­—ç¬¦ã€‚è¿™æ˜¯å¦å’Œ Array.prototype.includes ä¸ä¸€è‡´ï¼Ÿå¦‚æœæ•°ç»„å’Œå­—ç¬¦ä¸²çš„ includes æ–¹æ³•æ˜¯ç›¸åŒçš„å·¥ä½œæœºåˆ¶ï¼Œé‚£ä¹ˆæ•°ç»„çš„ includes æ–¹æ³•å°±åº”è¯¥æ¥å—æ•°ç»„ï¼Œè€Œä¸æ˜¯æ•°ç»„å…ƒç´ äº†ã€‚ä¸è¿‡è¿™ä¸¤ä¸ª includes æ–¹æ³•éƒ½å‚è€ƒäº† indexOf æ–¹æ³•ï¼›å­—ç¬¦ä¸€èˆ¬æ˜¯ç‰¹æ®Šæƒ…å†µï¼Œè€Œä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²åˆ™æ›´å¸¸è§ã€‚ 5.2 æ‰©å±•é˜…è¯» Array.prototype.includes (Domenic Denicola, Rick Waldron) 6ã€æŒ‡æ•°è¿ç®—ç¬¦ï¼ˆRick Waldronï¼‰æ–°æå‡ºæ¥çš„ç‰¹æ€§æ˜¯å°† ** ä½œä¸ºæŒ‡æ•°æ“ä½œçš„ä¸­ç¼€è¿ç®—ç¬¦ï¼š1x ** y ä¸ä»¥ä¸‹è¡¨è¾¾å¼è¿ç®—ç»“æœç›¸åŒï¼š1Math.pow(x, y) ç¤ºä¾‹ï¼š12345let squared = 3 ** 2; // 9 let num = 3;num **= 2;console.log(num); // 9 æ‰©å±•é˜…è¯»ï¼š æŒ‡æ•°è¿ç®—ç¬¦ (Rick Waldron) 7ã€SIMD.JS â€“ SIMD APIs + polyfill (John McCutchan, Peter Jensen, Dan Gohman, Daniel Ehrenberg)SIMD æ„æ€æ˜¯â€œsingle instruction, multiple dataï¼ˆå•æŒ‡ä»¤æµå¤šæ•°æ®æµï¼‰â€ï¼ŒCPU å¯ä»¥é€šè¿‡å•æ¡æŒ‡ä»¤æ“ä½œä¸€ç»„æ•°æ®ï¼ˆè€Œä¸æ˜¯ä»…æ“ä½œå•ä¸€å€¼ï¼‰ï¼ŒSIMD æŒ‡ä»¤é›†æœ€æœ‰åçš„ä¸€ä¸ªä¾‹å­å°±æ˜¯ç”± Intel å¤„ç†å™¨çš„ SSEï¼ˆStreaming SIMD Extensionsï¼‰ã€‚ ä¸‹é¢æ˜¯ç®€çŸ­çš„ç¤ºä¾‹ä»£ç ï¼Œè¯·å‚è€ƒåé¢æºç è·å–æ›´å¤šä¿¡æ¯ã€‚ 123var a = SIMD.float32x4(1.0, 2.0, 3.0, 4.0);var b = SIMD.float32x4(5.0, 6.0, 7.0, 8.0);var c = SIMD.float32x4.add(a,b); æ‰©å±•é˜…è¯»ï¼š SIMD.JS â€“ SIMD APIs + polyfill (John McCutchan, Peter Jensen, Dan Gohman, Daniel Ehrenberg) JavaScript å¯æ”¯æŒ SIMD (2ality) 8ã€å¼‚æ­¥å‡½æ•°ï¼ˆBrian Terlsonï¼‰åœ¨æˆ‘ä»‹ç»å¼‚æ­¥å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä¼šå…ˆä»‹ç»å¦‚ä½•é€šè¿‡ Promises å’Œ generators æ¥ä½¿ç”¨çœ‹èµ·æ¥åŒæ­¥çš„ä»£ç å»æ‰§è¡Œå¼‚æ­¥æ“ä½œã€‚ 8.1 ç”¨ Promises å’Œ generators ç¼–å†™å¼‚æ­¥ä»£ç å¯¹äºéœ€è¦å¼‚æ­¥åœ°è®¡ç®—ä¸€æ¬¡æ€§ç»“æœçš„å‡½æ•°æ¥è¯´ï¼ŒPromisesï¼ˆES6 çš„ä¸€éƒ¨åˆ†ï¼‰ç°åœ¨è¶Šæ¥è¶Šæµè¡Œã€‚ä¸€ä¸ªä¾‹å­å°±æ˜¯å®¢æˆ·ç«¯ fetch APIï¼Œå®ƒæ˜¯ä¸€ç§æ›¿ä»£ XMLHttpRequest æ£€ç´¢æ–‡ä»¶çš„æ–¹æ¡ˆã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112function fetchJson(url) &#123; return fetch(url) .then(request =&gt; request.text()) .then(text =&gt; &#123; return JSON.parse(text); &#125;) .catch(error =&gt; &#123; console.log(`ERROR: $&#123;error.stack&#125;`); &#125;);&#125;fetchJson('http://example.com/some_file.json').then(obj =&gt; console.log(obj)); co æ˜¯ä¸€ä¸ªä½¿ç”¨äº† Promises å’Œ generators è®©ç¼–ç¨‹é£æ ¼çœ‹èµ·æ¥æ›´åƒå¼‚æ­¥çš„åº“ï¼Œä½†ä¹Ÿéœ€è¦ä½¿ç”¨ç±»ä¼¼äºå‰ä¸€ä¸ªä¾‹å­çš„é£æ ¼å»ç¼–ç ï¼š 12345678910const fetchJson = co(function* () &#123; try &#123; let request = yield fetch(url); let text = yield request.text(); return JSON.parse(text); &#125; catch (error) &#123; console.log(`ERROR: $&#123;error.stack&#125;`); &#125;&#125;); æ¯æ¬¡å›è°ƒå‡½æ•°ï¼ˆä¸€ä¸ª generator å‡½æ•°ï¼ï¼‰äº§ç”Ÿä¸€ä¸ª Promise ç»™ coï¼Œå›è°ƒå‡½æ•°å°±ä¼šè¢«æŒ‚èµ·ã€‚ä¸€æ—¦è¿™ä¸ª Promise å®Œæˆï¼Œco å°±ä¼šæ¢å¤è¯¥å›è°ƒå‡½æ•°ï¼šå¦‚æœ Promise è¢«å®ç°ï¼Œyield ä¼šè¿”å›è¿™ä¸ªå®ç°çš„å€¼ï¼Œå¦‚æœè¢«æ‹’ç»ï¼Œåˆ™ yield ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å¦å¤–ï¼Œco èƒ½å¤„ç†å›è°ƒå‡½æ•°è¿”å›çš„ç»“æœï¼ˆä¸ then() ç›¸ä¼¼ï¼‰ã€‚ 8.2 å¼‚æ­¥å‡½æ•°å¼‚æ­¥å‡½æ•°çš„è¯­æ³•åŸºæœ¬ä¸Šå¯ä»¥è¯´æ˜¯å®ç°äº† co æ‰€åšçš„ï¼š 12345678910async function fetchJson(url) &#123; try &#123; let request = await fetch(url); let text = await request.text(); return JSON.parse(text); &#125; catch (error) &#123; console.log(`ERROR: $&#123;error.stack&#125;`); &#125;&#125; åœ¨å†…éƒ¨ï¼Œå¼‚æ­¥å‡½æ•°çš„å·¥ä½œéå¸¸ç±»ä¼¼äº generatorsï¼Œä½†å®ƒå¹¶ä¸ä¼šè¢«ç¿»è¯‘ä¸º generator å‡½æ•°ã€‚ 8.3 å˜ä½“å¼‚æ­¥å‡½æ•°æœ‰ä»¥ä¸‹å‡ ç§å˜ä½“ï¼š å‡½æ•°å£°æ˜ï¼š async function foo() { }å‡½æ•°è¡¨è¾¾å¼ï¼šconst foo = async function () {};æ–¹æ³•å®šä¹‰ï¼šlet obj = { async foo() {} }ç®­å¤´å‡½æ•°ï¼šconst foo = async () =&gt; {} 8.4.æ‰©å±•é˜…è¯» å¼‚æ­¥å‡½æ•° (Brian Terlson) é€šè¿‡ generators ç®€åŒ–å¼‚æ­¥è®¡ç®— (â€œæ¢ç´¢ ES6â€ç« èŠ‚) 9ã€æ‰©å±•é˜…è¯»ä¸‹é¢æ˜¯æœ¬ç¯‡åšå®¢çš„é‡è¦å‚è€ƒèµ„æ–™ï¼š ecma262ï¼ˆECMA-262 æ˜¯ ECMAScript æ ‡å‡†çš„ä¸€ä¸ªIDï¼‰GitHub åº“ï¼Œå®ƒåŒ…æ‹¬ï¼š æ‰€æœ‰å¤„äºé˜¶æ®µ 1 åŠä»¥ä¸Šé˜¶æ®µå»ºè®®çš„ readme æ–‡ä»¶ã€‚ å¤„äºé˜¶æ®µ 0 çš„å»ºè®®åˆ—è¡¨ã€‚ ECMA-262 çš„å¸¸è§é—®é¢˜ã€‚ TC39 çš„è¿›åº¦æ–‡æ¡£ å…¶ä»–èµ„æ–™ï¼š Kangax çš„ ES7 å…¼å®¹æ€§è¡¨æ ¼ ä¼šå‘Šè¯‰ä½ å“ªäº›å»ºè®®åœ¨å“ªäº›æµè§ˆå™¨ä¸­å·²ç»å¾—åˆ°æ”¯æŒï¼Œå¹¶å°†å»ºè®®æ ¹æ®æ‰€å¤„é˜¶æ®µè¿›è¡Œäº†åˆ†ç±»ã€‚ æ›´å¤šå…³äº ES6 è®¾è®¡è¿‡ç¨‹çš„ä¿¡æ¯ï¼š â€œECMAScript 6 æ˜¯å¦‚ä½•è¢«è®¾è®¡å‡ºæ¥çš„â€â€”â€”â€”â€œæ¢ç´¢ ES6â€ä¸­çš„ç« èŠ‚ã€‚ ä½œè€…ï¼šDr. Axel Rauschmayerï¼Œæ—¶é—´ï¼š2015-11-15 åŸæ–‡é“¾æ¥: http://www.2ality.com/2015/11/tc39-process.html è¯‘è€…ï¼šzhouweicsu","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"ECMAScript","slug":"ECMAScript","permalink":"http://zhouweicsu.github.io/blog/tags/ECMAScript/"},{"name":"ES7","slug":"ES7","permalink":"http://zhouweicsu.github.io/blog/tags/ES7/"},{"name":"ES 2016","slug":"ES-2016","permalink":"http://zhouweicsu.github.io/blog/tags/ES-2016/"},{"name":"TC39","slug":"TC39","permalink":"http://zhouweicsu.github.io/blog/tags/TC39/"},{"name":"è®¾è®¡è¿‡ç¨‹","slug":"è®¾è®¡è¿‡ç¨‹","permalink":"http://zhouweicsu.github.io/blog/tags/è®¾è®¡è¿‡ç¨‹/"}]},{"title":"ã€Œè¯‘ã€åˆ«å†ä¸¢ç”¨æˆ·ä¸åº”ç”¨ç¨‹åºçš„çŠ¶æ€äº†ï¼Œèµ¶ç´§ç”¨ Page Visibility å§","date":"2015-11-23T16:00:00.000Z","path":"2015/11/24/dont-lose-user-and-app-state-use-page-visibility/","text":"ä¼˜ç§€çš„åº”ç”¨ä»ä¸ä¸¢å¤±ç”¨æˆ·çš„è¿›åº¦ä¸åº”ç”¨ç¨‹åºçŠ¶æ€ã€‚è€Œæ˜¯åœ¨ä¸ä¸­æ–­ç”¨æˆ·çš„æƒ…å†µä¸‹è‡ªåŠ¨ä¿å­˜ç›¸å…³æ•°æ®ï¼Œç„¶ååœ¨å¿…è¦çš„æ—¶å€™ï¼ˆä¾‹å¦‚ï¼šä»åå°çŠ¶æ€æˆ–è€…æ„å¤–å…³æœºä¸­å›æ¥ï¼‰æ¢å¤è¿™äº›æ•°æ®ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè®¸å¤š Web åº”ç”¨å› ä¸ºæ²¡è€ƒè™‘ç§»åŠ¨ç«¯çš„ç”Ÿå‘½å‘¨æœŸä»è€Œå¯¼è‡´äº†è¿™ä¸ªé”™è¯¯ï¼šå®ƒä»¬é”™è¯¯åœ°ç›‘å¬äº†ä¹Ÿè®¸æ°¸è¿œä¸ä¼šè¢«è§¦å‘çš„äº‹ä»¶ï¼Œæˆ–è€…å®Œå…¨å¿½ç•¥è¿™ä¸ªé—®é¢˜ä»è€Œå¯¼è‡´ä»£ä»·é«˜æ˜‚çš„æå·®ç”¨æˆ·ä½“éªŒã€‚ä¸è¿‡å…¬å¹³åœ°è¯´ï¼ŒWeb å¹³å°æä¾›çš„è¯¸å¤šä¸åŒçš„äº‹ä»¶ï¼ˆvisibilityStateã€ pageshowã€ pagehideã€ beforeunloadã€ unloadï¼‰ä¹Ÿä½¿é—®é¢˜å˜å¾—å¤æ‚ã€‚æˆ‘ä»¬åˆ°åº•åº”è¯¥ä½¿ç”¨å“ªä¸ªäº‹ä»¶ï¼Œä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ ä½ åœ¨ç§»åŠ¨å¹³å°ä¸èƒ½ä¾èµ– pagehideã€ beforeunloadã€ å’Œ unload äº‹ä»¶ã€‚å› ä¸ºä¹Ÿè®¸åœ¨ä½ å–œæ¬¢çš„æµè§ˆå™¨ä¸­ä½¿ç”¨æ²¡æœ‰ bugï¼Œä½†åº”ç”¨ç¨‹åºå¾—è¿è¡Œåœ¨æ‰€æœ‰çš„ç§»åŠ¨æ“ä½œç³»ç»Ÿä¸­ã€‚æ´»åŠ¨çš„åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼è¿›å…¥åˆ°â€œåå°çŠ¶æ€â€ï¼š ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªé€šçŸ¥ï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ªåº”ç”¨ã€‚ ç”¨æˆ·å”¤èµ·äº†ä»»åŠ¡åˆ‡æ¢æ ï¼Œå»äº†å¦ä¸€ä¸ªåº”ç”¨ã€‚ ç”¨æˆ·æ‘äº† home é”®å»äº†é¦–å±ã€‚ æ“ä½œç³»ç»Ÿåˆ‡æ¢åº”ç”¨ï¼Œä¾‹å¦‚ï¼Œæ¥äº†ä¸ªç”µè¯ã€‚ åº”ç”¨ç¨‹åºä¸€æ—¦è¢«åˆ‡æ¢åˆ°åå°ï¼Œéšæ—¶å¯èƒ½è¢«å¹²æ‰ã€‚ä¾‹å¦‚ï¼Œæ“ä½œç³»ç»Ÿä¼šç»ˆæ­¢è¯¥è¿›ç¨‹ä»¥å›æ”¶ç³»ç»Ÿèµ„æºï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨ä»»åŠ¡åˆ‡æ¢æ ä¸­å°†å®ƒæ¸…é™¤ã€‚å› æ­¤ï¼Œä½ åº”è¯¥è®¤ä¸ºè§¦å‘ pagehideã€ beforeunloadã€ å’Œ unload äº‹ä»¶çš„â€œæ­£å¸¸å…³é—­â€å°±æ˜¯ä¸ªä¾‹å¤–ã€‚ ä¸ºäº†æä¾›å¯é æµç•…çš„ç”¨æˆ·ä½“éªŒï¼Œæ— è®ºæ˜¯åœ¨ PC ç«¯è¿˜æ˜¯ç§»åŠ¨ç«¯ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨ Page Visibility APIï¼Œæ ¹æ® visibilityChange çŠ¶æ€çš„å˜åŒ–ä¿å­˜æˆ–æ¢å¤å½“å‰ä¼šè¯ã€‚è¿™æ˜¯åº”ç”¨ç¨‹åºå”¯ä¸€å¯ä»¥ä¾èµ–çš„äº‹ä»¶ã€‚ 1234567891011// query current page visibility state: prerender, visible, hiddenvar pageVisibility = document.visibilityState;// subscribe to visibility change eventsdocument.addEventListener('visibilitychange', function() &#123; // fires when user switches tabs, apps, goes to homescreen, etc. if (document.visibilityState == 'hidden') &#123; ... &#125; // fires when app transitions from prerender, user returns to the app / tab. if (document.visibilityState == 'visible') &#123; ... &#125;&#125;); å¦‚æœä½ ä½¿ç”¨ unload äº‹ä»¶æ¥ä¿å­˜çŠ¶æ€ï¼Œè®°å½•å’ŒæŠ¥å‘Šåˆ†ææ•°æ®ï¼Œå¹¶æ‰§è¡Œå…¶ä»–ç›¸å…³é€»è¾‘ï¼Œé‚£ä½ å°†ä¼šä¸¢å¤±å¤§éƒ¨åˆ†ç§»åŠ¨ç«¯ä¼šè¯æ•°æ®ï¼Œå› ä¸ºå¾ˆå¤š unload äº‹ä»¶ä¸ä¼šè¢«è§¦å‘ã€‚åŒæ ·ï¼Œå¦‚æœä½ ä¾èµ– beforeunload äº‹ä»¶æ¥æç¤ºç”¨æˆ·æ²¡ä¿å­˜æ•°æ®ï¼Œé‚£ä½ å¿˜è®°äº†åˆšæ‰è¯´çš„â€œæ­£å¸¸å…³é—­â€å°±æ˜¯ä¸€ä¸ªæ„å¤–ã€‚ ä½¿ç”¨ Page Visibility APIï¼Œå¿˜è®°å…¶ä»–äº‹ä»¶ï¼Œå°±å½“å®ƒä»¬éƒ½ä¸å­˜åœ¨ã€‚å°†æ¯æ¬¡åº”ç”¨ç¨‹åºåˆ‡æ¢åˆ° visible éƒ½å½“åšä¸€ä¸ªæ–°çš„ä¼šè¯ï¼šæ¢å¤ä¹‹å‰çš„çŠ¶æ€ï¼Œé‡ç½®ä½ çš„åˆ†æçŠ¶æ€ç­‰ç­‰ã€‚ç„¶åï¼Œå½“åº”ç”¨ç¨‹åºåˆ‡æ¢è‡³ hidden æ—¶ç»“æŸè¯¥ä¼šè¯ï¼šä¿å­˜ç”¨æˆ·ä¸åº”ç”¨ç¨‹åºçŠ¶æ€ï¼Œæ ‡è®°ä½ çš„åˆ†ææ•°æ®ï¼Œä»¥åŠåšå¥½æ‰€æœ‰å…¶ä»–å¿…è¦çš„å·¥ä½œã€‚ å¦‚æœæœ‰å¿…è¦ï¼Œä½ å¯ä»¥åšä¸€äº›é¢å¤–çš„å·¥ä½œï¼Œå°†è¿™äº›åŸºäºå¯è§æ€§çš„ä¼šè¯éƒ½æ±‡èšåˆ°è®°å½•åº”ç”¨ç¨‹åºä¸æ ‡ç­¾åˆ‡æ¢çš„ç”¨æˆ·æµä¸­ï¼Œä¾‹å¦‚ï¼Œç»™æœåŠ¡å™¨æ±‡æŠ¥æ¯ä¸€ä¸ªä¼šè¯ï¼Œåœ¨æœåŠ¡å™¨ç«¯å°†å¤šä¸ªä¼šè¯åˆå¹¶åœ¨ä¸€èµ·ã€‚ å®é™…å®ç°ä¸­çš„é—®é¢˜é•¿æœŸæ¥è¯´ï¼Œä½ åªè¦ Page Visibility API å°±å¤Ÿäº†ã€‚ä½†ç°åœ¨ä½ å¿…é¡»å¾—ä¸å¦ä¸€ä¸ªäº‹ä»¶ â€”â€”â€”â€” pagehide ä¸€èµ·ç”¨ï¼Œç›®çš„æ˜¯ä¸ºäº†è€ƒè™‘â€œé¡µé¢è¦è¢«å¸è½½äº†â€çš„æƒ…å†µã€‚ä¸‹è¡¨è®°å½•äº†å½“å‰æ¯ä¸ªæµè§ˆå™¨ä¸‹å“ªä¸ªæ“ä½œä¼šè§¦å‘å“ªä¸ªäº‹ä»¶çš„è¯¦ç»†æ•°æ®ï¼ˆåŸºäºæˆ‘çš„æ‰‹åŠ¨æµ‹è¯•ï¼‰ã€‚ visibilityChange å¯é åæ˜ ç§»åŠ¨ç«¯ä»»åŠ¡åˆ‡æ¢ã€‚ beforeunload ä»·å€¼æœ‰é™ï¼Œåªèƒ½åœ¨ PC æµè§ˆå™¨ä¸Šè¢«è§¦å‘ã€‚ unload åœ¨ç§»åŠ¨ç«¯å’Œ PC ç«¯çš„ Safari ä¸­éƒ½ä¸ä¼šè¢«è§¦å‘ã€‚ å¯å–œçš„æ˜¯ Page Visibility ä¾èµ–è¦†ç›–äº†æ‰€æœ‰å¹³å°å’Œæµè§ˆå™¨å‚å•†çš„ä»»åŠ¡åˆ‡æ¢åœºæ™¯ã€‚ä½†æ˜¯ï¼Œåˆ°ç°åœ¨ä¸ºæ­¢ Firefox æ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨é¡µé¢ unloaded çš„æ—¶å€™è¿˜ä¼šè§¦å‘ visibilityChange äº‹ä»¶çš„æµè§ˆå™¨ï¼Œè¿™é‡Œæ˜¯Chromeã€ WebKitã€ Edge æœ‰å…³è¿™ä¸ªé—®é¢˜çš„ bugã€‚åªè¦è¿™äº› bug è¢«ä¿®å¤ï¼ŒvisibilityState å°†æ˜¯æé«˜ç”¨æˆ·ä½“éªŒå”¯ä¸€éœ€è¦çš„äº‹ä»¶äº†ã€‚","tags":[{"name":"HTML5","slug":"HTML5","permalink":"http://zhouweicsu.github.io/blog/tags/HTML5/"},{"name":"Page Visibility","slug":"Page-Visibility","permalink":"http://zhouweicsu.github.io/blog/tags/Page-Visibility/"}]},{"title":"ã€Œè¯‘ã€ç”¨ Browserifyï¼Œ Babel & hot reloading å¿«é€Ÿæ„å»º ES2015 å·¥ç¨‹","date":"2015-10-14T16:00:00.000Z","path":"2015/10/15/quick-es2015-project-setup-with-browserify-babel-hot-reloading/","text":"ç°åœ¨æœ‰å¾ˆå¤š ES2015 å’Œ React å·¥ç¨‹çš„æ–°æ‰‹å·¥å…·åŒ…ã€‚å¦‚æœä½ æƒ³å¿«é€Ÿæ„å»ºä¸€ä¸ªåŸå‹æˆ–è€…ä½ åªæ˜¯æƒ³ç©ä¸€ç©ä»£ç ï¼Œé‚£ä½ è‚¯å®šå¸Œæœ›é…ç½®è¶Šå°‘è¶Šå¥½ã€‚å¿…å¤‡å·¥å…·é›†æœ‰ï¼š transpilerï¼ˆç¼–è¯‘å·¥å…·ï¼‰ï¼Œ bundlerï¼ˆæ‰“åŒ…å·¥å…·ï¼‰ å’Œ hot reloaderï¼ˆçƒ­é‡è½½ï¼‰ï¼ˆå› ä¸ºæ˜¯2015ï¼Œæ‰€ä»¥ä½ è‚¯å®šä¸å¸Œæœ›åœ¨é‡æ–°åŠ è½½é¡µé¢ä¸Šæµªè´¹æ—¶é—´ï¼‰ã€‚Browserify æ˜¯ä¸€ä¸ªéå¸¸æ£’å¹¶ä¸”ä½¿ç”¨èµ·æ¥å¾ˆç®€å•çš„ bundler ã€‚æ›´é‡è¦çš„æ˜¯â€”â€”å®ƒæ˜¯æ¨¡å—åŒ–çš„ï¼Œè¿™æ ·ä½ å°±èƒ½åœ¨ä»»æ„æ—¶é—´è¿æ¥ plugins å’Œ transformsã€‚Babel æ˜¯æˆ‘ä»¬é€‰æ‹©çš„ transpilerï¼Œæ— è®ºä½ æ˜¯å¦ä½¿ç”¨Reactï¼Œå®ƒéƒ½å¾ˆå¥½ç”¨ã€‚hot reloader æ˜¯ä¸ºäº†æé«˜å¼€å‘æ•ˆç‡ã€‚ç›¸å¯¹äºæ‰‹åŠ¨æˆ–è‡ªåŠ¨é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ï¼Œhot reloader ä»…ä»…è®©æµè§ˆå™¨æ›´æ–°éƒ¨åˆ†ä»£ç ã€‚å› æ­¤å®ƒä¼šå¾ˆå¿«ï¼Œå¹¶ä¸”å¯ä»¥ä¿æŒåº”ç”¨ç¨‹åºçŠ¶æ€ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦é‡å¤ä¹‹å‰çš„æ“ä½œå›åˆ°åŸæ¥çš„UIçŠ¶æ€ã€‚æœ¬æ–‡çš„ä¾‹å­ä¸æ˜¯ä»‹ç»å¦ä¸€ä¸ªæ–°æ‰‹å·¥å…·åŒ…ï¼Œè€Œæ˜¯æ•™ä½ å¦‚ä½•ä»¥æœ€å°‘çš„å¿…å¤‡å·¥å…·å¼€å§‹ ES2015 å·¥ç¨‹ã€‚ æ–°å»ºä¸€ä¸ª package.json å¹¶ä¸”å®‰è£…ä¸‹é¢çš„ packagesï¼š 1$ npm i -D browserify babelify watchify serve å‰ä¸‰ä¸ªæ˜¯ bundlerï¼Œ Babelæ’ä»¶ å’Œ æ–‡ä»¶ç›‘è§†å™¨ï¼Œ serve åŒ…æ˜¯ä¸€ä¸ªé™æ€æœåŠ¡å™¨ã€‚ å°†å¦‚ä¸‹ä»£ç æ·»åŠ è‡³package.jsonï¼Œè¿™æ · Browserify å°±ä¼šåœ¨æŒ‡å®šçš„ stage ä¸‹ä½¿ç”¨ Babel ç¼–è¯‘å™¨ã€‚ 123&#123; &quot;browserify&quot;: &#123; &quot;transform&quot;: [ [&quot;babelify&quot;, &#123;&quot;stage&quot;: [0]&#125;] ]&#125; æœ€åï¼Œè¿™é‡Œæœ‰ä¸€æ®µ NPM è„šæœ¬ä½¿ç”¨ source maps æ¥å¯åŠ¨ bundler å¹¶è¿›å…¥ç›‘è§†æ¨¡å¼ï¼Œä¸”åœ¨æŒ‡å®šçš„ç›®å½•ä¸‹å¯åŠ¨é™æ€æœåŠ¡å™¨ã€‚ 123&quot;scripts&quot;: &#123; &quot;start&quot;: &quot;watchify src/index.js -o public/js/bundle.js -dv &amp; serve public&quot;&#125; åœ¨çƒ­æ¨¡å—æ›¿ä»£æ–¹é¢ï¼Œæˆ‘é€‰æ‹© Browserify å®‰è£…å¦‚ä¸‹æ’ä»¶ä¸å¿…å¤‡åŒ…æ¥é‡æ–°åŠ è½½ React ç»„ä»¶ï¼š1$ npm i -D livereactload react-proxy babel-plugin-react-transform æ–°å»º .babelrc æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚è¿™ä¸ªä¼šå‘Šè¯‰ Babel transform ä½¿ç”¨å·²ç»å®‰è£…è¿‡çš„æ’ä»¶ã€‚ 123456789101112131415&#123; &quot;env&quot;: &#123; &quot;development&quot;: &#123; &quot;plugins&quot;: [ &quot;react-transform&quot; ], &quot;extra&quot;: &#123; &quot;react-transform&quot;: &#123; &quot;transforms&quot;: [&#123; &quot;transform&quot;: &quot;livereactload/babel-transform&quot;, &quot;imports&quot;: [&quot;react&quot;] &#125;] &#125; &#125; &#125; &#125;&#125; ç°åœ¨å°†livereactloadæ’ä»¶åŠ å…¥ NPM è„šæœ¬ï¼Œç„¶åä½ å°±å¯ä»¥å¼€å§‹æ„‰å¿«çš„ç©è€äº†ã€‚ 123&quot;scripts&quot;: &#123; &quot;start&quot;: &quot;watchify src/index.js -o public/js/bundle.js -dv -p livereactload &amp; serve public&quot;&#125; è‹¥è¦å¼€å‘äº§å“æˆ–è€…è·å–æ›´å¤šæ·±å…¥èµ„æ–™ï¼Œè¯·è®¿é—® GitHub, ä½ ä¼šæ‰¾åˆ°æµ·é‡ç°æˆçš„æ¨¡æ¿ã€‚ åŸæ–‡é“¾æ¥ï¼šQuick ES2015 project setup with Browserify, Babel &amp; hot reloading","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://zhouweicsu.github.io/blog/tags/ES6/"},{"name":"Browserify","slug":"Browserify","permalink":"http://zhouweicsu.github.io/blog/tags/Browserify/"},{"name":"Babel","slug":"Babel","permalink":"http://zhouweicsu.github.io/blog/tags/Babel/"},{"name":"hot reloading","slug":"hot-reloading","permalink":"http://zhouweicsu.github.io/blog/tags/hot-reloading/"}]},{"title":"ã€Œè¯‘ã€æ·±å…¥ç†è§£ES6ä¸­çš„è§£æ„","date":"2015-08-31T16:00:00.000Z","path":"2015/09/01/es6-destructuring-in-depth/","text":"æˆ‘æ›¾åœ¨Reactç³»åˆ—æ–‡ç« ä¸­ç®€çŸ­çš„æåŠè¿‡ä¸€äº›ES6ç‰¹æ€§ï¼ˆä»¥åŠBabelå…¥é—¨ï¼‰ï¼Œç°åœ¨æˆ‘æƒ³æ·±å…¥ç ”ç©¶è¿™äº›æ–°çš„è¯­è¨€ç‰¹æ€§ã€‚åœ¨é˜…è¯»æµ·é‡ES6ä¸ES7çš„ç›¸å…³æ–‡ç« ä¹‹åï¼Œæˆ‘æƒ³æ˜¯æ—¶å€™åœ¨Pony Fooçš„åšå®¢ä¸­å¼€å§‹è®¨è®ºES6ä¸ES7çš„ç‰¹æ€§äº†ã€‚ æœ¬æ–‡å¼€å¤´ä¼šç»™é‚£äº›ES6æ–°ç‰¹æ€§çš„è¿‡åº¦ä½¿ç”¨è€…ä¸€äº›å¿ å‘Šã€‚æ¥ç€ä»‹ç»ES6ä¸­çš„è§£æ„ï¼Œä»¥åŠè§£æ„çš„ä½¿ç”¨åœºæ™¯ï¼Œè¿˜æœ‰ä¸€äº›é™·é˜±å’Œæ³¨æ„äº‹é¡¹ï¼Œæœ¬æ–‡æ˜¯ES6ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ã€‚ ä¸€å¥å¿ å‘Šå½“ä½ ä¸ç¡®å®šæ—¶ï¼Œåªè¦èƒ½é€‰æ‹©ï¼Œéƒ½æ¨èé€‰æ‹©ES5å’Œè¾ƒæ—§çš„è¯­æ³•ï¼Œè€Œä¸æ˜¯ES6ã€‚æˆ‘è¿™æ ·è¯´å¹¶ä¸æ„å‘³ç€ä½¿ç”¨ES6è¯­æ³•æ˜¯ä¸€ä¸ªåä¸»æ„ï¼Œæ°æ°ç›¸åï¼Œä½ çœ‹æˆ‘æ­£åœ¨å†™çš„å…³äºES6çš„æ–‡ç« å‘¢ï¼éœ€è¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ES6ç‰¹æ€§æ˜¯å› ä¸ºå®ƒä¼šæé«˜æˆ‘ä»¬çš„ä»£ç è´¨é‡ï¼Œè€Œä¸ä»…ä»…å› ä¸ºå®ƒå¾ˆé…·ã€‚ ç›®å‰ä¸ºæ­¢æˆ‘å†™ä»£ç éƒ½æ˜¯ä½¿ç”¨ç®€å•çš„ ES5è¯­æ³•ï¼Œç„¶ååœ¨çœŸçš„èƒ½æé«˜ä»£ç è´¨é‡çš„åœ°æ–¹ä½¿ç”¨ES6è¯­æ³•ç³–ã€‚ç›¸ä¿¡éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæˆ‘å¯ä»¥æ›´å¿«é€Ÿåœ°è¯†åˆ«ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ES6è€Œä¸æ˜¯ES5ï¼Œä½†åœ¨èµ·æ­¥é˜¶æ®µæœ€å¥½ä¸è¦ è¿‡äºè¿½æ±‚ä½¿ç”¨ES6çš„æ–°ç‰¹æ€§ã€‚å› æ­¤ï¼Œä½ é¦–å…ˆåº”è¯¥ä»”ç»†åˆ†ææœ€é€‚åˆä½ çš„ä»£ç æ˜¯ä»€ä¹ˆï¼Œä¸æ­¤åŒæ—¶ä¹Ÿè€ƒè™‘ä½¿ç”¨ES6ã€‚ â€œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å°±èƒ½æ›´å¥½çš„å­¦ä¹ ä½¿ç”¨è¿™äº›æ–°ç‰¹æ€§ï¼Œè€Œä¸æ˜¯ä»…ä»…å­¦ç‚¹è¯­æ³•ã€‚â€ æ¥ä¸‹æ¥ï¼Œå’±ä»¬å°±å¼€è®²è¿™ä¸ªç‚«é…·ç‰¹æ€§ï¼ ##è§£æ„ è§£æ„æ˜¯ES6ä¸­æœ€å¸¸ç”¨ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„ç‰¹æ€§ä¹‹ä¸€ã€‚å®ƒå…è®¸ä½ å°†æ•°ç»„å’Œå¯¹è±¡çš„å±æ€§èµ‹ç»™ä»»ä½•å˜é‡ã€‚ 123456var foo = &#123; bar: 'pony', baz: 3 &#125;var &#123;bar, baz&#125; = fooconsole.log(bar)// &lt;- 'pony'console.log(baz)// &lt;- 3 è¿™æ ·è·å–å¯¹è±¡ä¸­æŸä¸ªç‰¹å®šå±æ€§å°†ä¼šéå¸¸ç®€æ´ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å°†è¿™ä¸ªå±æ€§èµ‹å€¼ç»™æŸä¸ªå˜é‡ã€‚ 123456var foo = &#123; bar: 'pony', baz: 3 &#125;var &#123;bar: a, baz: b&#125; = fooconsole.log(a)// &lt;- 'pony'console.log(b)// &lt;- 3 ä½ å¯ä»¥è·å–ä»»æ„æ·±åº¦çš„å±æ€§ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥å°†è¿™äº›å±æ€§èµ‹å€¼ç»™å˜é‡ã€‚ 123456var foo = &#123; bar: &#123; deep: 'pony', dangerouslySetInnerHTML: 'lol' &#125; &#125;var &#123;bar: &#123; deep, dangerouslySetInnerHTML: sure &#125;&#125; = fooconsole.log(deep)// &lt;- 'pony'console.log(sure)// &lt;- 'lol' é»˜è®¤æƒ…å†µä¸‹ï¼Œè‹¥è§£æ„ä¸€ä¸ªæœªå®šä¹‰çš„å±æ€§æ—¶ä¼šå¾—åˆ°undefinedï¼Œè¿™ä¸ä½¿ç”¨ç‚¹æˆ–è€…æ‹¬å·å»è®¿é—®å¯¹è±¡çš„å±æ€§æ˜¯ä¸€è‡´çš„ã€‚ 123var &#123;foo&#125; = &#123;bar: 'baz'&#125;console.log(foo)// &lt;- undefined è§£æ„ä¸€ä¸ªä¸å­˜åœ¨çš„çˆ¶çº§å…ƒç´ çš„æ·±å±‚åµŒå¥—çš„å±æ€§æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ 12var &#123;foo:&#123;bar&#125;&#125; = &#123;baz: 'ouch'&#125;// &lt;- Exception å‡å¦‚ä½ è®¤ä¸ºè§£æ„æ˜¯åƒä»¥ä¸‹ES5ä»£ç ä¸­çš„è¯­æ³•ç³–ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼‚å¸¸å°±å¾ˆåˆç†äº†ã€‚ 123var _temp = &#123; baz: 'ouch' &#125;var bar = _temp.foo.bar// &lt;- Exception è§£æ„è¿˜æœ‰ä¸€ä¸ªè¶…é…·ç‰¹æ€§ï¼Œå½“ä½ äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼æ—¶ä¸å†éœ€è¦ä½¿ç”¨è‡­åæ˜­è‘—çš„auxå˜é‡äº†ã€‚ 1234567891011121314151617function es5 () &#123; var left = 10 var right = 20 var aux if (right &gt; left) &#123; aux = right right = left left = aux &#125;&#125;function es6 () &#123; var left = 10 var right = 20 if (right &gt; left) &#123; [left, right] = [right, left] &#125;&#125; è§£æ„å¦ä¸€ä¸ªç‰¹åˆ«æ–¹ä¾¿çš„ç‰¹æ€§æ˜¯keysä¹Ÿå¯ä»¥ä½¿ç”¨è®¡ç®—åå±æ€§åï¼ˆcomputed property namesï¼‰ã€‚ 1234var key = 'such_dynamic'var &#123; [key]: foo &#125; = &#123; such_dynamic: 'bar' &#125;console.log(foo)// &lt;- 'bar' è¿™åœ¨ES5ä¸­ï¼Œä½ å¾—ç”¨ä¸€ä¸ªé¢å¤–çš„è¯­å¥ä¸ä¸´æ—¶å˜é‡æ¥å®ç°ã€‚ 1234var key = 'such_dynamic'var baz = &#123; such_dynamic: 'bar' &#125;var foo = baz[key]console.log(foo) å½“ä½ è¦è§£æ„çš„å±æ€§æ˜¯undefinedæ—¶ä½ å¯ä»¥æä¾›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ 123456789var &#123;foo=3&#125; = &#123; foo: 2 &#125;console.log(foo)// &lt;- 2var &#123;foo=3&#125; = &#123; foo: undefined &#125;console.log(foo)// &lt;- 3var &#123;foo=3&#125; = &#123; bar: 2 &#125;console.log(foo)// &lt;- 3 æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œè§£æ„åœ¨æ•°ç»„ä¸­ä¹Ÿå¯ä»¥å·¥ä½œã€‚æ³¨æ„æˆ‘åœ¨å£°æ˜å˜é‡æ—¶ä½¿ç”¨äº†æ–¹æ‹¬å·ã€‚ 123var [a] = [10]console.log(a)// &lt;- 10 æ•°ç»„è§£æ„ä¸å¯¹è±¡è§£æ„ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ 123456789var [a] = []console.log(a)// &lt;- undefinedvar [b=10] = [undefined]console.log(b)// &lt;- 10var [c=10] = []console.log(c)// &lt;- 10 åœ¨æ•°ç»„è§£æ„ä¸­ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è·³è¿‡è¢«è§£æ„æ•°ç»„ä¸­é‚£äº›ä½ ä¸å…³å¿ƒçš„å…ƒç´ ã€‚ 12345var [,,a,b] = [1,2,3,4,5]console.log(a)// &lt;- 3console.log(b)// &lt;- 4 åœ¨ä¸€ä¸ªfunctionçš„å‚æ•°åˆ—è¡¨ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„ã€‚ 1234567function greet (&#123; age, name:greeting='she' &#125;) &#123; console.log(`$&#123;greeting&#125; is $&#123;age&#125; years old.`)&#125;greet(&#123; name: 'nico', age: 27 &#125;)// &lt;- 'nico is 27 years old'greet(&#123; age: 24 &#125;)// &lt;- 'she is 24 years old' æŒæ¡ä»¥ä¸ŠçŸ¥è¯†ç‚¹ä½ å°±çŸ¥é“å¦‚ä½•ä½¿ç”¨è§£æ„äº†ã€‚é‚£è§£æ„æœ‰ä½•ç”¨å‘¢ï¼Ÿ è§£æ„çš„åº”ç”¨åœºæ™¯è§£æ„åœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½èƒ½æ´¾ä¸Šç”¨åœºã€‚ä¸‹é¢æˆ‘ä¾‹ä¸¾ä¸€äº›æœ€å¸¸ç”¨çš„åœºæ™¯ã€‚é¦–å…ˆï¼Œæˆ‘ä½¿ç”¨æœ€å¤šçš„ä¸€ä¸ªåœºæ™¯æ˜¯ï¼Œåœ¨è®¸å¤šæ¨¡å—é¡¶éƒ¨çš„importå£°æ˜ä¸­ï¼Œè§£æ„å¯ä»¥ä»æ¨¡å—çš„å…¬å…±APIä¸­åªåŠ è½½ä½ éœ€è¦çš„æ¨¡å—ã€‚ä¸¾ä¸ªcontraçš„ä¾‹å­ï¼š 1234import &#123;series, concurrent, map &#125; from 'contra'series(tasks, done)concurrent(tasks, done)map(items, mapper, done) ç¬¬äºŒä¸ªåœºæ™¯ï¼Œå½“ä½ çš„æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè§£æ„ä¹Ÿè®©èµ‹å€¼å˜å¾—éå¸¸ç®€æ´ã€‚ 1234567891011function getCoords () &#123; return &#123; x: 10, y: 22 &#125;&#125;var &#123;x, y&#125; = getCoords()console.log(x)// &lt;- 10console.log(y)// &lt;- 22 ä¸¾ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä½¿ç”¨è§£æ„çš„ä¾‹å­ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•çš„å‚æ•°éƒ½æ˜¯å¯é€‰ä¸”éœ€è®¾é»˜è®¤å€¼çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨è§£æ„ã€‚è¿™ä¸å…¶ä»–è¯­è¨€ä¸­ï¼ˆä¾‹å¦‚Pythonæˆ–è€…C#ï¼‰çš„å¯é€‰å‘½åå‚æ•°ä¸€æ ·éƒ½æå…¶æœ‰æ„æ€ã€‚ 1234567function random (&#123; min=1, max=300 &#125;) &#123; return Math.floor(Math.random() * (max - min)) + min&#125;console.log(random(&#123;&#125;)) //å¿…é¡»è¾“å…¥&#123;&#125;ï¼Œå¦åˆ™æŠ¥é”™// &lt;- 174console.log(random(&#123;max: 24&#125;))// &lt;- 18 å¦‚æœä½ æƒ³è®©å¯é€‰å¯¹è±¡å˜æˆçœŸæ­£çš„å…¨éƒ¨å¯é€‰ï¼Œä½ å¯ä»¥å°†ä»£ç ä¿®æ”¹å¦‚ä¸‹ã€‚ 12345function random (&#123; min=1, max=300 &#125; = &#123;&#125;) &#123; return Math.floor(Math.random() * (max - min)) + min&#125;console.log(random()) //å¯ä»¥ä¸è¾“å…¥&#123;&#125;// &lt;- 133 è§£æ„å¦å¤–ä¸€ä¸ªéå¸¸é€‚åˆä½¿ç”¨çš„åœºæ™¯å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½ åªè¦å®šä¹‰å˜é‡æ¥æ”¶è¿”å›å€¼ï¼Œä¸å†éœ€è¦ä¾èµ–æ•°ç»„ç´¢å¼•å†å–ä¸€éã€‚è¿™é‡Œæœ‰ä¸€ä¸ªStackOverflowä¸Šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è§£æURLçš„ä¾‹å­ã€‚ 1234567891011121314function getUrlParts (url) &#123; var magic = /^(https?):\\/\\/(ponyfoo\\.com)(\\/articles\\/([a-z0-9-]+))$/ return magic.exec(url)&#125;var parts = getUrlParts('http://ponyfoo.com/articles/es6-destructuring-in-depth')var [,protocol,host,pathname,slug] = partsconsole.log(protocol)// &lt;- 'http'console.log(host)// &lt;- 'ponyfoo.com'console.log(pathname)// &lt;- '/articles/es6-destructuring-in-depth'console.log(slug)// &lt;- 'es6-destructuring-in-depth' åŸæ–‡é“¾æ¥ï¼šES6 JavaScript Destructuring in Depth è¯‘è€… @zhouweicsu","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://zhouweicsu.github.io/blog/tags/ES6/"},{"name":"Destructuring","slug":"Destructuring","permalink":"http://zhouweicsu.github.io/blog/tags/Destructuring/"}]},{"title":"ã€Œè¯‘ã€CoffeeScriptä¸‡å²ï¼ES6ä¸‡å²ï¼","date":"2015-04-14T16:00:00.000Z","path":"2015/04/15/long-live-coffeescript-and-es6/","text":"æ˜¾ç„¶ES6å¯¹ES5æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ”¹è¿›ï¼Œå¹¶ä¸”6to5è¿™ç±»å·¥å…·ä½¿æˆ‘ä»¬å¯ä»¥å¼€å§‹ä½¿ç”¨è¿™äº›é…·æ¯™äº†çš„ç‰¹æ€§ã€‚æˆ‘ä¹‹å‰é˜…è¯»äº†Blake Williamsçš„ä¸€ç¯‡æ–‡ç« Replace CoffeeScript with ES6 ï¼ˆã€è¯‘ã€‘ç”¨ES6æ›¿ä»£CoffeeScriptï¼‰ ï¼Œæ–‡ç« å¯¹ES6å¦‚ä½•è§£å†³è®¸å¤šCoffeeScriptè§£å†³äº†çš„é—®é¢˜åšäº†ä¸€ä¸ªéå¸¸å¥½çš„æ€»ç»“ï¼›ç„¶è€Œï¼Œæˆ‘æƒ³å°±Blakeçš„å‡ ä¸ªè§‚ç‚¹åšç‚¹è¯„è®ºï¼Œå¹¶è°ˆè°ˆä¸ºä»€ä¹ˆæˆ‘å°†ä¼šç»§ç»­ä½¿ç”¨CoffeeScriptã€‚ ç±»ES6ä¸­çš„ç±»ï¼ˆè¿˜æœ‰å…¶ä»–ES6ä¸­çš„è¯­æ³•å˜åŒ–ï¼‰ä¸CoffeeScriptçš„éå¸¸ç›¸ä¼¼ã€‚ä¸ºäº†æ”¯æŒES5ä¸­ä¸å…¼å®¹çš„æµè§ˆå™¨ï¼ˆä¾‹å¦‚IE8-ï¼‰ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶ä¸èƒ½çœŸæ­£çš„ä½¿ç”¨getters/settersï¼Œæ‰€ä»¥å¿½ç•¥è¿™äº›ï¼Œæ¯”è¾ƒå¦‚ä¸‹ï¼š 123456789101112131415class Person constructor: (@firstName, @lastName) -&gt; name: -&gt; \"#&#123;@firstName&#125; #&#123;@lastName&#125;\" setName: (name) -&gt; [@firstName, @lastName] = name.split \" \" @defaultName: -&gt; \"Unidentified Person\"blake = new Person \"Blake\", \"Williams\"blake.setName \"Blake Anderson\"console.log blake.name() vs 12345678910111213141516171819202122class Person &#123; constructor(firstName, lastName) &#123; this.firstName = firstName; this.lastName = lastName; &#125; name() &#123; return `$&#123;this.firstName&#125; $&#123;this.lastName&#125;`; &#125; setName(name) &#123; [this.firstName, this.lastName] = name.split(\" \"); &#125; static defaultName() &#123; return \"Unidentified Person\" &#125;&#125;var blake = new Person(\"Blake\", \"Williams\");blake.setName(\"Blake Anderson\");console.log(blake.name()); æˆ‘ç»å¯¹å–œæ¬¢ES6çš„é£æ ¼â€”â€”æ— éœ€é€—å·ï¼Œä¸éœ€è¦åˆ°å¤„å†™functionï¼›ä½†æ˜¯æˆ‘æ˜¯â€œwrite less codeâ€æ´¾ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯é€‰æ‹©å‰è€…ã€‚ç„¶è€Œï¼Œè¿™çœŸçš„æ˜¯ä¸ªäººå“å‘³é—®é¢˜ï¼Œå¦‚æœä½ å–œæ¬¢this.è€Œä¸æ˜¯@ï¼Œå–œæ¬¢æ·»åŠ æ‰€æœ‰é¢å¤–çš„å¤§æ‹¬å·ï¼Œé‚£ä¹ˆè¿™æ¯«æ— ç–‘é—®ä½ æ˜¯æ”¯æŒBlakeçš„è§‚ç‚¹çš„ï¼Œè®¤ä¸ºES6æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚ è™½ç„¶æˆ‘èƒ½ç†è§£ä¸ºä»€ä¹ˆES6å…è®¸ä½ è°ƒç”¨çˆ¶å¯¹è±¡çš„ä¸€ç§ä¸åŒçš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯å¾—è¯´æˆ‘æ›´å–œæ¬¢CoffeeScriptä¸­superçš„å®ç°ã€‚ å­—ç¬¦ä¸²æ’å€¼å¾ˆæ˜¾ç„¶ES6ä¸CoffeeScriptä¸­çš„å­—ç¬¦ä¸²æ’å€¼éå¸¸ç›¸ä¼¼ï¼›CoffeeScriptçš„å­—ç¬¦ä¸²æ’å€¼ä½¿ç”¨å¸¸è§„çš„â€œstringsâ€ï¼ŒES6ä½¿ç”¨`åŒ…è£¹å­—ç¬¦ä¸²ï¼ˆåæ§½ï¼šè¿™å¯¼è‡´åœ¨å†™Markdownçš„æ—¶å€™ç›¸å½“çƒ¦äººï¼‰ã€‚CoffeeScriptä½¿ç”¨#{var}ï¼ŒES6ä½¿ç”¨${var}ã€‚è¿™äº›ç‚¹éƒ½å¤§åŒå°å¼‚ã€‚ çœŸæ­£çªå‡ºçš„å·®åˆ«æ˜¯å¯¹ç©ºç™½çš„å¤„ç†â€”â€”ES6ï¼ˆæˆ–è€…è‡³å°‘æ˜¯6to5å·¥å…·ï¼‰ä¼šä¿ç•™æ‰€æœ‰ä½äº` ä¹‹é—´çš„ç©ºæ ¼ï¼ˆåŒ…æ‹¬æ¢è¡Œå’Œç¼©è¿›ï¼‰ï¼ŒCoffeeScriptçš„å¤„ç†æ—¶ä½äºç®€å•&quot;ä¸­çš„å­—ç¬¦ä¸²ä¼šå°†æ‰€æœ‰ç©ºç™½åˆå¹¶æˆä¸€ä¸ªç©ºæ ¼ï¼Œè‹¥æ˜¯ä½äº&quot;&quot;&quot;ä¹‹é—´çš„å—çº§å­—ç¬¦ä¸²åˆ™ä¿ç•™æ‰€æœ‰ç©ºæ ¼ç”¨æ¥ç¼©è¿›ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™ä¸¤è€…çš„è¡Œä¸ºéƒ½æ˜¯å€¼å¾—ä¿ç•™çš„ï¼Œç„¶è€ŒES6çš„å¤„ç†å´æ²¡æœ‰åˆ†åˆ«å¤„ç†ï¼Œä¸¾ä¸ªæ —å­ï¼š 123456789(function() &#123; function foo(bar, val) &#123; if (bar) &#123; var str = `This is quite a long first line so I wrap it to a second line and then append the value $&#123;val&#125;`; &#125; &#125;&#125;)(); é€šè¿‡6to5 REPLçš„è½¬åŒ–è¾“å‡ºæ˜¯ï¼š 1var str = \"This is quite a long first line\\n so I wrap it to a second line and then\\n append the value \" + val; ç­‰ä»·çš„CoffeeScriptä»£ç ï¼š 123456789101112do -&gt; foo = (bar, val) -&gt; if bar str = &quot;This is quite a long first line so I wrap it to a second line and then append the value #&#123;val&#125;&quot;; str2 = &quot;&quot;&quot; This is quite a long first line so I wrap it to a second line and then append the value #&#123;val&#125; &quot;&quot;&quot; ç¼–è¯‘ä¹‹åï¼š 12var str = \"This is quite a long first line so I wrap it to a second line and then append the value \" + val;var str2 = \"This is quite a long first line\\nso I wrap it to a second line and then\\nappend the value \" + val; æˆ‘å®åœ¨æƒ³ä¸å‡ºä¸€ä¸ªèƒ½è®©æˆ‘é€‰æ‹©6to5çš„ç†ç”±ã€‚ èƒ–ç®­å¤´ï¼Œé»˜è®¤å‚æ•°è¿™ä¸¤é¡¹æ˜¯å¯¹JSè¯­æ³•çš„æ°å‡ºæ‰©å±•ï¼ŒES6çš„è¡¨ç°ä¸CoffeeScriptå¤§è‡´ç›¸åŒï¼Œåªæœ‰å°‘é‡è¯­æ³•ä¸åŒã€‚ å‚æ•°åˆ—è¡¨ï¼ˆsplatsï¼‰å¦ä¸€ä¸ªæ°å‡ºæ‰©å±•ï¼Œæˆ‘å‘ç°å‚æ•°åˆ—è¡¨(splats)è¿™ä¸ªæŠ€èƒ½åœ¨å‚æ•°åˆ—çš„ä¸­é—´éå¸¸ æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨Node.jsé£æ ¼çš„å›è°ƒå‡½æ•°çš„æƒ…å†µä¸‹ï¼Œå›è°ƒå‡½æ•°å¯ä»¥è‡ªåŠ¨å¼¹å‡ºç„¶åé€€å‡ºã€‚ä¸¾ä¸ªæ —å­ï¼š 1234567891011121314# Splat dereferencingnames = [\"Alice\", \"Belinda\", \"Catherine\", \"Davidson\"][firstName, middleNames..., lastName] = names# Splat function args preserving callbackfoo = (fn, args..., callback) -&gt; results = (fn arg for arg in args) process.nextTick -&gt; callback null, resultsdouble = (a) -&gt; a * 2foo double, 80, 60, 40, (err, results) -&gt; console.log results é—æ†¾çš„æ˜¯ï¼ŒES6ä¸­åªå…è®¸splatsä½äºå‚æ•°åˆ—çš„æœ€åï¼Œå¦‚æœéœ€è¦ä½ åªèƒ½ä½¿ç”¨pop()å‡½æ•°æ¥å–å›è°ƒï¼ˆæˆ–å§“æ°ï¼‰ï¼Œè®©ä½ çš„ä»£ç å˜å¾—å¾ˆé•¿ï¼Œè®©ä½ é€‰æ‹©æ›´å¤šå˜é‡åï¼ˆæˆ‘ä»¬éƒ½å¾ˆè®¨åŒé€‰å˜é‡åï¼Œä¸æ˜¯å—ï¼Ÿï¼‰ï¼š 12345var names = [\"Alice\", \"Belinda\", \"Catherine\", \"Davidson\"];var firstName, middleNames, lastName, rest;[firstName, ...rest] = names;lastName = rest.pop();middleNames = rest; æ„é€ /è§£æ„å‡½æ•°æˆ‘å¿…é¡»æ‰¿è®¤æˆ‘å¾ˆå–œæ¬¢ES6çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯åœ¨ä½ å†™var [first, , last] = [1, 2, 3]èµ‹å€¼è¯­å¥æ—¶å¯ä»¥ä½¿ç”¨çœŸæ­£çš„ç©ºæ ¼ï¼Œä½†æ˜¯ç”¨ä¸‹åˆ’çº¿æˆ–å…¶ä»–ç±»ä¼¼å­—ç¬¦ä¹Ÿå¯ä»¥æ˜¯ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ ES6ä¸­å¯¹è±¡çš„æ„é€ /è§£æ„å‡½æ•°ä¸CoffeeScriptå‡ ä¹ä¸€æ ·ï¼ˆvar {a, b} = {a: 1, c:3}ï¼Œ var {foo: a, bar: b} = {foo: 1, baz: 3}ï¼Œ è¿˜æœ‰var c = {a, b}ï¼‰ï¼Œä½†å½“å¼•ç”¨å½“å‰å¯¹è±¡çš„å±æ€§æ—¶ï¼ŒCoffeeScriptçš„åšæ³•æ›´å¥½ï¼Œå¦‚c = {@a, @b}ï¼ˆvar c = {a: this.a, b: this.b}ï¼‰ã€‚ ä¸€äº›æˆ‘å¸Œæœ›CoffeeScriptæ‹¥æœ‰çš„ES6ç‰¹æ€§å°è¯•å°†CoffeeScriptæç»˜æˆä¸€ä¸ªå®Œç¾çš„è¯­è¨€æ˜¯ä¸æ˜æ™ºçš„ï¼Œå®ƒæ˜¾ç„¶ä¸æ˜¯ï¼Œå®ƒä¹Ÿæœ‰ç¼ºç‚¹ï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªCoffeeScriptä¸­æ²¡æœ‰ä½†ES6ï¼ˆç”šè‡³ES3ï¼‰ä¸­æœ‰çš„ç‰¹æ€§åˆ—è¡¨ï¼š ä¸‰å…ƒæ“ä½œç¬¦a ? b : cï¼ˆif a then b else cå¯¹æˆ‘æ¥è¯´å¤ªé•¿äº†ï¼Œæˆ‘æ˜¯å†³ä¸ä¼šæ”¾å¼ƒï¼Ÿæ“ä½œç¬¦çš„ï¼ï¼‰ è®¡ç®—ï¼ˆåŠ¨æ€ï¼‰å˜é‡åï¼š{[getKey()]: getValue()}ï¼ˆå‚è€ƒStackOverflow answerï¼Œä»¥åŠä¸€äº›æœ‰è¶£çš„å†å²ï¼‰ ç»“æŸè¯­æ€»çš„æ¥è¯´ES6å¯¹JavaScriptæ¥è¯´æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„é£è·ƒï¼Œéå¸¸æ„Ÿè°¢æ‰€æœ‰è®©è¿™äº›æˆä¸ºå¯èƒ½çš„å¼€å‘è€…ã€‚ä»¥ä¸ŠæœªæåŠçš„è®¸å¤šES6æ–°å¢çš„ç‰¹æ€§éƒ½æ²¡æœ‰æ¶‰åŠè¯­æ³•å˜åŒ–ï¼Œå› æ­¤CoffeeScriptä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚Proxiesï¼ŒWeakMapsç­‰ã€‚ï¼ˆæˆ‘ä»¬ç°åœ¨ç”šè‡³è¿˜æœ‰yieldï¼‰ã€‚ æˆ‘è¿˜æ˜¯ä¼šåšæŒé€‰æ‹©ä½¿ç”¨CoffeeScriptçš„è¯­æ³•ï¼Œå› ä¸ºå®ƒç®€æ˜æ˜“è¯»ï¼Œå¤§å¤§æé«˜äº†æˆ‘çš„å·¥ä½œæ•ˆç‡ã€‚æˆ‘ä¹Ÿå¾ˆéš¾æ”¾å¼ƒå„ç§CoffeeScriptçš„è¯­æ³•ç³–ï¼Œä¾‹å¦‚ï¼šobject?.propertyï¼Œå½“objectæ˜¯nullæˆ–è€…undefinedçš„æ—¶å€™ä¸ä¼šæŠ¥é”™ï¼›a ?= bï¼Œa ||= bç­‰ï¼›éšå¼è¿”å›ï¼›unlessï¼›å‡çº§ç‰ˆswitchï¼›èŒƒå›´ç¼©å†™[a..b];array/stringåˆ©ç”¨èŒƒå›´arr[2..6]æ¥åˆ‡å‰²ï¼›for own k, v of objï¼›é“¾å¼æ¯”è¾ƒ a &lt; b &lt; cï¼›å—çº§æ­£åˆ™è¡¨è¾¾å¼ï¼›è¿˜æœ‰æ›´å¤šï¼ CoffeeScriptä¸‡å²ï¼ES6ä¸‡å²ï¼åŸæ–‡é“¾æ¥ï¼šLong Live CoffeeScript and Long Live ES6 è¯‘è€… @zhouweicsu 2015 å¹´ 4æœˆ 15æ—¥","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://zhouweicsu.github.io/blog/tags/ES6/"},{"name":"CoffeeScript","slug":"CoffeeScript","permalink":"http://zhouweicsu.github.io/blog/tags/CoffeeScript/"}]},{"title":"ã€Œè¯‘ã€ç”¨ ES6 æ›¿ä»£ CoffeeScript","date":"2015-03-11T16:00:00.000Z","path":"2015/03/12/replace-coffeescript-with-es6/","text":"ä¸€ç›´ä»¥æ¥æˆ‘éƒ½åœ¨å…³æ³¨å’Œç ”ç©¶JavaScriptçš„ä¸‹ä¸€ä¸ªç‰ˆæœ¬â€”â€”ES6ï¼Œå¹¶ç»ˆäºåœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ç”¨äº†å®ƒã€‚åœ¨çŸ­æš‚çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°ES6è§£å†³äº†è®¸å¤šCoffeeScriptå°è¯•ä¸å»å¤§é‡ä¿®æ”¹è¯­æ³•æƒ³è§£å†³çš„é—®é¢˜ã€‚ å¦‚ä½•ä½¿ç”¨ES6æˆ‘ä»¬å¯ä»¥é€šè¿‡6to5è¿™ä¸ªé¡¹ç›®å¼€å§‹ä½¿ç”¨ES6,6to5å¯ä»¥å°†ES6ä»£ç è½¬è¯‘æˆç¬¦åˆES5æ ‡å‡†çš„ä»£ç ã€‚6to5æ”¯æŒæ•°é‡ä¼—å¤šçš„æ„å»ºå·¥å…·ï¼ŒåŒ…æ‹¬Broccoliï¼ŒGruntï¼ŒGulpï¼Œå’ŒSprocketsã€‚æˆ‘åœ¨ä½¿ç”¨sprockets-es6ä¸Šæœ‰è®¸å¤šæˆåŠŸçš„ç»éªŒï¼Œå¹¶ä¸”Sprockets 4.xç‰ˆæœ¬å°†ä¼šéå¸¸å¥½çš„æ”¯æŒ6to5ã€‚ å¦‚æœä½ ä½¿ç”¨Vimç¼–è¾‘å™¨çš„è¯ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡å°†å¦‚ä¸‹ä»£ç åŠ å…¥ä½ çš„.vimrcæ–‡ä»¶ï¼Œä»è€Œå°†å¸¦.es6æ‰©å±•åçš„æ–‡ä»¶ä¸JavaScriptå…³è”èµ·æ¥ã€‚ 1autocmd BufRead,BufNewFile *.es6 setfiletype javascript ä½ ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨6to5 REPLæ¥ç¼–å†™ES6ä»£ç ã€‚ ç±»CoffeeScriptä¸ES6éƒ½æ”¯æŒç±»ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸‹CoffeeScriptç±»ä¸ç›¸åŒåŠŸèƒ½çš„ES6ç±»çš„å¯¹æ¯”ã€‚ CoffeeScriptæœ‰å¯ä»¥åˆ©ç”¨çš„ä¸‰ä¸ªä¼˜åŠ¿ï¼šå‚æ•°åˆ—è¡¨ä½¿ç”¨å®ä¾‹å˜é‡ï¼Œå­—ç¬¦ä¸²æ’å€¼ï¼Œå‡½æ•°è°ƒç”¨ä¸éœ€è¦æ‹¬å·ã€‚ 123456789101112131415class Person constructor: (@firstName, @lastName) -&gt; name: -&gt; \"#&#123;@first_name&#125; #&#123;@last_name&#125;\" setName: (name) -&gt; names = name.split \" \" @firstName = names[0] @lastName = names[1]blake = new Person \"Blake\", \"Williams\"blake.setName(\"Blake Anderson\")console.log blake.name() ES6æˆ‘ä»¬å¯ä»¥ä½¿ç”¨classesã€getterså’Œsettersï¼š 123456789101112131415161718192021class Person &#123; constructor(firstName, lastName) &#123; this.firstName = firstName; this.lastName = lastName; &#125; get name() &#123; return this.firstName + &quot; &quot; + this.lastName; &#125; set name(name) &#123; var names = name.split(&quot; &quot;); this.firstName = names[0]; this.lastName = names[1]; &#125;&#125;var blake = new Person(&quot;Blake&quot;, &quot;Williams&quot;);blake.name = &quot;Blake Anderson&quot;console.log(blake.name); å¦‚æœä½ ä½¿ç”¨è¿‡ä»»ä½•æä¾›ç±»æœºåˆ¶çš„javascriptåº“æˆ–æ¡†æ¶ï¼Œä½ ä¼šå‘ç°ES6çš„è¯­æ³•æœ‰ä¸€ç‚¹ç‚¹ä¸åŒä¹‹å¤„ï¼š å‡½æ•°åä¹‹åæ²¡æœ‰åˆ†å· å…³é”®å­—functionè¢«çœç•¥äº† æ¯ä¸ªå®šä¹‰ä¹‹åéƒ½æ²¡æœ‰é€—å·äº† æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨getterså’Œsettersæ–¹æ³•è®©ä½¿ç”¨nameæ–¹æ³•åƒå±æ€§é‚£æ ·æ–¹ä¾¿ã€‚ å­—ç¬¦ä¸²æ’å€¼æˆ‘ä¸€ç›´å¸Œæœ›JavaScriptèƒ½å¤Ÿæ‹¥æœ‰æ›´åŠ æœ‰æ–¹ä¾¿çš„å­—ç¬¦ä¸²è¯­æ³•ã€‚å¹¸è¿åœ°æ˜¯ES6æ–°åŠ äº†template stringsã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ¯”è¾ƒä¸€ä¸‹CoffeeScript stringsï¼ŒJavaScript stringsï¼Œå’Œtemplate stringsï¼Œçœ‹çœ‹ä»–ä»¬çš„èƒ½åŠ›ã€‚ CoffeeScript: 1234\"CoffeeScript allows multi-line stringswithinterpolation like 1 + 1 = #&#123;1 + 1&#125;\" JavaScript strings: 12\"JavaScript strings can only span a single line \" + \"and interpolation isn't possible\" ES6 template strings: 123`Template strings allow strings to spanmultiple lines and allow interpolation like 1 + 1 = $&#123;1 + 1&#125;` æˆ‘ä»¬å¯ä»¥åœ¨å‰æ–‡ç»™å‡ºçš„ä¾‹å­ä¸­ä½¿ç”¨template stringsï¼Œå°†nameçš„getteræ–¹æ³•æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š 123get name() &#123; return `$&#123;this.firstName&#125; $&#123;this.lastName&#125;`;&#125; è¿™æ¯”ä¹‹å‰çš„å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼çœ‹èµ·æ¥æ¸…çˆ½å¤šäº†ï¼Œå¹¶ä¸”çœ‹èµ·æ¥æ›´åŠ åƒCoffeeScriptã€‚ èƒ–ç®­å¤´å¦ä¸€ä¸ªCoffeeScriptä¸­å¾ˆå¸å¼•äººçš„ç‰¹æ€§åœ¨ES6ä¸­ä¹Ÿæœ‰æ–°å¢ï¼Œé‚£å°±æ˜¯èƒ–ç®­å¤´ã€‚èƒ–ç®­å¤´å¯ä»¥å°†å‡½æ•°ä¸å½“å‰ä¸Šä¸‹æ–‡çš„thiså€¼ç»‘å®šèµ·æ¥ã€‚é¦–å…ˆï¼Œè®©æˆ‘çœ‹çœ‹ä¸ä½¿ç”¨èƒ–ç®­å¤´å‡½æ•°æ˜¯å¦‚ä½•å¤„ç†thisçš„ã€‚ åœ¨ES5ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°å‰å¿…é¡»ç”¨ä¸€ä¸ªå˜é‡æ¥ä¿å­˜å½“å‰çš„thiså€¼ï¼š 12345var self = this;$(&quot;button&quot;).on(&quot;click&quot;, function() &#123; // do something with self&#125;); CoffeeScriptä¸­ä½¿ç”¨èƒ–ç®­å¤´ï¼Œå¹¶ä¸”å¯ä»¥çœç•¥å‚æ•°å’ŒèŠ±æ‹¬å·ï¼š 12$(&quot;button&quot;).on&quot;click&quot;, =&gt; # do something with this åœ¨ES6ä¸­ï¼ŒèŠ±æ‹¬å·æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯å‚æ•°å¯ä»¥çœç•¥ï¼š 123$(&quot;button&quot;).on(&quot;click&quot;, () =&gt; &#123; // do something with this&#125;); å…¶ä»–ç‰¹æ€§ES6æœ‰ä¸€äº›å…¶ä»–çš„ç‰¹æ€§å€¼å¾—é¡ºä¾¿æä¸€ä¸‹ã€‚ é»˜è®¤å‚æ•°CoffeeScriptï¼š 12hello = (name = \"guest\") -&gt; alert(name) ES6: 123var hello = function(name = &quot;guest&quot;)&#123; alert(name);&#125; å‚æ•°åˆ—è¡¨ï¼ˆsplatsï¼‰å˜é•¿å‚æ•°å‡½æ•°ï¼ŒCoffeeScriptç§°ä¹‹ä¸ºå‚æ•°åˆ—è¡¨ï¼ˆsplatsï¼‰ï¼Œå…è®¸æ”¶é›†é™„åŠ å‚æ•°ä¼ é€’ç»™å‡½æ•°ä½œä¸ºä¸€ä¸ªæ•°ç»„ã€‚ES6ä¸­ç§°ä¹‹ä¸ºå…¶ä»–å‚æ•°ã€‚ CoffeeScript: 1234awards = (first, second, others...) -&gt; gold = first silver = second honorable_mention = others ES6: 12345var awards = function(first, second, ...others) &#123; var gold = first; var silver = second; var honorableMention = others;&#125; è§£æ„èµ‹å€¼è§£æ„èµ‹å€¼å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ã€‚ CoffeeScript: 1[first, _, last] = [1, 2, 3] ES6: 1var [first, , last] = [1, 2, 3] æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼å°†ä¹‹å‰å®šä¹‰çš„nameçš„setterå‡½æ•°ä»£ç æ›´åŠ ç®€æ´ï¼š 123set name(name) &#123; [this.firstName, this.lastName] = name.split(&quot; &quot;);&#125; ç»“æŸè¯­è®¸å¤šES6è½¬è¯‘å·¥å…·å·²ç»åœ¨ç§¯æçš„å¼€å‘ä¸­ï¼ŒåŠŸèƒ½ä¸Šå·²ç»å¯ä»¥è¿½ä¸ŠCoffeeScriptäº†ã€‚æœ¬æ–‡ä»…ä»…ä»‹ç»äº†æå°‘æ•°JavaScriptçš„æ–°ç‰¹æ€§ï¼Œä½†æ˜¯ç‚¹å‡»è¿™é‡Œæ‰¾åˆ°æ›´å¤šæ–°ç‰¹æ€§ã€‚ ä¸‹ä¸ªé¡¹ç›®æŠŠCoffeeScriptæ”¾ä¸€è¾¹ï¼Œè¯•ä¸€è¯•ES6å§ï¼ åŸæ–‡é“¾æ¥ï¼šReplace CoffeeScript with ES6 è¯‘è€… @zhouweicsu2015 å¹´ 3æœˆ 15æ—¥","tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhouweicsu.github.io/blog/tags/JavaScript/"},{"name":"ES6","slug":"ES6","permalink":"http://zhouweicsu.github.io/blog/tags/ES6/"},{"name":"CoffeeScript","slug":"CoffeeScript","permalink":"http://zhouweicsu.github.io/blog/tags/CoffeeScript/"}]},{"title":"doT æ¨¡æ¿ä¸­ç›´æ¥å†™ Javascript ä»£ç å¯¼è‡´ Uncaught SyntaxError Unexpected identifier","date":"2015-01-13T16:00:00.000Z","path":"2015/01/14/doT-template-SyntacError/","text":"åœ¨ä½¿ç”¨ doT çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºé¡¹ç›®éœ€è¦ï¼Œæˆ‘ä»¬å°†ç”µè¯å·ç æ‹¼æˆäº†ä»¥é€—å·åˆ†å¼€çš„å­—ç¬¦ä¸² 1234/** åˆå§‹jsonå¯¹è±¡ **/ var data = &#123; tel:'4008107107,4008107106' &#125; è€Œé¡µé¢ä¸­éœ€è¦æ˜¾ç¤ºç‹¬ç«‹çš„ç”µè¯å·ç ï¼Œè¿™å°±éœ€è¦åœ¨ doT æ¨¡æ¿æ¸²æŸ“ä¸­ä½¿ç”¨ Javascript çš„ split æ–¹æ³•ï¼Œå°†å­—ç¬¦ä¸²è§£ææˆæ•°ç»„ã€‚ 1234/** ç›®æ ‡jsonå¯¹è±¡ **/ var data = &#123; tel:[4008107107,4008107106] &#125; æˆ‘ä»¬çŸ¥é“ï¼ŒdoT çš„åŸç†å°±æ˜¯å°†æ•´ä¸ªçš„æ¨¡æ¿ html ä»£ç æ”¾åœ¨&lt;script&gt;&lt;/script&gt;æ ‡ç­¾ä¸­ï¼Œç„¶åç”Ÿæˆä¸€æ®µå¯æ‰§è¡Œçš„ Javascript ä»£ç ï¼Œç„¶åå°† JSON æ ¼å¼çš„æ•°æ®ä¼ å…¥è¯¥å‡½æ•°ï¼Œreturn ç”Ÿæˆçš„htmlä»£ç ï¼Œè€Œ doT åœ¨ç”Ÿæˆå¯æ‰§è¡Œ Javascript ä»£ç ç‰‡æ®µçš„è¿‡ç¨‹ä¸­å…¶å®å°±æ˜¯å­—ç¬¦ä¸²çš„è§£æä¸æ‹¼æ¥ã€‚ 12/**doTä¸­ç›´æ¥å†™Javascriptä»£ç **/&#123; &#123; it.tel = it.tel.split(&apos;,&apos;) &#125; &#125; å†™æˆä¸Šé¢è¿™æ ·å­ï¼Œé¡µé¢æ¸²æŸ“ä¼šæŠ¥é”™Uncaught SyntaxError: Unexpected identifierå› ä¸ºåœ¨ç”ŸæˆJavascriptä»£ç ç‰‡æ®µæ—¶è¯¥æ®µJSä»£ç è¢«è§£æå­—ç¬¦ä¸² 1it.tel = it.tel.split(&apos;,&apos;) ä¸åä¸€å¥å¯æ‰§è¡Œçš„JSä»£ç out += &#39;&#39;;æ‹¼æ¥ä¹‹åå˜æˆ 1it.tel = it.tel.split(&apos;,&apos;) out += &apos;&apos;; doTæ— æ³•åƒJavascriptè§£æå™¨ä¸€æ ·è‡ªåŠ¨è¡¥å…¨åˆ†å·ï¼Œè¿™å°±å¯¼è‡´äº†ä¸Šé¢çš„é”™è¯¯å‘ç”Ÿã€‚ è§£å†³æ–¹æ³•åŠ ä¸Šåˆ†å·å°±å¥½äº† 1&#123; &#123; it.tel = it.tel.split(&apos;,&apos;); &#125; &#125; ç”±äºdoTä¸­2ä¸ª{}å¥—åœ¨ä¸€èµ·æ— æ³•è¢«è§£æï¼Œæ‰€ä»¥åœ¨ä¸¤ä¸ªèŠ±æ‹¬å·ä¹‹é—´åŠ å…¥å¼•å· ä½œè€… @zhouweicsu","tags":[{"name":"template","slug":"template","permalink":"http://zhouweicsu.github.io/blog/tags/template/"},{"name":"doT","slug":"doT","permalink":"http://zhouweicsu.github.io/blog/tags/doT/"},{"name":"åˆ†å·","slug":"åˆ†å·","permalink":"http://zhouweicsu.github.io/blog/tags/åˆ†å·/"}]},{"title":"ã€Œè¯‘ã€æ‰‹æœºæµè§ˆå™¨ä¸‹è§¦å‘touchcanceläº‹ä»¶çš„æ“ä½œ","date":"2014-12-08T16:00:00.000Z","path":"2014/12/09/trigger-touchcancel-in-mobile-browsers/","text":"Touchcanceläº‹ä»¶åœ¨Javascriptåˆ›å»ºtouch-interfacesæ—¶å¸¸å¸¸è¢«å¿½è§†ã€‚è€Œæµè§ˆå™¨å‚å•†ä¹Ÿä»æœªæ­£å¼å‘å¸ƒè¯¦ç»†è¯´æ˜touchcanceläº‹ä»¶ä½•æ—¶ä¼šè¢«è§¦å‘çš„æ–‡æ¡£ï¼Œå› æ­¤ï¼Œå¯¹äºè®¸å¤šå¼€å‘è€…è€Œè¨€touchcanceläº‹ä»¶ä¸€ç›´é»˜é»˜æ— é—»ã€‚æœ¬è´´å¸Œæœ›èƒ½æ­å¼€touchcancelçš„ç¥ç§˜é¢çº±ï¼ŒåŠ©ä½ æ¸…æ¥šåœ°äº†è§£touchcanceläº‹ä»¶ã€‚ touchäº‹ä»¶æœ€åˆæ˜¯Appleä¸ºSafariæµè§ˆå™¨åˆ›å»ºçš„ï¼Œç°åœ¨å·²ç»è¢«çº³å…¥äº†W3C Touch äº‹ä»¶è§„èŒƒã€‚åŸå§‹çš„Safari DOMå‚è€ƒæ–‡æ¡£å…³äºtouchcanceläº‹ä»¶çš„ä¿¡æ¯å°‘çš„å¯æ€œï¼Œä»…æœ‰ä¸€å¥è¯ï¼š å½“ç³»ç»Ÿå–æ¶ˆè·Ÿè¸ªtouchäº‹ä»¶æ—¶è§¦å‘ã€‚ å¹¸è¿åœ°æ˜¯ï¼ŒW3C Touchäº‹ä»¶è§„èŒƒæä¾›äº†æ›´å¤šçš„ç»†èŠ‚ï¼ŒåŒ…æ‹¬ä¸€äº›ä¼šè§¦å‘è¯¥äº‹ä»¶çš„åœºæ™¯ï¼š åœ¨touchäº‹ä»¶è¢«ç³»ç»Ÿè‡ªå®šä¹‰è¡Œä¸ºå¹²æ‰°ä¹‹åï¼Œå®¢æˆ·ç«¯å¿…é¡»è§¦å‘touchcanceläº‹ä»¶ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯åŸç”Ÿçš„åŒæ­¥äº‹ä»¶æˆ–æ“ä½œå–æ¶ˆäº†touchäº‹ä»¶ï¼Œæˆ–è€…è§¦æ‘¸ç‚¹æ»‘å‡ºæ–‡æ¡£çª—å£ç§»è‡³ä¸€ä¸ªå¯ä»¥å¤„ç†ç”¨æˆ·äº¤äº’çš„éæ–‡æ¡£åŒºåŸŸï¼ˆå¦‚ï¼Œå®¢æˆ·ç«¯åŸç”Ÿç•Œé¢ï¼Œæ’ä»¶ï¼‰ã€‚å¦å¤–ï¼Œå½“ç”¨æˆ·æ”¾ç½®çš„è§¦æ‘¸ç‚¹è¶…å‡ºäº†è®¾å¤‡å¯å­˜å‚¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ€æ—©è¿›å…¥TouchListçš„Touchå¯¹è±¡ä¹Ÿå°†è¢«ç§»é™¤ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯ä¼šè§¦å‘è¯¥Touchå¯¹è±¡çš„touchcanceläº‹ä»¶ã€‚ ä»ä¸Šä¸€æ®µæè¿°ä¸­æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç†è§£touchcanceläº‹ä»¶ä¸æµè§ˆå™¨è¡Œä¸ºçš„å…³ç³»ã€‚è¿™ä¸ä»…èƒ½å¸®åŠ©æµè§ˆå™¨ç²¾ç¡®åœ°å¼•ç”¨TouchListä¸­çš„Touchå¯¹è±¡ï¼Œè€Œä¸”ä¹Ÿèƒ½è¢«å¼€å‘è€…ç”¨æ¥å®ç°ç‰¹å®šçš„UIæ“ä½œï¼Œä¾‹å¦‚åœ¨touchstartå’Œtouchmoveäº‹ä»¶å¤„ç†å‡½æ•°ä¸­é‡ç½®æ­£åœ¨ä½¿ç”¨çš„å˜é‡ã€‚å½“ç³»ç»Ÿå–æ¶ˆäº†è·Ÿè¸ªtouchäº‹ä»¶ä½†touchendäº‹ä»¶æ²¡æœ‰è¢«è§¦å‘æ—¶ï¼Œtouchcancelå°†ä¼šæ‹¯æ•‘ä½ ã€‚ é‚£æµè§ˆå™¨ä»€ä¹ˆæ—¶å€™è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Ÿå¼€å§‹ç ”ç©¶ä¹‹å‰æœ‰å¿…è¦æ„å»ºä¸€ä¸ªç®€å•çš„äº‹ä»¶æ—¥å¿—æ¥è·Ÿè¸ªæ‰€æœ‰çš„touchäº‹ä»¶ã€‚æµ‹è¯•ä¸»è¦è®°å½•åœ¨touchåŒºåŸŸæ»‘åŠ¨æ—¶æœ€åä¸€ä¸ªè¢«è§¦å‘çš„touchäº‹ä»¶ï¼Œè¿™äº›æ—¥å¿—å°†ä½¿æˆ‘ä»¬æ›´åŠ ç›´è§‚åœ°åˆ†æåˆ°åº•æ˜¯å“ªç§äº¤äº’æ“ä½œè§¦å‘äº†touchcanceläº‹ä»¶ã€‚ ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨å¤šç§æ‰‹æœºæµè§ˆå™¨ä¸Šçš„å‘ç°ã€‚å€¼å¾—æŒ‡å‡ºçš„æ˜¯touchcanceläº‹ä»¶å¾ˆä¸å¯é¢„æµ‹çš„ï¼Œå°¤å…¶åœ¨å®‰å“ï¼ˆ2.3.5ï¼‰ä¸Šã€‚ç”šè‡³åœ¨iOS5ä¸Šæœ‰æ—¶ä¹Ÿä¸èƒ½å‡†ç¡®é¢„æµ‹ä»€ä¹ˆæ“ä½œä¼šè§¦å‘touchcanceläº‹ä»¶ã€‚ iOS Safari 5.0.1ï¼ˆiPhone 4 &amp; iPad 1ï¼‰åœ¨touchstartæˆ–touchmoveäº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œä¼šè§¦å‘touchcanceläº‹ä»¶çš„æ“ä½œï¼š ç”¨æˆ·æŒ‰ä¸‹homeé”® ç”¨æˆ·æŒ‰ä¸‹Safariæµè§ˆå™¨åº•éƒ¨å·¥å…·æ çš„æ“ä½œæŒ‰é’® ç”¨æˆ·åœ¨å±å¹•ä¸­ä½¿ç”¨æ‰‹æŒè§¦æ‘¸æˆ–æ¶‚æŠ¹ï¼Œç”Ÿæˆäº†è®¸å¤šä¸å¯è¾¨åˆ«çš„å•ä¸€è§¦æ‘¸ç‚¹ï¼ˆä»…iPhoneï¼Ÿï¼‰ ç”¨æˆ·åœ¨iPadä¸Šä½¿ç”¨å››ä¸ªæˆ–æ›´å¤šæ‰‹æŒ‡åŒæ—¶è§¦æ‘¸ï¼Œæˆ–ä½¿ç”¨ç³»ç»Ÿè®¾ç½®ä¸­çš„å¤šä»»åŠ¡æ‰‹åŠ¿ åœ¨touchstartæˆ–touchmoveäº‹ä»¶ä¸­ä¸ä¼šè§¦å‘touchcanceläº‹ä»¶çš„æ“ä½œï¼š ç”¨æˆ·æŒ‰ä¸‹Safariæµè§ˆå™¨åº•éƒ¨å·¥å…·æ ä¸­çš„ä¹¦ç­¾æŒ‰é’® ç”¨æˆ·æŒ‰ä¸‹Safariæµè§ˆå™¨åº•éƒ¨å·¥å…·æ ä¸­çš„å‰è¿›æˆ–å›é€€æŒ‰é’® ç”¨æˆ·ç‚¹å‡»èšç„¦åœ¨Safariæµè§ˆå™¨çš„æœç´¢æ  ç”¨æˆ·æ—‹è½¬è®¾å¤‡çš„æ–¹å‘ å±å¹•å¼¹å‡ºç³»ç»Ÿé€šçŸ¥ï¼Œä¾‹å¦‚WiFiæŸ¥æ‰¾æˆ–é—¹é’Ÿæé†’ å±å¹•ä¸Šæ–¹å¼¹å‡ºiOS5é£æ ¼çš„æ–°é€šçŸ¥ ç”¨æˆ·æ–°å¼€äº†ä¸€ä¸ªtabï¼ˆiPadï¼‰ ç”¨æˆ·åˆ·æ–°ç½‘é¡µ ç”¨æˆ·æŒ‰ä¸‹éŸ³é‡é”® ç”¨æˆ·åˆ‡æ¢è®¾å¤‡é™éŸ³/æŒ¯åŠ¨çš„å¼€å…³ ç”¨æˆ·æ¥åˆ°ä¸€ä¸ªæ¥ç”µ åœ¨æœ‰äº›æƒ…å†µä¸‹ä»¥ä¸Šæ“ä½œä¸­ï¼Œæµè§ˆå™¨ä¼šç›´æ¥è§¦å‘ä¸€ä¸ªtouchendäº‹ä»¶è€Œä¸æ˜¯touchcanceläº‹ä»¶ã€‚åœ¨å…¶ä»–æƒ…æ™¯ä¸­ï¼ˆä¾‹å¦‚æ—§é£æ ¼çš„å¼¹å‡ºé€šçŸ¥ï¼‰ï¼Œtouchstartå’Œtouchmoveäº‹ä»¶ä»ç„¶æ˜¯èµ·ä½œç”¨çš„ï¼ˆå³ä½¿å†…å®¹å·²ç»è¢«é€šçŸ¥è¦†ç›–ï¼‰ï¼Œé™¤éç”¨æˆ·ç§»å¼€æ‰‹æŒ‡è§¦å‘äº†touchendäº‹ä»¶ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯å½“touchstartæˆ–è€…touchmoveäº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œéƒ¨åˆ†iOS5ç³»ç»Ÿæ–¹æ³•æ˜¯æ— æ³•æ‰§è¡Œçš„ï¼š ç”¨æˆ·ä¸èƒ½ä½¿ç”¨Safariæµè§ˆå™¨çš„åœ°å€æ  ç”¨æˆ·ä¸èƒ½æ‰“å¼€ä¸€ä¸ªæ–°é¡µé¢ï¼ˆiPhoneï¼‰ ç”¨æˆ·ä¸èƒ½åŒå‡»homeé”®æ‰“å¼€åº”ç”¨ç›’å­ï¼ˆapp trayï¼‰ ç”¨æˆ·ä¸èƒ½ä»å±å¹•ä¸Šæ–¹å¾€ä¸‹æ»‘åŠ¨æ‰“å¼€é€šçŸ¥ä¸­å¿ƒ ç”¨æˆ·æ— æ³•æ‰“å¼€å±å¹•ä¸Šæ–¹å‡ºç°çš„iOS5é£æ ¼çš„é€šçŸ¥ å®‰å“2.3.5ï¼ˆSamsung Galaxy Y GT-S5363ï¼‰å†…ç½®æµè§ˆå™¨åœ¨touchstartæˆ–touchmoveäº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œä¼šè§¦å‘touchcanceläº‹ä»¶çš„æ“ä½œï¼š ç”¨æˆ·æŒ‰ä¸‹é”å±é”® æ­¤ç§æƒ…å†µä¸‹ï¼Œä¼¼ä¹æ²¡æœ‰æ˜æ˜¾çš„åŸå› touchcanceläº‹ä»¶ä¹Ÿä¼šè¢«éšæœºè§¦å‘ï¼Œè¿™ç§ç°è±¡åœ¨é‡å¤å¿«é€Ÿç‚¹å‡»å’Œæ»‘åŠ¨çš„æ—¶å€™å°¤å…¶æ˜¾è‘— åœ¨touchstartæˆ–touchmoveäº‹ä»¶ä¸­ä¸ä¼šè§¦å‘touchcanceläº‹ä»¶çš„æ“ä½œï¼š ç”¨æˆ·æŒ‰ä¸‹homeé”® ç”¨æˆ·æ—‹è½¬è®¾å¤‡çš„æ–¹å‘ ç”¨æˆ·æŒ‰ä¸‹éŸ³é‡é”® å½“touchstartæˆ–è€…touchmoveäº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œéƒ¨åˆ†å®‰å“2.3.5ç³»ç»Ÿæ–¹æ³•æ˜¯æ— æ³•æ‰§è¡Œçš„ï¼š ç”¨æˆ·æ— æ³•æŒ‰ä¸‹èœå•é”®å’Œå›é€€é”® ç”¨æˆ·æ— æ³•æ‰“å¼€é€šçŸ¥èœå• ç”¨æˆ·æ— æ³•èšç„¦åˆ°æµè§ˆå™¨åœ°å€æ  ç”¨æˆ·æ— æ³•ç‚¹å‡»ä¹¦ç­¾æŒ‰é’® Opera Mobileå®‰å“ç‰ˆOpera Mobile 11.50 ä¹Ÿæµ‹è¯•äº†ã€‚ç„¶è€Œæµè§ˆå™¨ä¼¼ä¹æ”¯æŒtouchcanceläº‹ä»¶ï¼Œå®é™…ä¸Šä»–å¹¶æœªè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚ä¾‹å¦‚åœ¨æŒ‰ä¸‹homeé”®çš„æ—¶å€™ï¼ŒOpera Mobileä¼¼ä¹ç›´æ¥è§¦å‘äº†touchendäº‹ä»¶ã€‚ é»‘è“å¹³æ¿ç”µè„‘ (1.0.8.6067)å°½ç®¡æµè§ˆå™¨å£°ç§°æ”¯æŒtouchcanceläº‹ä»¶ï¼Œä½†è¯¥äº‹ä»¶ä¼¼ä¹å¹¶æœªè¢«è§¦å‘ã€‚å³ä½¿æŒ‰ä¸‹ç”µæºé”®ä½¿è®¾å¤‡å¾…æœºï¼Œtouchcanceläº‹ä»¶ä¹Ÿæœªè¢«è§¦å‘ã€‚åŒæ ·çš„ï¼ŒæŒ‰ä¸‹æµè§ˆå™¨å·¥å…·æ¡çš„æŒ‰é’®æˆ–èšç„¦åœ¨åœ°å€æ éƒ½æœªè§¦å‘æ­¤äº‹ä»¶ã€‚å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“è§¦å‘touchstartæˆ–touchmoveäº‹ä»¶åï¼Œå¹³æ¿ç”µè„‘ä¸ä¼šå“åº”ä»»ä½•æ»‘åŠ¨çš„æ‰‹åŠ¿ã€‚ ç»“è®ºä»æµ‹è¯•ç»“æœçœ‹ï¼Œtouchcanceläº‹ä»¶ä»ç„¶æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚ç„¶è€Œç¡®å®šåœ¨å“ªç§æƒ…å†µä¸‹äº‹ä»¶ä¼šè¢«è§¦å‘è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œåœ¨å“ªç§æƒ…å†µä¸‹ä¸è¢«è§¦å‘ä¹Ÿå‡ ä¹èƒ½ç¡®å®šã€‚é‚£ä¹ˆè¿™ä¸ªäº‹ä»¶çš„ä½œç”¨ä¹Ÿæ— éœ€å‡ºç°åœ¨æœ¬æ¬¡ç ”ç©¶ä¸­ï¼Œå› ä¸ºåœ¨æ‰€æœ‰å¯é¢„æœŸçš„æƒ…å†µä¸‹ï¼Œå¼€å‘è€…ç›®å‰ä¼¼ä¹æ— æ³•ä¾èµ–è¿™ä¸ªäº‹ä»¶çš„è§¦å‘ã€‚ ç„¶è€Œå¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œä½ æ— æ³•åœ¨æ¯å°è®¾å¤‡ä¸Šéƒ½ä»…ä»…åªä¾èµ–touchendäº‹ä»¶è¢«çš„è§¦å‘ã€‚ä½ éœ€è¦ç¼–å†™å¤„ç†touchcanceläº‹ä»¶çš„ä»£ç ã€‚ä¾‹å¦‚åœ¨iPadä¸Šå°¤å…¶å¦‚æ­¤ï¼Œå‡å¦‚ä½ å†™äº†ä¸ªå¤šç‚¹è§¦æ§çš„appæˆ–è”æœºçš„HTML5æ¸¸æˆã€‚ç”±äºç¨‹åºæ²¡æœ‰åŠæ³•è¾¨åˆ«ç”¨æˆ·æ˜¯å¦å¯ç”¨äº†å¤šä»»åŠ¡æ‰‹åŠ¿ï¼Œè¿™æ—¶ä½ çš„appå°±éœ€è¦ä¼˜é›…åœ°å¤„ç†touchcanceläº‹ä»¶ã€‚å®‰å“æµè§ˆå™¨ä¸å¯é¢„æµ‹çš„ç‰¹æ€§ä¹Ÿæ˜¯ä½¿å¾—å¤„ç†è¿™ä¸ªäº‹ä»¶å˜å¾—å°¤ä¸ºé‡è¦ï¼Œä¸è¿™ä¹ˆåšå°†ä¼šå¯¼è‡´ä½ çš„UIå‡ºç°bugã€‚ æ‰€ä»¥ï¼Œå½“ä½ ä¸‹æ¬¡å¤„ç†touchäº‹ä»¶æ—¶ï¼Œåˆ«å¿˜è®°å¤„ç†touchcanceläº‹ä»¶ã€‚å°½ç®¡è®¸å¤šæµè§ˆå™¨æ”¯æŒæ­¤äº‹ä»¶ï¼Œä½†åœ¨å¤„ç†æŸäº›æ„æƒ³ä¸åˆ°çš„ç”¨æˆ·äº¤äº’æ—¶è¿˜æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚ åŸæ–‡é“¾æ¥ï¼šDifferent ways to trigger touchcancel in mobile browsersè¯‘è€… @zhouweicsu2014 å¹´ 12æœˆ 09æ—¥","tags":[{"name":"ç§»åŠ¨å¼€å‘","slug":"ç§»åŠ¨å¼€å‘","permalink":"http://zhouweicsu.github.io/blog/tags/ç§»åŠ¨å¼€å‘/"},{"name":"touchcancel","slug":"touchcancel","permalink":"http://zhouweicsu.github.io/blog/tags/touchcancel/"},{"name":"mobile browsers","slug":"mobile-browsers","permalink":"http://zhouweicsu.github.io/blog/tags/mobile-browsers/"},{"name":"touch","slug":"touch","permalink":"http://zhouweicsu.github.io/blog/tags/touch/"}]}]